{"version":3,"file":"page-baselinepage-QRc0DzZg.js","sources":["../../src/pages/BaselinePage.js"],"sourcesContent":["/**\n * Baseline Deployment Page\n * Wizard for deploying PIM baseline configurations\n */\n\nimport { BasePage } from '../core/PageRouter.js';\nimport { graphService } from '../services/graphService.js';\nimport { baselineService } from '../services/baselineService.js';\n\nexport class BaselinePage extends BasePage {\n    constructor(app) {\n        super(app);\n        this.baselineState = {\n            selectedBaseline: null,\n            selectedTiers: [],\n            validationResults: null,\n            deploymentPlan: null,\n            groupUsers: {},\n            groupCustomizations: {}\n        };\n    }\n\n    /**\n     * Render Baseline Deployment page\n     * @param {HTMLElement} container - Page container\n     * @param {Object} params - Optional parameters\n     */\n    async render(container, params = {}) {\n        const baselines = baselineService.getBaselineConfigurations();\n\n        container.innerHTML = `\n            <div class=\"page-header-row\">\n                <h1 class=\"page-header\">\n                    <i class=\"fas fa-rocket\"></i> PIM Baseline Deployment\n                </h1>\n                <span class=\"page-subtitle\">One-shot PIM configuration based on best practices</span>\n            </div>\n            <p class=\"page-description\">Deploy a complete PIM configuration with groups, policies, and role assignments based on industry best practices and Zero Trust principles.</p>\n\n            <div id=\"baseline-wizard-step\" data-step=\"1\">\n                <!-- Step 1: Baseline Selection -->\n                <div id=\"baseline-step-1\" class=\"baseline-step active\">\n                    <h2 class=\"step-title\"><i class=\"fas fa-list-check\"></i> Step 1: Choose Your Baseline</h2>\n\n                    <div class=\"baseline-grid\">\n                        ${Object.entries(baselines).map(([key, baseline]) => `\n                            <div class=\"card baseline-card\" data-baseline=\"${key}\">\n                                <div class=\"baseline-header\">\n                                    <i class=\"fas ${baseline.icon} baseline-icon\"></i>\n                                    <h3>${baseline.name}</h3>\n                                </div>\n                                <p class=\"baseline-desc\">${baseline.description}</p>\n\n                                <div class=\"baseline-features\">\n                                    <h4>Key Features:</h4>\n                                    <ul>\n                                        ${baseline.features.map(f => `<li><i class=\"fas fa-check-circle\"></i> ${f}</li>`).join('')}\n                                    </ul>\n                                </div>\n\n                                <div class=\"baseline-stats\">\n                                    <span class=\"stat-badge\"><i class=\"fas fa-layer-group\"></i> ${baseline.tiers.length} Tiers</span>\n                                    <span class=\"stat-badge\"><i class=\"fas fa-users\"></i> ${baseline.tiers.reduce((sum, t) => sum + t.groups.length, 0)} Groups</span>\n                                </div>\n\n                                <button class=\"btn btn-primary btn-block\" onclick=\"app.pages.baseline.selectBaseline('${key}')\" ${!this.isConnected() ? 'disabled' : ''} aria-label=\"Select ${baseline.name} baseline\">\n                                    <i class=\"fas fa-arrow-right\"></i> Select This Baseline\n                                </button>\n                            </div>\n                        `).join('')}\n                    </div>\n                </div>\n\n                <!-- Step 2: Tier & Group Selection -->\n                <div id=\"baseline-step-2\" class=\"baseline-step\">\n                    <h2 class=\"step-title\"><i class=\"fas fa-layer-group\"></i> Step 2: Configure Tiers & Groups</h2>\n\n                    <div class=\"step-navigation\">\n                        <button class=\"btn btn-secondary\" onclick=\"app.pages.baseline.previousStep()\" aria-label=\"Go back\">\n                            <i class=\"fas fa-arrow-left\"></i> Back\n                        </button>\n                    </div>\n\n                    <div id=\"baseline-tier-config\" class=\"tier-config-container\">\n                        <!-- Populated dynamically -->\n                    </div>\n\n                    <div class=\"step-actions\">\n                        <button class=\"btn btn-primary\" onclick=\"app.pages.baseline.validateConfiguration()\" aria-label=\"Validate configuration\">\n                            <i class=\"fas fa-check-circle\"></i> Validate Configuration\n                        </button>\n                    </div>\n                </div>\n\n                <!-- Step 3: Validation & Review -->\n                <div id=\"baseline-step-3\" class=\"baseline-step\">\n                    <h2 class=\"step-title\"><i class=\"fas fa-clipboard-check\"></i> Step 3: Review & Deploy</h2>\n\n                    <div class=\"step-navigation\">\n                        <button class=\"btn btn-secondary\" onclick=\"app.pages.baseline.previousStep()\" aria-label=\"Go back\">\n                            <i class=\"fas fa-arrow-left\"></i> Back\n                        </button>\n                    </div>\n\n                    <div id=\"baseline-validation-results\" class=\"validation-results\">\n                        <!-- Populated after validation -->\n                    </div>\n\n                    <div id=\"baseline-deployment-plan\" class=\"deployment-plan\">\n                        <!-- Populated after validation -->\n                    </div>\n\n                    <div class=\"step-actions\">\n                        <button class=\"btn btn-success btn-lg\" onclick=\"app.pages.baseline.executeDeployment()\" id=\"deploy-baseline-btn\" aria-label=\"Deploy baseline\">\n                            <i class=\"fas fa-rocket\"></i> Deploy Baseline\n                        </button>\n                    </div>\n                </div>\n\n                <!-- Step 4: Deployment Progress -->\n                <div id=\"baseline-step-4\" class=\"baseline-step\">\n                    <h2 class=\"step-title\"><i class=\"fas fa-tasks\"></i> Deployment in Progress</h2>\n\n                    <div id=\"baseline-deployment-progress\" class=\"deployment-progress\">\n                        <!-- Populated during deployment -->\n                    </div>\n                </div>\n            </div>\n        `;\n\n        // Reset state\n        this.baselineState = {\n            selectedBaseline: null,\n            selectedTiers: [],\n            validationResults: null,\n            deploymentPlan: null,\n            groupUsers: {},\n            groupCustomizations: {}\n        };\n    }\n\n    /**\n     * Select a baseline and populate tier configuration\n     */\n    selectBaseline(baselineKey) {\n        const baseline = baselineService.getBaseline(baselineKey);\n        this.baselineState.selectedBaseline = baselineKey;\n\n        // Populate tier configuration\n        const tierConfigDiv = document.getElementById('baseline-tier-config');\n        tierConfigDiv.innerHTML = `\n            <div class=\"card\">\n                <h3><i class=\"fas fa-info-circle\"></i> Selected: ${baseline.name}</h3>\n                <p>${baseline.description}</p>\n            </div>\n\n            <div class=\"tiers-list\">\n                ${baseline.tiers.map((tier, index) => `\n                    <div class=\"card tier-card\">\n                        <div class=\"tier-header\">\n                            <label class=\"checkbox-label tier-checkbox\">\n                                <input type=\"checkbox\" class=\"tier-select\" data-tier=\"${index}\" checked>\n                                <h3>\n                                    ${tier.tier === 0 ? 'üíÄ' : tier.tier === 1 ? '‚ö†Ô∏è' : 'üîµ'}\n                                    ${tier.name}\n                                </h3>\n                            </label>\n                        </div>\n\n                        <div class=\"tier-policy-summary\">\n                            <h4>Policy Configuration:</h4>\n                            <div class=\"policy-grid\">\n                                <div class=\"policy-item\">\n                                    <i class=\"fas fa-clock\"></i>\n                                    <span>Max Duration: ${tier.policy.maximumDurationHours}h</span>\n                                </div>\n                                <div class=\"policy-item\">\n                                    <i class=\"fas fa-shield-alt\"></i>\n                                    <span>MFA: ${tier.policy.requireMfa ? 'Required' : 'Optional'}</span>\n                                </div>\n                                <div class=\"policy-item\">\n                                    <i class=\"fas fa-clipboard-check\"></i>\n                                    <span>Approval: ${tier.policy.requireApproval ? 'Required' : 'Not Required'}</span>\n                                </div>\n                                <div class=\"policy-item\">\n                                    <i class=\"fas fa-comment-dots\"></i>\n                                    <span>Justification: ${tier.policy.requireJustification ? 'Required' : 'Optional'}</span>\n                                </div>\n                            </div>\n                        </div>\n\n                        <div class=\"tier-groups\">\n                            <h4>Groups to Create (${tier.groups.length}):</h4>\n                            <p class=\"form-hint\"><i class=\"fas fa-info-circle\"></i> Click the arrow (‚ñº) on each group to customize name and add users</p>\n                            <div class=\"groups-list\">\n                                ${tier.groups.map((group, gIndex) => `\n                                    <div class=\"group-item baseline-group-item\" data-tier=\"${index}\" data-group-index=\"${gIndex}\">\n                                        <div class=\"group-item-header\">\n                                            <label class=\"checkbox-label\">\n                                                <input type=\"checkbox\" class=\"group-select\" data-tier=\"${index}\" data-group=\"${group.name}\" checked>\n                                                <div class=\"group-info-compact\">\n                                                    <i class=\"fas fa-users\"></i>\n                                                    <span>${group.name}</span>\n                                                </div>\n                                            </label>\n                                            <button class=\"btn btn-sm btn-secondary\" onclick=\"app.pages.baseline.toggleGroupDetails(${index}, ${gIndex})\" aria-label=\"Toggle group details\">\n                                                <i class=\"fas fa-chevron-down\"></i>\n                                            </button>\n                                        </div>\n\n                                        <div class=\"group-item-details\" id=\"group-details-${index}-${gIndex}\">\n                                            <div class=\"form-group\">\n                                                <label>Group Name</label>\n                                                <input type=\"text\" class=\"input group-name-input\"\n                                                    data-tier=\"${index}\"\n                                                    data-group-index=\"${gIndex}\"\n                                                    data-original=\"${group.name}\"\n                                                    value=\"${group.name}\"\n                                                    aria-label=\"Group name\">\n                                                <small class=\"form-hint\">Customize the group name (must be unique)</small>\n                                            </div>\n\n                                            <div class=\"form-group\">\n                                                <label>Description</label>\n                                                <textarea class=\"input group-desc-input\"\n                                                    data-tier=\"${index}\"\n                                                    data-group-index=\"${gIndex}\"\n                                                    rows=\"2\"\n                                                    aria-label=\"Group description\">${group.description}</textarea>\n                                            </div>\n\n                                            <div class=\"form-group\">\n                                                <label>Assigned Roles</label>\n                                                <div class=\"group-roles-list\">\n                                                    <i class=\"fas fa-user-shield\"></i>\n                                                    ${group.roles.length} role${group.roles.length !== 1 ? 's' : ''}\n                                                </div>\n                                            </div>\n\n                                            <div class=\"form-group\">\n                                                <label>Assignment Type</label>\n                                                <div class=\"assignment-type-toggle\">\n                                                    <label class=\"toggle-option ${!group.isActive ? 'active' : ''}\" data-tier=\"${index}\" data-group-index=\"${gIndex}\" data-type=\"eligible\">\n                                                        <input type=\"radio\" name=\"assignment-type-${index}-${gIndex}\" value=\"eligible\" checked>\n                                                        <div class=\"toggle-content\">\n                                                            <i class=\"fas fa-clock\"></i>\n                                                            <span>Eligible</span>\n                                                            <small>Users activate when needed</small>\n                                                        </div>\n                                                    </label>\n                                                    <label class=\"toggle-option ${group.isActive ? 'active' : ''}\" data-tier=\"${index}\" data-group-index=\"${gIndex}\" data-type=\"active\">\n                                                        <input type=\"radio\" name=\"assignment-type-${index}-${gIndex}\" value=\"active\">\n                                                        <div class=\"toggle-content\">\n                                                            <i class=\"fas fa-check-circle\"></i>\n                                                            <span>Active</span>\n                                                            <small>Always active (permanent)</small>\n                                                        </div>\n                                                    </label>\n                                                </div>\n                                            </div>\n\n                                            <div class=\"form-group\">\n                                                <label>Add Users (Optional)</label>\n                                                <div class=\"user-search-container\">\n                                                    <input type=\"text\"\n                                                        class=\"input user-search-input\"\n                                                        data-tier=\"${index}\"\n                                                        data-group-index=\"${gIndex}\"\n                                                        placeholder=\"Search users by name or email...\"\n                                                        aria-label=\"Search users\">\n                                                    <div class=\"user-search-results\" id=\"user-search-results-${index}-${gIndex}\"></div>\n                                                </div>\n                                                <div class=\"selected-users-list\" id=\"selected-users-${index}-${gIndex}\">\n                                                    <small class=\"form-hint\">No users added yet. Search above to add users.</small>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                `).join('')}\n                            </div>\n                        </div>\n                    </div>\n                `).join('')}\n            </div>\n        `;\n\n        // Navigate to step 2\n        this.goToStep(2);\n\n        // Initialize user selections storage\n        this.baselineState.groupUsers = {};\n        this.baselineState.groupCustomizations = {};\n\n        // Add event listeners for tier checkboxes\n        document.querySelectorAll('.tier-select').forEach(cb => {\n            cb.addEventListener('change', (e) => {\n                const tierIndex = parseInt(e.target.dataset.tier);\n                const groupCheckboxes = document.querySelectorAll(`.group-select[data-tier=\"${tierIndex}\"]`);\n                groupCheckboxes.forEach(gcb => {\n                    gcb.checked = e.target.checked;\n                    gcb.disabled = !e.target.checked;\n                });\n            });\n        });\n\n        // Add event listeners for assignment type toggle\n        document.querySelectorAll('.toggle-option').forEach(option => {\n            option.addEventListener('click', (e) => {\n                const label = e.currentTarget;\n                const tierIndex = label.dataset.tier;\n                const groupIndex = label.dataset.groupIndex;\n                const type = label.dataset.type;\n\n                // Update UI\n                const siblingOptions = document.querySelectorAll(`.toggle-option[data-tier=\"${tierIndex}\"][data-group-index=\"${groupIndex}\"]`);\n                siblingOptions.forEach(opt => opt.classList.remove('active'));\n                label.classList.add('active');\n\n                // Update radio button\n                label.querySelector('input[type=\"radio\"]').checked = true;\n\n                // Store in state\n                const key = `${tierIndex}-${groupIndex}`;\n                if (!this.baselineState.groupCustomizations[key]) {\n                    this.baselineState.groupCustomizations[key] = {};\n                }\n                this.baselineState.groupCustomizations[key].assignmentType = type;\n            });\n        });\n\n        // Add event listeners for user search\n        document.querySelectorAll('.user-search-input').forEach(input => {\n            let searchTimeout;\n            input.addEventListener('input', (e) => {\n                clearTimeout(searchTimeout);\n                const query = e.target.value.trim();\n                const tierIndex = e.target.dataset.tier;\n                const groupIndex = e.target.dataset.groupIndex;\n\n                if (query.length < 2) {\n                    document.getElementById(`user-search-results-${tierIndex}-${groupIndex}`).innerHTML = '';\n                    return;\n                }\n\n                searchTimeout = setTimeout(() => {\n                    this.searchUsers(tierIndex, groupIndex, query);\n                }, 300);\n            });\n        });\n    }\n\n    /**\n     * Toggle group details visibility\n     */\n    toggleGroupDetails(tierIndex, groupIndex) {\n        const detailsDiv = document.getElementById(`group-details-${tierIndex}-${groupIndex}`);\n        const button = event.target.closest('button');\n        const icon = button.querySelector('i');\n\n        if (detailsDiv.style.display === 'none' || !detailsDiv.style.display) {\n            detailsDiv.style.display = 'block';\n            icon.className = 'fas fa-chevron-up';\n        } else {\n            detailsDiv.style.display = 'none';\n            icon.className = 'fas fa-chevron-down';\n        }\n    }\n\n    /**\n     * Search users for baseline group\n     */\n    async searchUsers(tierIndex, groupIndex, query) {\n        const resultsDiv = document.getElementById(`user-search-results-${tierIndex}-${groupIndex}`);\n        resultsDiv.innerHTML = '<div class=\"search-loading\"><i class=\"fas fa-spinner fa-spin\"></i> Searching...</div>';\n\n        try {\n            const result = await graphService.searchUsers(query);\n\n            if (result.success && result.users.length > 0) {\n                resultsDiv.innerHTML = result.users.map(user => `\n                    <div class=\"user-search-result\" onclick=\"app.pages.baseline.addUser(${tierIndex}, ${groupIndex}, '${user.id}', '${this.escapeHtml(user.displayName)}', '${this.escapeHtml(user.userPrincipalName)}')\">\n                        <div class=\"user-info\">\n                            <i class=\"fas fa-user\"></i>\n                            <div>\n                                <div class=\"user-name\">${this.escapeHtml(user.displayName)}</div>\n                                <div class=\"user-email\">${this.escapeHtml(user.userPrincipalName)}</div>\n                            </div>\n                        </div>\n                        <i class=\"fas fa-plus-circle\"></i>\n                    </div>\n                `).join('');\n            } else {\n                resultsDiv.innerHTML = '<div class=\"search-no-results\">No users found</div>';\n            }\n        } catch (error) {\n            resultsDiv.innerHTML = '<div class=\"search-error\">Search failed</div>';\n        }\n    }\n\n    /**\n     * Add user to group\n     */\n    addUser(tierIndex, groupIndex, userId, displayName, userPrincipalName) {\n        const key = `${tierIndex}-${groupIndex}`;\n\n        // Initialize array if needed\n        if (!this.baselineState.groupUsers[key]) {\n            this.baselineState.groupUsers[key] = [];\n        }\n\n        // Check if user already added\n        if (this.baselineState.groupUsers[key].some(u => u.id === userId)) {\n            this.showToast('User already added to this group', 'info');\n            return;\n        }\n\n        // Add user\n        this.baselineState.groupUsers[key].push({ id: userId, displayName, userPrincipalName });\n\n        // Update UI\n        this.updateUsersList(tierIndex, groupIndex);\n\n        // Clear search\n        document.querySelector(`.user-search-input[data-tier=\"${tierIndex}\"][data-group-index=\"${groupIndex}\"]`).value = '';\n        document.getElementById(`user-search-results-${tierIndex}-${groupIndex}`).innerHTML = '';\n\n        this.showToast(`Added ${displayName} to group`, 'success');\n    }\n\n    /**\n     * Remove user from group\n     */\n    removeUser(tierIndex, groupIndex, userId) {\n        const key = `${tierIndex}-${groupIndex}`;\n\n        if (this.baselineState.groupUsers[key]) {\n            this.baselineState.groupUsers[key] = this.baselineState.groupUsers[key].filter(u => u.id !== userId);\n            this.updateUsersList(tierIndex, groupIndex);\n        }\n    }\n\n    /**\n     * Update selected users list UI\n     */\n    updateUsersList(tierIndex, groupIndex) {\n        const key = `${tierIndex}-${groupIndex}`;\n        const users = this.baselineState.groupUsers[key] || [];\n        const listDiv = document.getElementById(`selected-users-${tierIndex}-${groupIndex}`);\n\n        if (users.length === 0) {\n            listDiv.innerHTML = '<small class=\"form-hint\">No users added yet. Search above to add users.</small>';\n        } else {\n            listDiv.innerHTML = `\n                <div class=\"selected-users-header\">\n                    <strong>${users.length} user${users.length !== 1 ? 's' : ''} will be added:</strong>\n                </div>\n                ${users.map(user => `\n                    <div class=\"selected-user-item\">\n                        <div class=\"user-info\">\n                            <i class=\"fas fa-user\"></i>\n                            <div>\n                                <div class=\"user-name\">${this.escapeHtml(user.displayName)}</div>\n                                <div class=\"user-email\">${this.escapeHtml(user.userPrincipalName)}</div>\n                            </div>\n                        </div>\n                        <button class=\"btn btn-sm btn-danger\" onclick=\"app.pages.baseline.removeUser(${tierIndex}, ${groupIndex}, '${user.id}')\" aria-label=\"Remove user\">\n                            <i class=\"fas fa-times\"></i>\n                        </button>\n                    </div>\n                `).join('')}\n            `;\n        }\n    }\n\n    /**\n     * Validate baseline configuration\n     */\n    async validateConfiguration() {\n        if (!this.baselineState.selectedBaseline) {\n            this.showToast('No baseline selected', 'error');\n            return;\n        }\n\n        this.showLoading('Validating configuration...');\n\n        try {\n            const baseline = baselineService.getBaseline(this.baselineState.selectedBaseline);\n\n            // Collect selected tiers and groups\n            const selectedConfig = {\n                baseline: this.baselineState.selectedBaseline,\n                tiers: []\n            };\n\n            document.querySelectorAll('.tier-select:checked').forEach(tierCb => {\n                const tierIndex = parseInt(tierCb.dataset.tier);\n                const tier = baseline.tiers[tierIndex];\n\n                const selectedGroups = [];\n                document.querySelectorAll(`.group-select[data-tier=\"${tierIndex}\"]:checked`).forEach((groupCb) => {\n                    const groupName = groupCb.dataset.group;\n                    const groupIndex = tier.groups.findIndex(g => g.name === groupName);\n                    const group = tier.groups[groupIndex];\n\n                    if (group && groupIndex !== -1) {\n                        // Get customized values\n                        const nameInput = document.querySelector(`.group-name-input[data-tier=\"${tierIndex}\"][data-group-index=\"${groupIndex}\"]`);\n                        const descInput = document.querySelector(`.group-desc-input[data-tier=\"${tierIndex}\"][data-group-index=\"${groupIndex}\"]`);\n                        const assignmentTypeRadio = document.querySelector(`input[name=\"assignment-type-${tierIndex}-${groupIndex}\"]:checked`);\n\n                        const customizedGroup = {\n                            ...group,\n                            name: nameInput ? nameInput.value.trim() : group.name,\n                            description: descInput ? descInput.value.trim() : group.description,\n                            originalName: group.name,\n                            assignmentType: assignmentTypeRadio ? assignmentTypeRadio.value : 'eligible'\n                        };\n\n                        // Store customizations\n                        const key = `${tierIndex}-${groupIndex}`;\n                        this.baselineState.groupCustomizations[key] = {\n                            name: customizedGroup.name,\n                            description: customizedGroup.description,\n                            users: this.baselineState.groupUsers[key] || [],\n                            assignmentType: customizedGroup.assignmentType\n                        };\n\n                        selectedGroups.push(customizedGroup);\n                    }\n                });\n\n                if (selectedGroups.length > 0) {\n                    selectedConfig.tiers.push({\n                        ...tier,\n                        groups: selectedGroups\n                    });\n                }\n            });\n\n            this.baselineState.selectedTiers = selectedConfig.tiers;\n\n            // Validate against existing environment\n            const existingGroups = await graphService.getPIMGroups();\n            const existingRoles = await graphService.getRoleDefinitions();\n\n            const validation = baselineService.validateBaseline(selectedConfig, {\n                existingGroups: existingGroups.groups || [],\n                existingRoles: existingRoles.roles || []\n            });\n\n            this.baselineState.validationResults = validation;\n\n            // Calculate deployment plan\n            const deploymentPlan = baselineService.calculateDeploymentPlan(selectedConfig, {\n                existingGroups: existingGroups.groups || [],\n                existingRoles: existingRoles.roles || []\n            });\n\n            this.baselineState.deploymentPlan = deploymentPlan;\n\n            this.hideLoading();\n\n            // Display validation results\n            this.displayValidationResults(validation, deploymentPlan);\n            this.goToStep(3);\n\n        } catch (error) {\n            this.hideLoading();\n            this.showToast('Validation failed: ' + error.message, 'error');\n        }\n    }\n\n    /**\n     * Display validation results and deployment plan\n     */\n    displayValidationResults(validation, plan) {\n        const resultsDiv = document.getElementById('baseline-validation-results');\n        const planDiv = document.getElementById('baseline-deployment-plan');\n\n        // Validation results\n        const hasErrors = validation.errors.length > 0;\n        const hasWarnings = validation.warnings.length > 0;\n\n        resultsDiv.innerHTML = `\n            <div class=\"card ${hasErrors ? 'validation-error' : hasWarnings ? 'validation-warning' : 'validation-success'}\">\n                <h3>\n                    <i class=\"fas ${hasErrors ? 'fa-times-circle' : hasWarnings ? 'fa-exclamation-triangle' : 'fa-check-circle'}\"></i>\n                    Validation ${hasErrors ? 'Failed' : hasWarnings ? 'Passed with Warnings' : 'Passed'}\n                </h3>\n\n                ${validation.errors.length > 0 ? `\n                    <div class=\"validation-section validation-errors\">\n                        <h4><i class=\"fas fa-times-circle\"></i> Errors</h4>\n                        <ul>\n                            ${validation.errors.map(err => `<li>${this.escapeHtml(err)}</li>`).join('')}\n                        </ul>\n                    </div>\n                ` : ''}\n\n                ${validation.warnings.length > 0 ? `\n                    <div class=\"validation-section validation-warnings\">\n                        <h4><i class=\"fas fa-exclamation-triangle\"></i> Warnings</h4>\n                        <ul>\n                            ${validation.warnings.map(warn => `<li>${this.escapeHtml(warn)}</li>`).join('')}\n                        </ul>\n                    </div>\n                ` : ''}\n\n                ${!hasErrors && !hasWarnings ? `\n                    <p><i class=\"fas fa-check\"></i> Configuration is valid and ready for deployment.</p>\n                ` : ''}\n\n                ${validation.newGroups && validation.newGroups.length > 0 ? `\n                    <div class=\"validation-summary\">\n                        <h4><i class=\"fas fa-info-circle\"></i> Summary</h4>\n                        <p><strong>${validation.newGroups.length} new group(s)</strong> will be created:</p>\n                        <ul class=\"group-list-compact\">\n                            ${validation.newGroups.map(name => `<li><i class=\"fas fa-plus-circle\"></i> ${this.escapeHtml(name)}</li>`).join('')}\n                        </ul>\n                    </div>\n                ` : ''}\n\n                ${validation.existingGroups && validation.existingGroups.length > 0 ? `\n                    <div class=\"validation-summary\">\n                        <p><strong>${validation.existingGroups.length} existing group(s)</strong> will be skipped:</p>\n                        <ul class=\"group-list-compact\">\n                            ${validation.existingGroups.map(name => `<li><i class=\"fas fa-check-circle\"></i> ${this.escapeHtml(name)}</li>`).join('')}\n                        </ul>\n                    </div>\n                ` : ''}\n            </div>\n        `;\n\n        // Deployment plan\n        planDiv.innerHTML = `\n            <div class=\"card deployment-plan-card\">\n                <h3><i class=\"fas fa-tasks\"></i> Deployment Plan</h3>\n\n                <div class=\"plan-summary\">\n                    <div class=\"plan-stat\">\n                        <span class=\"plan-value\">${plan.groupsToCreate.length}</span>\n                        <span class=\"plan-label\">Groups to Create</span>\n                    </div>\n                    <div class=\"plan-stat\">\n                        <span class=\"plan-value\">${plan.policiesToConfigure.length}</span>\n                        <span class=\"plan-label\">Policies to Configure</span>\n                    </div>\n                    <div class=\"plan-stat\">\n                        <span class=\"plan-value\">${plan.roleAssignmentsToCreate.length}</span>\n                        <span class=\"plan-label\">Role Assignments</span>\n                    </div>\n                    <div class=\"plan-stat\">\n                        <span class=\"plan-value\">${plan.estimatedTime}</span>\n                        <span class=\"plan-label\">Est. Time</span>\n                    </div>\n                </div>\n\n                <div class=\"plan-details\">\n                    <h4>Deployment Steps:</h4>\n                    <ol class=\"deployment-steps-list\">\n                        ${plan.steps.map(step => `\n                            <li>\n                                <i class=\"fas ${step.icon}\"></i>\n                                <strong>${this.escapeHtml(step.title)}</strong>\n                                <p>${this.escapeHtml(step.description)}</p>\n                            </li>\n                        `).join('')}\n                    </ol>\n                </div>\n\n                <div class=\"plan-groups-preview\">\n                    <h4>Groups to be created:</h4>\n                    <div class=\"groups-preview-list\">\n                        ${plan.groupsToCreate.map(group => `\n                            <div class=\"group-preview-item\">\n                                <i class=\"fas fa-users\"></i>\n                                <div>\n                                    <strong>${this.escapeHtml(group.displayName)}</strong>\n                                    <p>${this.escapeHtml(group.description)}</p>\n                                </div>\n                            </div>\n                        `).join('')}\n                    </div>\n                </div>\n            </div>\n        `;\n\n        // Enable/disable deploy button based on validation\n        const deployBtn = document.getElementById('deploy-baseline-btn');\n        if (deployBtn) {\n            deployBtn.disabled = hasErrors;\n        }\n    }\n\n    /**\n     * Execute baseline deployment\n     */\n    async executeDeployment() {\n        if (!this.baselineState.deploymentPlan) {\n            this.showToast('No deployment plan available', 'error');\n            return;\n        }\n\n        const confirmed = confirm(\n            `This will create ${this.baselineState.deploymentPlan.groupsToCreate.length} groups and configure their policies.\\n\\n` +\n            'This action cannot be undone automatically. Continue?'\n        );\n\n        if (!confirmed) return;\n\n        this.goToStep(4);\n\n        const progressDiv = document.getElementById('baseline-deployment-progress');\n        const plan = this.baselineState.deploymentPlan;\n\n        // Calculate total steps\n        const totalRoleAssignments = plan.groupsToCreate.reduce((sum, g) => sum + (g.roles?.length || 0), 0);\n        const totalSteps = plan.groupsToCreate.length + totalRoleAssignments + totalRoleAssignments;\n        let completedSteps = 0;\n\n        const updateProgress = (message, isError = false) => {\n            completedSteps++;\n            const percentage = Math.round((completedSteps / totalSteps) * 100);\n\n            const logEntry = document.createElement('div');\n            logEntry.className = `deployment-log-entry ${isError ? 'log-error' : 'log-success'}`;\n            logEntry.innerHTML = `\n                <i class=\"fas ${isError ? 'fa-times-circle' : 'fa-check-circle'}\"></i>\n                <span>${message}</span>\n            `;\n\n            const logContainer = progressDiv.querySelector('.deployment-log') || (() => {\n                const container = document.createElement('div');\n                container.className = 'deployment-log';\n                progressDiv.appendChild(container);\n                return container;\n            })();\n\n            logContainer.appendChild(logEntry);\n            logContainer.scrollTop = logContainer.scrollHeight;\n\n            // Update progress bar\n            const progressBar = progressDiv.querySelector('.progress-bar-fill');\n            if (progressBar) {\n                progressBar.style.width = `${percentage}%`;\n                progressBar.textContent = `${percentage}%`;\n            }\n        };\n\n        progressDiv.innerHTML = `\n            <div class=\"card\">\n                <h3><i class=\"fas fa-spinner fa-spin\"></i> Deploying Baseline Configuration</h3>\n                <div class=\"progress-bar\">\n                    <div class=\"progress-bar-fill\" style=\"width: 0%\">0%</div>\n                </div>\n                <div class=\"deployment-log\"></div>\n            </div>\n        `;\n\n        try {\n            // Fetch all roles for display names\n            updateProgress('Fetching role information...');\n            const rolesResult = await graphService.getRoleDefinitions();\n            const rolesMap = new Map();\n            if (rolesResult.success) {\n                rolesResult.roles.forEach(role => {\n                    rolesMap.set(role.id, role.displayName);\n                });\n            }\n\n            // Step 1: Create groups\n            updateProgress('Starting group creation...');\n            const createdGroups = [];\n\n            for (const groupConfig of plan.groupsToCreate) {\n                try {\n                    const result = await graphService.createPIMGroup(\n                        groupConfig.displayName,\n                        groupConfig.description,\n                        groupConfig.mailNickname\n                    );\n                    if (result.success) {\n                        createdGroups.push({ config: groupConfig, group: result.group });\n                        updateProgress(`‚úì Created group: ${groupConfig.displayName}`);\n                    } else {\n                        updateProgress(`‚úó Failed to create group: ${groupConfig.displayName} - ${result.error}`, true);\n                    }\n                } catch (error) {\n                    updateProgress(`‚úó Error creating group: ${groupConfig.displayName} - ${error.message}`, true);\n                }\n            }\n\n            // Step 2: Wait for groups to provision\n            updateProgress('Waiting for groups to provision (30-60 seconds)...');\n            await new Promise(resolve => setTimeout(resolve, 30000));\n\n            // Step 3: Assign groups to roles\n            updateProgress('Assigning groups to roles...');\n            const roleAssignments = [];\n\n            for (const createdGroup of createdGroups) {\n                const roles = createdGroup.config.roles || [];\n\n                // Find assignment type\n                const customizationEntry = Object.entries(this.baselineState.groupCustomizations || {}).find(\n                    ([key, value]) => value.name === createdGroup.config.displayName\n                );\n                const assignmentType = customizationEntry ? customizationEntry[1].assignmentType : 'eligible';\n\n                for (const roleId of roles) {\n                    try {\n                        let assignResult;\n\n                        if (assignmentType === 'active') {\n                            assignResult = await graphService.createDirectoryRoleActiveAssignment(\n                                createdGroup.group.id,\n                                roleId,\n                                `Baseline deployment (Active): ${createdGroup.config.displayName}`\n                            );\n                        } else {\n                            assignResult = await graphService.createDirectoryRoleEligibilityAssignment(\n                                createdGroup.group.id,\n                                roleId,\n                                `Baseline deployment (Eligible): ${createdGroup.config.displayName}`,\n                                12\n                            );\n                        }\n\n                        if (assignResult.success) {\n                            const roleName = rolesMap.get(roleId) || roleId;\n                            roleAssignments.push({\n                                groupId: createdGroup.group.id,\n                                groupName: createdGroup.config.displayName,\n                                roleId: roleId,\n                                roleName: roleName,\n                                policy: createdGroup.config.policy\n                            });\n                            updateProgress(`‚úì Assigned ${createdGroup.config.displayName} to ${roleName} (${assignmentType})`);\n                        } else {\n                            updateProgress(`‚úó Failed to assign ${createdGroup.config.displayName}: ${assignResult.error}`, true);\n                        }\n                    } catch (error) {\n                        updateProgress(`‚úó Error assigning ${createdGroup.config.displayName}: ${error.message}`, true);\n                    }\n                }\n            }\n\n            // Step 4: Wait for assignments to propagate\n            updateProgress('Waiting for role assignments to propagate (10 seconds)...');\n            await new Promise(resolve => setTimeout(resolve, 10000));\n\n            updateProgress(`‚úì Role assignments complete. ${roleAssignments.length} groups assigned to roles.`);\n\n            // Step 5: Configure role policies\n            if (roleAssignments.length > 0) {\n                updateProgress('Configuring role policies...');\n\n                const roleConfigMap = new Map();\n                roleAssignments.forEach(assignment => {\n                    if (!roleConfigMap.has(assignment.roleId)) {\n                        roleConfigMap.set(assignment.roleId, {\n                            roleId: assignment.roleId,\n                            roleName: assignment.roleName,\n                            groupName: assignment.groupName,\n                            policy: assignment.policy\n                        });\n                    }\n                });\n\n                for (const [roleId, config] of roleConfigMap) {\n                    try {\n                        updateProgress(`Fetching policy for ${config.roleName}...`);\n                        const policiesResult = await graphService.getRolePolicy(roleId);\n\n                        if (policiesResult.success && policiesResult.policy) {\n                            let updatedCount = 0;\n\n                            // Update expiration rule\n                            try {\n                                await graphService.updateRolePolicy(\n                                    policiesResult.policy.id,\n                                    'Expiration_EndUser_Assignment',\n                                    {\n                                        maximumDuration: `PT${config.policy.maximumDurationHours}H`,\n                                        isExpirationRequired: true\n                                    }\n                                );\n                                updatedCount++;\n                            } catch (err) {\n                                console.error('Expiration rule update failed:', err);\n                            }\n\n                            // Update enablement rule\n                            try {\n                                await graphService.updateRolePolicy(\n                                    policiesResult.policy.id,\n                                    'Enablement_EndUser_Assignment',\n                                    {\n                                        enabledRules: [\n                                            config.policy.requireMfa ? 'MultiFactorAuthentication' : null,\n                                            config.policy.requireJustification ? 'Justification' : null,\n                                            config.policy.requireTicketInfo ? 'Ticketing' : null\n                                        ].filter(r => r !== null)\n                                    }\n                                );\n                                updatedCount++;\n                            } catch (err) {\n                                console.error('Enablement rule update failed:', err);\n                            }\n\n                            // Update approval rule\n                            try {\n                                await graphService.updateRolePolicy(\n                                    policiesResult.policy.id,\n                                    'Approval_EndUser_Assignment',\n                                    {\n                                        isApprovalRequired: config.policy.requireApproval\n                                    }\n                                );\n                                updatedCount++;\n                            } catch (err) {\n                                console.error('Approval rule update failed:', err);\n                            }\n\n                            if (updatedCount > 0) {\n                                updateProgress(`‚úì Updated ${config.roleName} policy (${updatedCount}/3 rules)`);\n                            } else {\n                                updateProgress(`‚ö† Could not update ${config.roleName} policy`, false);\n                            }\n                        } else {\n                            const errorMsg = policiesResult.error || 'Unknown error';\n                            updateProgress(`‚ö† Could not fetch ${config.roleName} policy: ${errorMsg}`, false);\n                        }\n                    } catch (error) {\n                        updateProgress(`‚ö† Policy update error: ${error.message}`, false);\n                    }\n                }\n            }\n\n            // Step 6: Add users to groups\n            const totalUsersToAdd = Object.values(this.baselineState.groupUsers || {}).reduce((sum, users) => sum + users.length, 0);\n\n            if (totalUsersToAdd > 0) {\n                updateProgress(`Adding ${totalUsersToAdd} users to groups...`);\n\n                for (const createdGroup of createdGroups) {\n                    const customizationEntry = Object.entries(this.baselineState.groupCustomizations || {}).find(\n                        ([key, value]) => value.name === createdGroup.config.displayName\n                    );\n\n                    if (customizationEntry && customizationEntry[1].users && customizationEntry[1].users.length > 0) {\n                        const users = customizationEntry[1].users;\n\n                        for (const user of users) {\n                            try {\n                                const assignResult = await graphService.createEligibleAssignment(\n                                    createdGroup.group.id,\n                                    user.id,\n                                    'member',\n                                    null,\n                                    null\n                                );\n\n                                if (assignResult.success) {\n                                    updateProgress(`‚úì Added ${user.displayName} to ${createdGroup.config.displayName}`);\n                                } else {\n                                    updateProgress(`‚úó Failed to add ${user.displayName}: ${assignResult.error}`, true);\n                                }\n                            } catch (error) {\n                                updateProgress(`‚úó Error adding ${user.displayName}: ${error.message}`, true);\n                            }\n                        }\n                    }\n                }\n            }\n\n            // Complete\n            updateProgress('Deployment completed!');\n\n            progressDiv.innerHTML += `\n                <div class=\"deployment-complete\">\n                    <i class=\"fas fa-check-circle\"></i>\n                    <h3>Baseline Deployed Successfully!</h3>\n                    <p>Created ${createdGroups.length} groups with configured policies.</p>\n                    <div class=\"deployment-actions\">\n                        <button class=\"btn btn-primary\" onclick=\"app.navigateTo('groups')\">\n                            <i class=\"fas fa-users\"></i> View Groups\n                        </button>\n                        <button class=\"btn btn-secondary\" onclick=\"app.router.refreshCurrentPage()\">\n                            <i class=\"fas fa-redo\"></i> Deploy Another Baseline\n                        </button>\n                    </div>\n                </div>\n            `;\n\n            this.showToast('Baseline deployed successfully!', 'success');\n\n        } catch (error) {\n            updateProgress(`‚úó Deployment failed: ${error.message}`, true);\n            this.showToast('Deployment failed: ' + error.message, 'error');\n\n            progressDiv.innerHTML += `\n                <div class=\"deployment-error\">\n                    <i class=\"fas fa-exclamation-circle\"></i>\n                    <h3>Deployment Failed</h3>\n                    <p>${this.escapeHtml(error.message)}</p>\n                    <button class=\"btn btn-secondary\" onclick=\"app.pages.baseline.previousStep()\">\n                        <i class=\"fas fa-arrow-left\"></i> Go Back\n                    </button>\n                </div>\n            `;\n        }\n    }\n\n    /**\n     * Navigate to specific step\n     */\n    goToStep(stepNumber) {\n        // Hide all steps\n        document.querySelectorAll('.baseline-step').forEach(step => {\n            step.classList.remove('active');\n        });\n\n        // Show target step\n        const targetStep = document.getElementById(`baseline-step-${stepNumber}`);\n        if (targetStep) {\n            targetStep.classList.add('active');\n            document.getElementById('baseline-wizard-step').dataset.step = stepNumber;\n        }\n    }\n\n    /**\n     * Navigate to previous step\n     */\n    previousStep() {\n        const currentStep = parseInt(document.getElementById('baseline-wizard-step').dataset.step);\n        if (currentStep > 1) {\n            this.goToStep(currentStep - 1);\n        }\n    }\n\n    /**\n     * Refresh page data\n     */\n    async refreshPage() {\n        await this.app.router.refreshCurrentPage();\n    }\n}\n"],"names":["BaselinePage","BasePage","app","container","params","baselines","baselineService","key","baseline","f","sum","t","baselineKey","tierConfigDiv","tier","index","group","gIndex","cb","tierIndex","gcb","option","label","groupIndex","type","opt","input","searchTimeout","e","query","detailsDiv","icon","resultsDiv","result","graphService","user","userId","displayName","userPrincipalName","u","users","listDiv","selectedConfig","tierCb","selectedGroups","groupCb","groupName","nameInput","descInput","assignmentTypeRadio","customizedGroup","existingGroups","existingRoles","validation","deploymentPlan","error","plan","planDiv","hasErrors","hasWarnings","err","warn","name","step","deployBtn","progressDiv","totalRoleAssignments","g","totalSteps","completedSteps","updateProgress","message","isError","percentage","logEntry","logContainer","progressBar","rolesResult","rolesMap","role","createdGroups","groupConfig","resolve","roleAssignments","createdGroup","roles","customizationEntry","value","assignmentType","roleId","assignResult","roleName","roleConfigMap","assignment","config","policiesResult","updatedCount","r","errorMsg","totalUsersToAdd","stepNumber","targetStep","currentStep"],"mappings":"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"}