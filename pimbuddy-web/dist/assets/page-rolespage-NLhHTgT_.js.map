{"version":3,"file":"page-rolespage-NLhHTgT_.js","sources":["../../src/pages/RolesPage.js"],"sourcesContent":["/**\n * Roles Page\n * Manage Entra ID roles and their PIM policies\n */\n\nimport { BasePage } from '../core/PageRouter.js';\nimport { graphService } from '../services/graphService.js';\nimport { CACHE_KEYS } from '../core/CacheManager.js';\n\nexport class RolesPage extends BasePage {\n    constructor(app) {\n        super(app);\n        this.paginator = app.paginators.roles;\n        this.roleSortOrder = 'privilege-desc';\n        this.filters = {\n            search: '',\n            privilege: 'all',\n            type: 'all'\n        };\n    }\n\n    /**\n     * Render Roles page\n     * @param {HTMLElement} container - Page container\n     * @param {Object} params - Optional parameters\n     */\n    async render(container, params = {}) {\n        let allRoles = [];\n\n        if (this.isConnected()) {\n            this.showLoading('Loading roles...');\n\n            // Try cache first\n            allRoles = this.getCached(CACHE_KEYS.ROLES.key);\n\n            if (!allRoles) {\n                const result = await graphService.getRoleDefinitions();\n                if (result.success) {\n                    allRoles = result.roles;\n                    this.setCached(CACHE_KEYS.ROLES.key, allRoles);\n                } else {\n                    this.showToast(`Failed to load roles: ${result.error}`, 'error');\n                }\n            }\n\n            this.hideLoading();\n        }\n\n        allRoles = allRoles || [];\n\n        // Sort roles by privilege level\n        allRoles = this.sortRolesByPrivilege(allRoles, this.roleSortOrder);\n\n        // Update paginator with all roles\n        this.paginator.updateItems(allRoles);\n\n        // Get current page items\n        const roles = this.paginator.getCurrentPageItems();\n\n        const privilegeBadge = (level) => {\n            const config = {\n                critical: { class: 'badge-critical', icon: 'fa-skull-crossbones', label: 'Critical' },\n                high: { class: 'badge-high', icon: 'fa-exclamation-triangle', label: 'High' },\n                medium: { class: 'badge-medium', icon: 'fa-shield-alt', label: 'Medium' },\n                low: { class: 'badge-low', icon: 'fa-check-circle', label: 'Low' }\n            };\n            const c = config[level] || config.low;\n            return `<span class=\"badge privilege-badge ${c.class}\"><i class=\"fas ${c.icon}\"></i> ${c.label}</span>`;\n        };\n\n        container.innerHTML = `\n            <div class=\"page-header-row\">\n                <h1 class=\"page-header\">Entra ID Roles</h1>\n            </div>\n\n            <div class=\"toolbar\">\n                <input type=\"text\" id=\"role-search\" class=\"input\" placeholder=\"Search roles...\"\n                       value=\"${this.filters.search}\"\n                       oninput=\"app.pages.roles.updateFilter('search', this.value)\">\n\n                <select id=\"privilege-filter\" class=\"input input-select\"\n                        onchange=\"app.pages.roles.updateFilter('privilege', this.value)\">\n                    <option value=\"all\" ${this.filters.privilege === 'all' ? 'selected' : ''}>All Privileges</option>\n                    <option value=\"critical\" ${this.filters.privilege === 'critical' ? 'selected' : ''}>Critical Only</option>\n                    <option value=\"high\" ${this.filters.privilege === 'high' ? 'selected' : ''}>High Only</option>\n                    <option value=\"medium\" ${this.filters.privilege === 'medium' ? 'selected' : ''}>Medium Only</option>\n                    <option value=\"low\" ${this.filters.privilege === 'low' ? 'selected' : ''}>Low Only</option>\n                </select>\n\n                <select id=\"type-filter\" class=\"input input-select\"\n                        onchange=\"app.pages.roles.updateFilter('type', this.value)\">\n                    <option value=\"all\" ${this.filters.type === 'all' ? 'selected' : ''}>All Types</option>\n                    <option value=\"builtin\" ${this.filters.type === 'builtin' ? 'selected' : ''}>Built-in Only</option>\n                    <option value=\"custom\" ${this.filters.type === 'custom' ? 'selected' : ''}>Custom Only</option>\n                </select>\n\n                <select id=\"role-sort\" class=\"input input-select\" onchange=\"app.pages.roles.sortRoles(this.value)\">\n                    <option value=\"privilege-desc\" ${this.roleSortOrder === 'privilege-desc' ? 'selected' : ''}>Privilege: High to Low</option>\n                    <option value=\"privilege-asc\" ${this.roleSortOrder === 'privilege-asc' ? 'selected' : ''}>Privilege: Low to High</option>\n                    <option value=\"name-asc\" ${this.roleSortOrder === 'name-asc' ? 'selected' : ''}>Name: A to Z</option>\n                    <option value=\"name-desc\" ${this.roleSortOrder === 'name-desc' ? 'selected' : ''}>Name: Z to A</option>\n                </select>\n\n                ${this.filters.search || this.filters.privilege !== 'all' || this.filters.type !== 'all' ? `\n                    <button class=\"btn btn-secondary\" onclick=\"app.pages.roles.clearFilters()\" title=\"Clear all filters\">\n                        <i class=\"fas fa-times\"></i> Clear Filters\n                    </button>\n                ` : ''}\n\n                <button class=\"btn btn-secondary\" onclick=\"app.showExportMenu('roles')\" ${!this.isConnected() || allRoles.length === 0 ? 'disabled' : ''}>\n                    <i class=\"fas fa-file-export\"></i> Export\n                </button>\n                <button class=\"btn btn-secondary\" onclick=\"app.pages.roles.refreshPage()\" ${!this.isConnected() ? 'disabled' : ''}>\n                    <i class=\"fas fa-sync\"></i> Refresh\n                </button>\n            </div>\n\n            <div class=\"card\">\n                <table class=\"data-table\" id=\"roles-table\">\n                    <thead>\n                        <tr>\n                            <th class=\"sortable\" onclick=\"app.pages.roles.sortRoles('name')\">Role Name <i class=\"fas fa-sort\"></i></th>\n                            <th>Description</th>\n                            <th class=\"sortable\" onclick=\"app.pages.roles.sortRoles('privilege')\">Privilege <i class=\"fas fa-sort\"></i></th>\n                            <th>Type</th>\n                            <th>Actions</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        ${roles.length > 0 ? roles.map(r => `\n                            <tr data-id=\"${r.id}\" data-privilege=\"${r.privilegeLevel}\">\n                                <td><strong>${this.escapeHtml(r.displayName)}</strong></td>\n                                <td class=\"description-cell\">${this.escapeHtml((r.description || '').substring(0, 80))}${(r.description || '').length > 80 ? '...' : ''}</td>\n                                <td>${privilegeBadge(r.privilegeLevel)}</td>\n                                <td>${r.isBuiltIn ? '<span class=\"badge\">Built-in</span>' : '<span class=\"badge badge-secondary\">Custom</span>'}</td>\n                                <td>\n                                    <button class=\"icon-btn\" onclick=\"app.pages.roles.assignGroupToRole('${r.id}', '${this.escapeHtml(r.displayName)}')\" title=\"Assign Group\" aria-label=\"Assign group to ${this.escapeHtml(r.displayName)}\">\n                                        <i class=\"fas fa-user-plus\" aria-hidden=\"true\"></i>\n                                    </button>\n                                    <button class=\"icon-btn\" onclick=\"app.pages.roles.configureRolePolicy('${r.id}')\" title=\"Configure Policy\" aria-label=\"Configure policy for ${this.escapeHtml(r.displayName)}\">\n                                        <i class=\"fas fa-cog\" aria-hidden=\"true\"></i>\n                                    </button>\n                                </td>\n                            </tr>\n                        `).join('') : `\n                            <tr>\n                                <td colspan=\"5\" class=\"empty-state\">\n                                    ${this.isConnected() ? 'No roles found' : 'Connect to view roles'}\n                                </td>\n                            </tr>\n                        `}\n                    </tbody>\n                </table>\n\n                ${this.paginator.renderControls('app.pages.roles.handlePageChange')}\n            </div>\n\n            <div class=\"privilege-legend\">\n                <span class=\"legend-title\">Privilege Levels:</span>\n                <span class=\"badge privilege-badge badge-critical\"><i class=\"fas fa-skull-crossbones\"></i> Critical</span>\n                <span class=\"badge privilege-badge badge-high\"><i class=\"fas fa-exclamation-triangle\"></i> High</span>\n                <span class=\"badge privilege-badge badge-medium\"><i class=\"fas fa-shield-alt\"></i> Medium</span>\n                <span class=\"badge privilege-badge badge-low\"><i class=\"fas fa-check-circle\"></i> Low</span>\n            </div>\n        `;\n    }\n\n    /**\n     * Sort roles by privilege level\n     * @param {Array} roles - Roles array\n     * @param {string} order - Sort order\n     * @returns {Array} Sorted roles\n     */\n    sortRolesByPrivilege(roles, order) {\n        const privilegeOrder = { critical: 0, high: 1, medium: 2, low: 3 };\n\n        return [...roles].sort((a, b) => {\n            if (order === 'privilege-desc') {\n                return privilegeOrder[a.privilegeLevel] - privilegeOrder[b.privilegeLevel];\n            } else if (order === 'privilege-asc') {\n                return privilegeOrder[b.privilegeLevel] - privilegeOrder[a.privilegeLevel];\n            } else if (order === 'name-asc') {\n                return a.displayName.localeCompare(b.displayName);\n            } else if (order === 'name-desc') {\n                return b.displayName.localeCompare(a.displayName);\n            }\n            return 0;\n        });\n    }\n\n    /**\n     * Sort roles by user selection\n     * @param {string} order - Sort order\n     */\n    sortRoles(order) {\n        // Toggle direction if clicking same column header\n        if (order === 'privilege') {\n            order = this.roleSortOrder === 'privilege-desc' ? 'privilege-asc' : 'privilege-desc';\n        } else if (order === 'name') {\n            order = this.roleSortOrder === 'name-asc' ? 'name-desc' : 'name-asc';\n        }\n\n        this.roleSortOrder = order;\n        this.app.router.refreshCurrentPage();\n    }\n\n    /**\n     * Update filter and apply all filters\n     * @param {string} filterType - Type of filter (search, privilege, type)\n     * @param {string} value - Filter value\n     */\n    updateFilter(filterType, value) {\n        this.filters[filterType] = value;\n        this.applyFilters();\n    }\n\n    /**\n     * Apply all active filters\n     */\n    applyFilters() {\n        const rows = document.querySelectorAll('#roles-table tbody tr');\n\n        rows.forEach(row => {\n            const text = row.textContent.toLowerCase();\n            const privilegeLevel = row.dataset.privilege;\n            const isBuiltIn = row.querySelector('.badge:not(.privilege-badge)')?.textContent.trim() === 'Built-in';\n\n            // Search filter\n            const matchesSearch = !this.filters.search ||\n                text.includes(this.filters.search.toLowerCase());\n\n            // Privilege filter\n            const matchesPrivilege = this.filters.privilege === 'all' ||\n                privilegeLevel === this.filters.privilege;\n\n            // Type filter\n            const matchesType = this.filters.type === 'all' ||\n                (this.filters.type === 'builtin' && isBuiltIn) ||\n                (this.filters.type === 'custom' && !isBuiltIn);\n\n            // Show row only if all filters match\n            row.style.display = (matchesSearch && matchesPrivilege && matchesType) ? '' : 'none';\n        });\n\n        // Update filter count badge\n        this.updateFilterCount();\n    }\n\n    /**\n     * Update visible count of filtered roles\n     */\n    updateFilterCount() {\n        const rows = document.querySelectorAll('#roles-table tbody tr');\n        const visibleCount = Array.from(rows).filter(row => row.style.display !== 'none').length;\n        const totalCount = rows.length;\n\n        // Update page header with count if filtering is active\n        if (this.filters.search || this.filters.privilege !== 'all' || this.filters.type !== 'all') {\n            const header = document.querySelector('.page-header');\n            if (header) {\n                header.innerHTML = `Entra ID Roles <span class=\"badge badge-secondary\">${visibleCount} of ${totalCount}</span>`;\n            }\n        }\n    }\n\n    /**\n     * Clear all filters\n     */\n    clearFilters() {\n        this.filters = {\n            search: '',\n            privilege: 'all',\n            type: 'all'\n        };\n        this.app.router.refreshCurrentPage();\n    }\n\n    /**\n     * Handle page change\n     * @param {number} page - Page number\n     */\n    handlePageChange(page) {\n        this.paginator.goToPage(page);\n        this.app.router.refreshCurrentPage();\n    }\n\n    /**\n     * Handle page size change\n     * @param {number} size - Page size\n     */\n    handlePageSizeChange(size) {\n        this.paginator.setPageSize(size);\n        this.app.router.refreshCurrentPage();\n    }\n\n    /**\n     * Refresh page data\n     */\n    async refreshPage() {\n        this.app.cacheManager.invalidate(CACHE_KEYS.ROLES.key);\n        await this.app.router.refreshCurrentPage();\n    }\n\n    /**\n     * Configure role policy\n     * @param {string} roleId - Role ID\n     */\n    async configureRolePolicy(roleId) {\n        const allRoles = this.getCached(CACHE_KEYS.ROLES.key) || [];\n        const role = allRoles.find(r => r.id === roleId);\n\n        if (!role) {\n            this.showToast('Role not found', 'error');\n            return;\n        }\n\n        this.showLoading('Loading policy settings...');\n\n        const result = await graphService.getRolePolicy(roleId);\n\n        this.hideLoading();\n\n        if (!result.success) {\n            this.showToast(`Failed to load policy: ${result.error}`, 'error');\n            return;\n        }\n\n        const policy = result.policy || {};\n\n        const content = `\n            <div class=\"modal-header\">\n                <h2 class=\"modal-title\">\n                    <i class=\"fas fa-shield-alt\"></i> Configure Policy: ${this.escapeHtml(role.displayName)}\n                </h2>\n                <button class=\"modal-close\" onclick=\"app.closeModal()\" title=\"Close\">\n                    <i class=\"fas fa-times\"></i>\n                </button>\n            </div>\n            <div class=\"modal-body modal-lg\">\n                <form id=\"policy-form\">\n                    <div class=\"tabs\">\n                        <button type=\"button\" class=\"tab-btn active\" onclick=\"app.pages.roles.switchPolicyTab('activation')\">\n                            <i class=\"fas fa-play-circle\"></i> Activation\n                        </button>\n                        <button type=\"button\" class=\"tab-btn\" onclick=\"app.pages.roles.switchPolicyTab('assignment')\">\n                            <i class=\"fas fa-user-plus\"></i> Assignment\n                        </button>\n                        <button type=\"button\" class=\"tab-btn\" onclick=\"app.pages.roles.switchPolicyTab('notifications')\">\n                            <i class=\"fas fa-bell\"></i> Notifications\n                        </button>\n                    </div>\n\n                    <div id=\"tab-activation\" class=\"tab-content active\">\n                        <h3><i class=\"fas fa-play-circle\"></i> Activation Settings</h3>\n                        <p class=\"form-hint\">Controls how users can activate this role</p>\n\n                        <div class=\"form-section\">\n                            <label class=\"form-label\">\n                                <input type=\"checkbox\" name=\"requireMfa\" ${policy.requireMfa ? 'checked' : ''}>\n                                <strong>Require Multi-Factor Authentication (MFA)</strong>\n                                <small class=\"form-hint\">Users must complete MFA challenge to activate</small>\n                            </label>\n\n                            <label class=\"form-label\">\n                                <input type=\"checkbox\" name=\"requireApproval\" ${policy.requireApproval ? 'checked' : ''}\n                                       onchange=\"document.getElementById('approvers-section').style.display = this.checked ? 'block' : 'none'\">\n                                <strong>Require Approval</strong>\n                                <small class=\"form-hint\">Activation request must be approved by designated approvers</small>\n                            </label>\n\n                            <div id=\"approvers-section\" style=\"display: ${policy.requireApproval ? 'block' : 'none'}; margin-left: 2rem;\">\n                                <label class=\"form-label\">\n                                    Approvers (comma-separated emails)\n                                    <textarea name=\"approvers\" class=\"input\" rows=\"2\"\n                                              placeholder=\"admin1@company.com, admin2@company.com\">${policy.approvers?.join(', ') || ''}</textarea>\n                                    <small class=\"form-hint\">Leave empty to use default approvers</small>\n                                </label>\n                            </div>\n\n                            <label class=\"form-label\">\n                                <input type=\"checkbox\" name=\"requireJustification\" ${policy.requireJustification ? 'checked' : ''}>\n                                <strong>Require Justification</strong>\n                                <small class=\"form-hint\">Users must provide business justification for activation</small>\n                            </label>\n\n                            <label class=\"form-label\">\n                                <input type=\"checkbox\" name=\"requireTicket\" ${policy.requireTicket ? 'checked' : ''}>\n                                <strong>Require Ticket Number</strong>\n                                <small class=\"form-hint\">Users must provide change management ticket reference</small>\n                            </label>\n                        </div>\n\n                        <div class=\"form-section\">\n                            <h4>Activation Duration</h4>\n                            <label class=\"form-label\">\n                                Maximum Duration (hours)\n                                <div style=\"display: flex; gap: 0.5rem; align-items: center;\">\n                                    <input type=\"number\" name=\"maximumDurationHours\" class=\"input\" min=\"0.5\" max=\"24\" step=\"0.5\"\n                                           value=\"${policy.maximumDurationHours || 8}\" style=\"flex: 1;\">\n                                    <div class=\"duration-presets\">\n                                        <button type=\"button\" class=\"btn btn-sm btn-secondary\" onclick=\"document.querySelector('[name=maximumDurationHours]').value = 1\">1h</button>\n                                        <button type=\"button\" class=\"btn btn-sm btn-secondary\" onclick=\"document.querySelector('[name=maximumDurationHours]').value = 4\">4h</button>\n                                        <button type=\"button\" class=\"btn btn-sm btn-secondary\" onclick=\"document.querySelector('[name=maximumDurationHours]').value = 8\">8h</button>\n                                        <button type=\"button\" class=\"btn btn-sm btn-secondary\" onclick=\"document.querySelector('[name=maximumDurationHours]').value = 24\">24h</button>\n                                    </div>\n                                </div>\n                                <small class=\"form-hint\">Maximum time the role can be active (0.5 to 24 hours)</small>\n                            </label>\n\n                            <label class=\"form-label\">\n                                Default Duration (hours)\n                                <input type=\"number\" name=\"defaultDurationHours\" class=\"input\" min=\"0.5\" max=\"24\" step=\"0.5\"\n                                       value=\"${policy.defaultDurationHours || 4}\">\n                                <small class=\"form-hint\">Pre-filled duration when activating</small>\n                            </label>\n                        </div>\n                    </div>\n\n                    <div id=\"tab-assignment\" class=\"tab-content\" style=\"display: none;\">\n                        <h3><i class=\"fas fa-user-plus\"></i> Assignment Settings</h3>\n                        <p class=\"form-hint\">Controls how users can be assigned as eligible for this role</p>\n\n                        <div class=\"form-section\">\n                            <label class=\"form-label\">\n                                <input type=\"checkbox\" name=\"allowPermanentEligible\" ${policy.allowPermanentEligible !== false ? 'checked' : ''}>\n                                <strong>Allow Permanent Eligible Assignments</strong>\n                                <small class=\"form-hint\">Administrators can assign users as permanently eligible</small>\n                            </label>\n\n                            <label class=\"form-label\">\n                                <input type=\"checkbox\" name=\"requireJustificationOnAssignment\" ${policy.requireJustificationOnAssignment ? 'checked' : ''}>\n                                <strong>Require Justification for Assignment</strong>\n                                <small class=\"form-hint\">Administrators must justify when making users eligible</small>\n                            </label>\n\n                            <label class=\"form-label\">\n                                Maximum Eligible Assignment Duration (days)\n                                <input type=\"number\" name=\"maxEligibleDurationDays\" class=\"input\" min=\"1\" max=\"365\"\n                                       value=\"${policy.maxEligibleDurationDays || 365}\">\n                                <small class=\"form-hint\">Maximum time-bound eligible assignment (1-365 days, 0 = no limit)</small>\n                            </label>\n                        </div>\n\n                        <div class=\"form-section\">\n                            <h4>Active Assignment Settings</h4>\n                            <label class=\"form-label\">\n                                <input type=\"checkbox\" name=\"allowPermanentActive\" ${policy.allowPermanentActive ? 'checked' : ''}>\n                                <strong>Allow Permanent Active Assignments</strong>\n                                <small class=\"form-hint warning-text\">⚠️ Not recommended for PIM - bypasses activation requirements</small>\n                            </label>\n\n                            <label class=\"form-label\">\n                                Maximum Active Assignment Duration (days)\n                                <input type=\"number\" name=\"maxActiveDurationDays\" class=\"input\" min=\"1\" max=\"365\"\n                                       value=\"${policy.maxActiveDurationDays || 180}\">\n                                <small class=\"form-hint\">Maximum time-bound active assignment (1-365 days)</small>\n                            </label>\n                        </div>\n                    </div>\n\n                    <div id=\"tab-notifications\" class=\"tab-content\" style=\"display: none;\">\n                        <h3><i class=\"fas fa-bell\"></i> Notification Settings</h3>\n                        <p class=\"form-hint\">Configure who gets notified and when</p>\n\n                        <div class=\"form-section\">\n                            <h4>Activation Notifications</h4>\n                            <label class=\"form-label\">\n                                <input type=\"checkbox\" name=\"notifyOnActivation\" ${policy.notifyOnActivation !== false ? 'checked' : ''}>\n                                <strong>Notify on Role Activation</strong>\n                                <small class=\"form-hint\">Send notification when role is activated</small>\n                            </label>\n\n                            <label class=\"form-label\">\n                                <input type=\"checkbox\" name=\"notifyOnExpiration\" ${policy.notifyOnExpiration !== false ? 'checked' : ''}>\n                                <strong>Notify Before Expiration</strong>\n                                <small class=\"form-hint\">Send reminder before activation expires</small>\n                            </label>\n\n                            <label class=\"form-label\">\n                                Expiration Warning (hours before)\n                                <input type=\"number\" name=\"expirationWarningHours\" class=\"input\" min=\"0.5\" max=\"24\" step=\"0.5\"\n                                       value=\"${policy.expirationWarningHours || 1}\">\n                                <small class=\"form-hint\">How early to send expiration warning</small>\n                            </label>\n                        </div>\n\n                        <div class=\"form-section\">\n                            <h4>Assignment Notifications</h4>\n                            <label class=\"form-label\">\n                                <input type=\"checkbox\" name=\"notifyOnEligibleAssignment\" ${policy.notifyOnEligibleAssignment !== false ? 'checked' : ''}>\n                                <strong>Notify on Eligible Assignment</strong>\n                                <small class=\"form-hint\">Notify user when made eligible for role</small>\n                            </label>\n\n                            <label class=\"form-label\">\n                                <input type=\"checkbox\" name=\"notifyAdminsOnAssignment\" ${policy.notifyAdminsOnAssignment ? 'checked' : ''}>\n                                <strong>Notify Admins on Assignment</strong>\n                                <small class=\"form-hint\">Send notification to admins when eligibility changes</small>\n                            </label>\n                        </div>\n\n                        <div class=\"form-section\">\n                            <h4>Additional Recipients</h4>\n                            <label class=\"form-label\">\n                                Additional Notification Recipients (comma-separated emails)\n                                <textarea name=\"additionalRecipients\" class=\"input\" rows=\"2\"\n                                          placeholder=\"security@company.com, audit@company.com\">${policy.additionalRecipients?.join(', ') || ''}</textarea>\n                                <small class=\"form-hint\">These recipients will receive all notifications for this role</small>\n                            </label>\n                        </div>\n                    </div>\n\n                    <div class=\"modal-footer\">\n                        <button type=\"button\" class=\"btn btn-secondary\" onclick=\"app.closeModal()\">\n                            <i class=\"fas fa-times\"></i> Cancel\n                        </button>\n                        <button type=\"button\" class=\"btn btn-secondary\" onclick=\"app.pages.roles.resetPolicyToDefaults('${roleId}')\">\n                            <i class=\"fas fa-undo\"></i> Reset to Defaults\n                        </button>\n                        <button type=\"submit\" class=\"btn btn-primary\">\n                            <i class=\"fas fa-save\"></i> Save Policy\n                        </button>\n                    </div>\n                </form>\n            </div>\n        `;\n\n        this.showModal(content);\n\n        // Handle form submission\n        document.getElementById('policy-form').addEventListener('submit', async (e) => {\n            e.preventDefault();\n            await this.handleSavePolicy(roleId, e.target);\n        });\n    }\n\n    /**\n     * Switch between tabs in policy modal\n     * @param {string} tabName - Tab name\n     */\n    switchPolicyTab(tabName) {\n        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));\n        document.querySelectorAll('.tab-content').forEach(content => {\n            content.style.display = 'none';\n            content.classList.remove('active');\n        });\n\n        document.querySelector(`.tab-btn[onclick*=\"${tabName}\"]`)?.classList.add('active');\n        const targetTab = document.getElementById(`tab-${tabName}`);\n        if (targetTab) {\n            targetTab.style.display = 'block';\n            targetTab.classList.add('active');\n        }\n    }\n\n    /**\n     * Reset policy to default values\n     * @param {string} roleId - Role ID\n     */\n    resetPolicyToDefaults(roleId) {\n        if (!confirm('Reset this policy to default settings? Your custom configuration will be lost.')) {\n            return;\n        }\n\n        // Set form to default values\n        const form = document.getElementById('policy-form');\n        if (form) {\n            form.reset();\n\n            // Set specific default values\n            form.querySelector('[name=\"maximumDurationHours\"]').value = 8;\n            form.querySelector('[name=\"defaultDurationHours\"]').value = 4;\n            form.querySelector('[name=\"maxEligibleDurationDays\"]').value = 365;\n            form.querySelector('[name=\"maxActiveDurationDays\"]').value = 180;\n            form.querySelector('[name=\"expirationWarningHours\"]').value = 1;\n\n            // Enable default checkboxes\n            form.querySelector('[name=\"notifyOnActivation\"]').checked = true;\n            form.querySelector('[name=\"notifyOnExpiration\"]').checked = true;\n            form.querySelector('[name=\"notifyOnEligibleAssignment\"]').checked = true;\n            form.querySelector('[name=\"allowPermanentEligible\"]').checked = true;\n\n            // Hide approvers section\n            document.getElementById('approvers-section').style.display = 'none';\n\n            this.showToast('Policy reset to defaults', 'info');\n        }\n    }\n\n    /**\n     * Handle save policy form submission\n     * @param {string} roleId - Role ID\n     * @param {HTMLFormElement} form - Form element\n     */\n    async handleSavePolicy(roleId, form) {\n        const formData = new FormData(form);\n\n        // Parse approvers and recipients lists\n        const parseEmailList = (value) => {\n            if (!value) return [];\n            return value.split(',')\n                .map(email => email.trim())\n                .filter(email => email.length > 0);\n        };\n\n        const policyUpdate = {\n            // Activation settings\n            requireMfa: formData.get('requireMfa') === 'on',\n            requireApproval: formData.get('requireApproval') === 'on',\n            requireJustification: formData.get('requireJustification') === 'on',\n            requireTicket: formData.get('requireTicket') === 'on',\n            maximumDurationHours: parseFloat(formData.get('maximumDurationHours')) || 8,\n            defaultDurationHours: parseFloat(formData.get('defaultDurationHours')) || 4,\n            approvers: parseEmailList(formData.get('approvers')),\n\n            // Assignment settings\n            allowPermanentEligible: formData.get('allowPermanentEligible') === 'on',\n            requireJustificationOnAssignment: formData.get('requireJustificationOnAssignment') === 'on',\n            maxEligibleDurationDays: parseInt(formData.get('maxEligibleDurationDays')) || 365,\n            allowPermanentActive: formData.get('allowPermanentActive') === 'on',\n            maxActiveDurationDays: parseInt(formData.get('maxActiveDurationDays')) || 180,\n\n            // Notification settings\n            notifyOnActivation: formData.get('notifyOnActivation') === 'on',\n            notifyOnExpiration: formData.get('notifyOnExpiration') === 'on',\n            expirationWarningHours: parseFloat(formData.get('expirationWarningHours')) || 1,\n            notifyOnEligibleAssignment: formData.get('notifyOnEligibleAssignment') === 'on',\n            notifyAdminsOnAssignment: formData.get('notifyAdminsOnAssignment') === 'on',\n            additionalRecipients: parseEmailList(formData.get('additionalRecipients'))\n        };\n\n        // Validate settings\n        if (policyUpdate.defaultDurationHours > policyUpdate.maximumDurationHours) {\n            this.showToast('Default duration cannot exceed maximum duration', 'error');\n            return;\n        }\n\n        if (policyUpdate.requireApproval && policyUpdate.approvers.length === 0) {\n            if (!confirm('No approvers specified. Continue with default approvers?')) {\n                return;\n            }\n        }\n\n        if (policyUpdate.allowPermanentActive) {\n            if (!confirm('⚠️ Permanent active assignments bypass PIM protections. Are you sure?')) {\n                return;\n            }\n        }\n\n        this.closeModal();\n        this.showLoading('Updating policy...');\n\n        const result = await graphService.updateRolePolicy(roleId, policyUpdate);\n\n        this.hideLoading();\n\n        if (result.success) {\n            this.showToast('Policy updated successfully', 'success');\n        } else {\n            this.showToast(`Failed to update policy: ${result.error}`, 'error');\n        }\n    }\n\n    /**\n     * Assign group to role (make group eligible for role)\n     * @param {string} roleId - Role ID\n     * @param {string} roleName - Role display name\n     */\n    async assignGroupToRole(roleId, roleName) {\n        // Fetch available PIM groups\n        this.showLoading('Loading groups...');\n        const groupsResult = await graphService.getPIMGroups();\n        this.hideLoading();\n\n        if (!groupsResult.success || !groupsResult.groups || groupsResult.groups.length === 0) {\n            this.showToast('No PIM groups available to assign', 'error');\n            return;\n        }\n\n        const groups = groupsResult.groups;\n\n        const content = `\n            <div class=\"modal-header\">\n                <h2 class=\"modal-title\">\n                    <i class=\"fas fa-user-plus\"></i> Assign Group to Role\n                </h2>\n                <button class=\"modal-close\" onclick=\"app.closeModal()\" title=\"Close\" aria-label=\"Close dialog\">\n                    <i class=\"fas fa-times\"></i>\n                </button>\n            </div>\n\n            <div class=\"modal-body\">\n                <div style=\"margin-bottom: var(--space-lg);\">\n                    <h3>${this.escapeHtml(roleName)}</h3>\n                    <p class=\"text-muted\">Assign a PIM group to this role</p>\n                </div>\n\n                <form id=\"assign-group-form\">\n                    <div class=\"form-section\">\n                        <label class=\"form-label\">\n                            <strong>Select Group <span class=\"required\">*</span></strong>\n                            <select name=\"groupId\" class=\"input\" required>\n                                <option value=\"\">-- Select a group --</option>\n                                ${groups.map(g => `\n                                    <option value=\"${g.id}\">${this.escapeHtml(g.displayName)} (${g.memberCount} members)</option>\n                                `).join('')}\n                            </select>\n                            <small class=\"form-hint\">Choose which PIM group to assign to this role</small>\n                        </label>\n                    </div>\n\n                    <div class=\"form-section\">\n                        <label class=\"form-label\">\n                            <strong>Assignment Type <span class=\"required\">*</span></strong>\n                            <select name=\"assignmentType\" class=\"input\" onchange=\"\n                                const value = this.value;\n                                const isPermanent = value.includes('permanent');\n                                document.getElementById('duration-section').style.display = isPermanent ? 'none' : 'block';\n\n                                // Update description\n                                const descriptions = {\n                                    'eligible-permanent': 'Group members can activate this role (no expiration)',\n                                    'eligible-timebound': 'Group members can activate this role (expires after duration)',\n                                    'active-permanent': '⚠️ Group members are ALWAYS active in this role (bypasses PIM)',\n                                    'active-timebound': 'Group members are active in this role until expiration'\n                                };\n                                document.getElementById('assignment-type-hint').textContent = descriptions[value] || '';\n                            \" required>\n                                <optgroup label=\"Eligible Assignments (Recommended)\">\n                                    <option value=\"eligible-permanent\">Permanent Eligible (Recommended)</option>\n                                    <option value=\"eligible-timebound\">Time-Bound Eligible</option>\n                                </optgroup>\n                                <optgroup label=\"Active Assignments\">\n                                    <option value=\"active-permanent\">Permanent Active (⚠️ Not Recommended)</option>\n                                    <option value=\"active-timebound\">Time-Bound Active</option>\n                                </optgroup>\n                            </select>\n                            <small class=\"form-hint\" id=\"assignment-type-hint\">\n                                Group members can activate this role (no expiration)\n                            </small>\n                        </label>\n                    </div>\n\n                    <div id=\"duration-section\" style=\"display: none;\">\n                        <div class=\"form-section\">\n                            <label class=\"form-label\">\n                                <strong>Duration (days)</strong>\n                                <input type=\"number\" name=\"durationDays\" class=\"input\" min=\"1\" max=\"365\" value=\"365\" step=\"1\">\n                                <small class=\"form-hint\">How many days should this assignment last? (1-365 days)</small>\n                            </label>\n                        </div>\n                    </div>\n\n                    <div class=\"form-section\">\n                        <label class=\"form-label\">\n                            <strong>Justification</strong>\n                            <textarea name=\"justification\" class=\"input\" rows=\"3\"\n                                      placeholder=\"Explain why this group needs access to this role...\"></textarea>\n                            <small class=\"form-hint\">Provide business justification for this assignment</small>\n                        </label>\n                    </div>\n\n                    <div class=\"modal-footer\">\n                        <button type=\"button\" class=\"btn btn-secondary\" onclick=\"app.closeModal()\">\n                            <i class=\"fas fa-times\"></i> Cancel\n                        </button>\n                        <button type=\"submit\" class=\"btn btn-primary\">\n                            <i class=\"fas fa-check\"></i> Assign Group\n                        </button>\n                    </div>\n                </form>\n            </div>\n        `;\n\n        this.showModal(content);\n\n        // Handle form submission\n        document.getElementById('assign-group-form').addEventListener('submit', async (e) => {\n            e.preventDefault();\n            await this.handleAssignGroup(roleId, roleName, e.target);\n        });\n    }\n\n    /**\n     * Handle assign group form submission\n     * @param {string} roleId - Role ID\n     * @param {string} roleName - Role display name\n     * @param {HTMLFormElement} form - Form element\n     */\n    async handleAssignGroup(roleId, roleName, form) {\n        const formData = new FormData(form);\n        const groupId = formData.get('groupId');\n        const assignmentType = formData.get('assignmentType');\n        const durationDays = parseInt(formData.get('durationDays')) || 365;\n        const justification = formData.get('justification') || `PIM assignment to ${roleName}`;\n\n        if (!groupId) {\n            this.showToast('Please select a group', 'error');\n            return;\n        }\n\n        // Parse assignment type\n        const [assignmentMode, durationType] = assignmentType.split('-');\n        const isActive = assignmentMode === 'active';\n        const isPermanent = durationType === 'permanent';\n\n        // Warn about active assignments (bypass PIM)\n        if (isActive) {\n            const confirmed = confirm(\n                '⚠️ WARNING: Active assignments bypass PIM protections!\\n\\n' +\n                'Group members will have IMMEDIATE access to this role without needing to activate.\\n\\n' +\n                'This is NOT recommended for privileged roles. Consider using Eligible assignments instead.\\n\\n' +\n                'Continue with Active assignment?'\n            );\n\n            if (!confirmed) {\n                return;\n            }\n        }\n\n        // Find group name for confirmation\n        const groupsResult = await graphService.getPIMGroups();\n        const group = groupsResult.groups?.find(g => g.id === groupId);\n        const groupName = group?.displayName || 'Unknown Group';\n\n        this.closeModal();\n        this.showLoading(`Assigning ${groupName} to ${roleName}...`);\n\n        // Calculate dates\n        const startDateTime = new Date().toISOString();\n        const endDateTime = isPermanent\n            ? null\n            : new Date(Date.now() + durationDays * 24 * 60 * 60 * 1000).toISOString();\n\n        // Call the appropriate method based on assignment mode\n        let result;\n        if (isActive) {\n            result = await graphService.createDirectoryRoleActiveAssignment(\n                groupId,\n                roleId,\n                justification,\n                startDateTime,\n                endDateTime\n            );\n        } else {\n            result = await graphService.createDirectoryRoleEligibleAssignment(\n                groupId,\n                roleId,\n                justification,\n                startDateTime,\n                endDateTime\n            );\n        }\n\n        this.hideLoading();\n\n        if (result.success) {\n            const mode = isActive ? 'Active' : 'Eligible';\n            const duration = isPermanent ? 'permanently' : `for ${durationDays} days`;\n            this.showToast(\n                `Successfully assigned \"${groupName}\" as ${mode} to \"${roleName}\" ${duration}`,\n                'success'\n            );\n        } else {\n            this.showToast(\n                `Failed to assign group: ${result.error}`,\n                'error'\n            );\n        }\n    }\n}\n"],"names":["RolesPage","BasePage","app","container","params","allRoles","CACHE_KEYS","result","graphService","roles","privilegeBadge","level","config","c","r","order","privilegeOrder","a","b","filterType","value","row","text","privilegeLevel","isBuiltIn","matchesSearch","matchesPrivilege","matchesType","rows","visibleCount","totalCount","header","page","size","roleId","role","policy","content","e","tabName","btn","targetTab","form","formData","parseEmailList","email","policyUpdate","roleName","groupsResult","groups","g","groupId","assignmentType","durationDays","justification","assignmentMode","durationType","isActive","isPermanent","groupName","startDateTime","endDateTime","mode","duration"],"mappings":"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"}