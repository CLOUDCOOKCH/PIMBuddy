{"version":3,"file":"page-dashboardpage-BK0TZRHp.js","sources":["../../src/pages/DashboardPage.js"],"sourcesContent":["/**\n * Dashboard Page\n * Command center with stats, quick actions, recent activity\n */\n\nimport { BasePage } from '../core/PageRouter.js';\nimport { graphService } from '../services/graphService.js';\nimport { CACHE_KEYS } from '../core/CacheManager.js';\n\nexport class DashboardPage extends BasePage {\n    constructor(app) {\n        super(app);\n    }\n\n    /**\n     * Render Dashboard page\n     * @param {HTMLElement} container - Page container\n     * @param {Object} params - Optional parameters\n     */\n    async render(container, params = {}) {\n        // Show landing page if not connected\n        if (!this.isConnected()) {\n            this.renderLandingPage(container);\n            return;\n        }\n\n        let stats = {\n            totalGroups: 0,\n            eligibleAssignments: 0,\n            activeAssignments: 0,\n            pendingApprovals: 0,\n            expiringAssignments: 0,\n            healthScore: 0,\n            healthStatus: 'unknown'\n        };\n\n        let recentActivities = [];\n        let expiringList = [];\n        let healthWarnings = [];\n\n        if (this.isConnected()) {\n            this.showLoading('Loading dashboard data...');\n            try {\n                // Try cache first\n                const cached = this.getCached(CACHE_KEYS.DASHBOARD_STATS.key);\n\n                if (cached) {\n                    stats = cached.stats;\n                    recentActivities = cached.recentActivities;\n                    expiringList = cached.expiringList;\n                    healthWarnings = cached.healthWarnings;\n                } else {\n                    // Load all data in parallel\n                    const [groupsResult, assignmentsResult, approvalsResult, healthResult, auditResult] = await Promise.all([\n                        graphService.getPIMGroups(),\n                        graphService.getRoleAssignmentsWithExpiration(),\n                        graphService.getPendingApprovals(),\n                        graphService.runHealthCheck(),\n                        graphService.getPIMAuditLogs(7)\n                    ]);\n\n                    if (groupsResult.success) {\n                        stats.totalGroups = groupsResult.count;\n                    }\n\n                    if (assignmentsResult.success) {\n                        stats.activeAssignments = assignmentsResult.activeCount;\n                        stats.eligibleAssignments = assignmentsResult.eligibleCount;\n                        stats.expiringAssignments = assignmentsResult.expiringCount;\n                        expiringList = assignmentsResult.expiringAssignments.slice(0, 5);\n                    }\n\n                    if (approvalsResult.success) {\n                        stats.pendingApprovals = approvalsResult.count;\n                    }\n\n                    if (healthResult.success) {\n                        stats.healthScore = healthResult.healthScore;\n                        stats.healthStatus = healthResult.status;\n                        healthWarnings = healthResult.warnings || [];\n                    }\n\n                    if (auditResult.success) {\n                        recentActivities = auditResult.logs.slice(0, 5);\n                    }\n\n                    // Cache the dashboard data\n                    this.setCached(CACHE_KEYS.DASHBOARD_STATS.key, {\n                        stats,\n                        recentActivities,\n                        expiringList,\n                        healthWarnings\n                    });\n                }\n            } catch (error) {\n                console.error('Dashboard load error:', error);\n            }\n            this.hideLoading();\n        }\n\n        const setupMessage = !this.app.isConfigured ? `\n            <div class=\"setup-banner\">\n                <i class=\"fas fa-info-circle\"></i>\n                <div>\n                    <strong>Setup Required</strong>\n                    <p>Click the <strong>Setup</strong> button in the sidebar to configure PIMBuddy for your tenant.</p>\n                </div>\n                <button class=\"btn btn-primary btn-sm\" onclick=\"app.showSetupWizard()\">Run Setup</button>\n            </div>\n        ` : '';\n\n        const getHealthColor = (status) => {\n            switch(status) {\n                case 'healthy': return 'success';\n                case 'warning': return 'warning';\n                case 'critical': return 'danger';\n                default: return 'secondary';\n            }\n        };\n\n        const formatDate = (dateStr) => {\n            if (!dateStr) return 'N/A';\n            const date = new Date(dateStr);\n            return date.toLocaleString();\n        };\n\n        const formatRelativeTime = (dateStr) => {\n            if (!dateStr) return 'N/A';\n            const date = new Date(dateStr);\n            const now = new Date();\n            const diff = date - now;\n            const days = Math.floor(diff / (1000 * 60 * 60 * 24));\n            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n\n            if (days > 0) return `in ${days}d ${hours}h`;\n            if (hours > 0) return `in ${hours}h`;\n            return 'soon';\n        };\n\n        container.innerHTML = `\n            <!-- Dramatic Dashboard Header -->\n            <div style=\"position: relative; margin-bottom: var(--space-2xl); overflow: hidden;\">\n                <div style=\"position: absolute; top: -100%; right: -10%; width: 400px; height: 400px; background: radial-gradient(circle, var(--accent-primary-dim), transparent); filter: blur(100px); animation: float 12s ease-in-out infinite; pointer-events: none;\"></div>\n\n                <div style=\"position: relative; z-index: 1;\">\n                    <div style=\"display: inline-flex; align-items: center; gap: var(--space-xs); padding: var(--space-xs) var(--space-md); background: rgba(0, 255, 159, 0.05); border: 1px solid var(--accent-primary); border-radius: var(--radius-full); margin-bottom: var(--space-md); font-family: var(--font-mono); font-size: 0.65rem; text-transform: uppercase; letter-spacing: 0.15em;\">\n                        <span style=\"width: 6px; height: 6px; background: var(--accent-primary); border-radius: 50%; box-shadow: 0 0 10px var(--accent-primary); animation: pulse 2s ease-in-out infinite;\"></span>\n                        <span style=\"color: var(--accent-primary); font-weight: 600;\">SYSTEM STATUS</span>\n                        <span style=\"color: var(--text-muted);\">|</span>\n                        <span style=\"color: var(--text-secondary);\">REALTIME MONITORING</span>\n                    </div>\n\n                    <h1 style=\"font-family: var(--font-display); font-size: clamp(2rem, 4vw, 3.5rem); font-weight: 800; line-height: 1.1; margin-bottom: var(--space-sm); letter-spacing: -0.03em;\">\n                        <span style=\"background: linear-gradient(135deg, var(--accent-primary), #00ffff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; filter: drop-shadow(0 0 30px rgba(0, 255, 159, 0.3));\">\n                            COMMAND\n                        </span>\n                        <span style=\"color: var(--text-primary);\"> CENTER</span>\n                    </h1>\n                    <p style=\"font-size: 0.95rem; color: var(--text-secondary); font-family: var(--font-mono);\">\n                        Privileged Access Management Overview\n                    </p>\n                </div>\n            </div>\n\n            ${setupMessage}\n\n            <!-- Dramatic Stats Grid -->\n            <div class=\"stats-grid\" style=\"margin-bottom: var(--space-2xl);\">\n                <!-- Health Score - Hero Card -->\n                <div class=\"card stat-card ${stats.healthScore > 0 ? 'clickable' : ''}\"\n                     onclick=\"${stats.healthScore > 0 ? 'app.router.navigateTo(\\'health-check\\')' : ''}\"\n                     style=\"position: relative; overflow: hidden; background: linear-gradient(135deg, var(--bg-elevated), var(--bg-surface)); border: 2px solid ${stats.healthStatus === 'healthy' ? 'var(--accent-primary)' : stats.healthStatus === 'warning' ? 'var(--color-warning)' : 'var(--color-error)'};\" role=\"button\" ${stats.healthScore > 0 ? 'aria-label=\"View health check details\"' : ''} tabindex=\"${stats.healthScore > 0 ? '0' : '-1'}\">\n                    <div style=\"position: absolute; inset: 0; background: radial-gradient(circle at top right, ${stats.healthStatus === 'healthy' ? 'var(--accent-primary-dim)' : stats.healthStatus === 'warning' ? 'rgba(255, 170, 0, 0.1)' : 'rgba(255, 0, 85, 0.1)'}, transparent); filter: blur(40px); pointer-events: none;\"></div>\n                    <div style=\"position: relative; z-index: 1;\">\n                        <div style=\"width: 64px; height: 64px; background: ${stats.healthStatus === 'healthy' ? 'var(--accent-primary-dim)' : stats.healthStatus === 'warning' ? 'var(--color-warning-dim)' : 'rgba(255, 0, 85, 0.1)'}; border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: center; margin-bottom: var(--space-md); box-shadow: 0 0 30px ${stats.healthStatus === 'healthy' ? 'rgba(0, 255, 159, 0.3)' : stats.healthStatus === 'warning' ? 'rgba(255, 170, 0, 0.3)' : 'rgba(255, 0, 85, 0.3)'};\">\n                            <i class=\"fas fa-heart-pulse\" style=\"font-size: 2rem; color: ${stats.healthStatus === 'healthy' ? 'var(--accent-primary)' : stats.healthStatus === 'warning' ? 'var(--color-warning)' : 'var(--color-error)'};\"></i>\n                        </div>\n                        <div style=\"font-family: var(--font-display); font-size: 3rem; font-weight: 800; line-height: 1; margin-bottom: var(--space-xs); background: linear-gradient(135deg, ${stats.healthStatus === 'healthy' ? 'var(--accent-primary), #00ffff' : stats.healthStatus === 'warning' ? 'var(--color-warning), #ffdd00' : 'var(--color-error), #ff0099'}); -webkit-background-clip: text; -webkit-text-fill-color: transparent;\">\n                            ${stats.healthScore}%\n                        </div>\n                        <div style=\"font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-secondary); font-family: var(--font-mono); margin-bottom: var(--space-xs);\">HEALTH SCORE</div>\n                        ${stats.healthScore > 0 ? '<div style=\"font-size: 0.7rem; color: var(--text-muted); font-family: var(--font-mono);\">⚡ CLICK FOR ANALYSIS</div>' : ''}\n                    </div>\n                </div>\n\n                <!-- Other Stat Cards -->\n                <div class=\"card stat-card\" style=\"position: relative; overflow: hidden;\">\n                    <div style=\"position: absolute; top: 50%; right: -20%; width: 150px; height: 150px; background: radial-gradient(circle, rgba(0, 255, 159, 0.05), transparent); filter: blur(40px); pointer-events: none;\"></div>\n                    <div style=\"position: relative; z-index: 1;\">\n                        <div style=\"width: 56px; height: 56px; background: var(--accent-primary-dim); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; margin-bottom: var(--space-md);\">\n                            <i class=\"fas fa-users\" style=\"font-size: 1.5rem; color: var(--accent-primary);\"></i>\n                        </div>\n                        <div style=\"font-family: var(--font-display); font-size: 2.5rem; font-weight: 800; line-height: 1; margin-bottom: var(--space-xs); color: var(--text-primary);\">\n                            ${stats.totalGroups}\n                        </div>\n                        <div style=\"font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-secondary); font-family: var(--font-mono);\">PIM GROUPS</div>\n                    </div>\n                </div>\n\n                <div class=\"card stat-card\" style=\"position: relative; overflow: hidden;\">\n                    <div style=\"position: absolute; top: 50%; right: -20%; width: 150px; height: 150px; background: radial-gradient(circle, rgba(255, 0, 128, 0.05), transparent); filter: blur(40px); pointer-events: none;\"></div>\n                    <div style=\"position: relative; z-index: 1;\">\n                        <div style=\"width: 56px; height: 56px; background: var(--accent-secondary-dim); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; margin-bottom: var(--space-md);\">\n                            <i class=\"fas fa-user-check\" style=\"font-size: 1.5rem; color: var(--accent-secondary);\"></i>\n                        </div>\n                        <div style=\"font-family: var(--font-display); font-size: 2.5rem; font-weight: 800; line-height: 1; margin-bottom: var(--space-xs); color: var(--text-primary);\">\n                            ${stats.eligibleAssignments}\n                        </div>\n                        <div style=\"font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-secondary); font-family: var(--font-mono);\">ELIGIBLE</div>\n                    </div>\n                </div>\n\n                <div class=\"card stat-card\" style=\"position: relative; overflow: hidden;\">\n                    <div style=\"position: absolute; top: 50%; right: -20%; width: 150px; height: 150px; background: radial-gradient(circle, rgba(0, 255, 159, 0.05), transparent); filter: blur(40px); pointer-events: none;\"></div>\n                    <div style=\"position: relative; z-index: 1;\">\n                        <div style=\"width: 56px; height: 56px; background: var(--color-success-dim); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; margin-bottom: var(--space-md);\">\n                            <i class=\"fas fa-user-shield\" style=\"font-size: 1.5rem; color: var(--color-success);\"></i>\n                        </div>\n                        <div style=\"font-family: var(--font-display); font-size: 2.5rem; font-weight: 800; line-height: 1; margin-bottom: var(--space-xs); color: var(--text-primary);\">\n                            ${stats.activeAssignments}\n                        </div>\n                        <div style=\"font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-secondary); font-family: var(--font-mono);\">ACTIVE</div>\n                    </div>\n                </div>\n\n                <div class=\"card stat-card ${stats.expiringAssignments > 0 ? 'clickable' : ''}\"\n                     onclick=\"${stats.expiringAssignments > 0 ? 'app.router.navigateTo(\\'expiring-assignments\\')' : ''}\"\n                     style=\"position: relative; overflow: hidden; ${stats.expiringAssignments > 0 ? 'border: 1px solid var(--color-warning);' : ''}\" role=\"${stats.expiringAssignments > 0 ? 'button' : ''}\" ${stats.expiringAssignments > 0 ? 'aria-label=\"View expiring assignments\"' : ''} tabindex=\"${stats.expiringAssignments > 0 ? '0' : '-1'}\">\n                    <div style=\"position: absolute; top: 50%; right: -20%; width: 150px; height: 150px; background: radial-gradient(circle, rgba(255, 170, 0, 0.05), transparent); filter: blur(40px); pointer-events: none;\"></div>\n                    <div style=\"position: relative; z-index: 1;\">\n                        <div style=\"width: 56px; height: 56px; background: ${stats.expiringAssignments > 0 ? 'var(--color-warning-dim)' : 'var(--bg-elevated)'}; border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; margin-bottom: var(--space-md);\">\n                            <i class=\"fas fa-hourglass-end\" style=\"font-size: 1.5rem; color: ${stats.expiringAssignments > 0 ? 'var(--color-warning)' : 'var(--text-muted)'};\"></i>\n                        </div>\n                        <div style=\"font-family: var(--font-display); font-size: 2.5rem; font-weight: 800; line-height: 1; margin-bottom: var(--space-xs); color: ${stats.expiringAssignments > 0 ? 'var(--color-warning)' : 'var(--text-primary)'};\">\n                            ${stats.expiringAssignments}\n                        </div>\n                        <div style=\"font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-secondary); font-family: var(--font-mono);\">EXPIRING</div>\n                        ${stats.expiringAssignments > 0 ? '<div style=\"font-size: 0.7rem; color: var(--text-muted); font-family: var(--font-mono);\">⚡ CLICK TO VIEW</div>' : ''}\n                    </div>\n                </div>\n\n                <div class=\"card stat-card ${stats.pendingApprovals > 0 ? 'clickable' : ''}\"\n                     onclick=\"${stats.pendingApprovals > 0 ? 'app.router.navigateTo(\\'pending-approvals\\')' : ''}\"\n                     style=\"position: relative; overflow: hidden; ${stats.pendingApprovals > 0 ? 'border: 1px solid var(--color-warning);' : ''}\" role=\"${stats.pendingApprovals > 0 ? 'button' : ''}\" ${stats.pendingApprovals > 0 ? 'aria-label=\"Review pending approvals\"' : ''} tabindex=\"${stats.pendingApprovals > 0 ? '0' : '-1'}\">\n                    <div style=\"position: absolute; top: 50%; right: -20%; width: 150px; height: 150px; background: radial-gradient(circle, rgba(255, 170, 0, 0.05), transparent); filter: blur(40px); pointer-events: none;\"></div>\n                    <div style=\"position: relative; z-index: 1;\">\n                        <div style=\"width: 56px; height: 56px; background: ${stats.pendingApprovals > 0 ? 'var(--color-warning-dim)' : 'var(--bg-elevated)'}; border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; margin-bottom: var(--space-md);\">\n                            <i class=\"fas fa-clock\" style=\"font-size: 1.5rem; color: ${stats.pendingApprovals > 0 ? 'var(--color-warning)' : 'var(--text-muted)'};\"></i>\n                        </div>\n                        <div style=\"font-family: var(--font-display); font-size: 2.5rem; font-weight: 800; line-height: 1; margin-bottom: var(--space-xs); color: ${stats.pendingApprovals > 0 ? 'var(--color-warning)' : 'var(--text-primary)'};\">\n                            ${stats.pendingApprovals}\n                        </div>\n                        <div style=\"font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-secondary); font-family: var(--font-mono);\">APPROVALS</div>\n                        ${stats.pendingApprovals > 0 ? '<div style=\"font-size: 0.7rem; color: var(--text-muted); font-family: var(--font-mono);\">⚡ CLICK TO REVIEW</div>' : ''}\n                    </div>\n                </div>\n            </div>\n\n            <!-- Dashboard Grid with Asymmetric Layout -->\n            <div class=\"dashboard-grid\">\n                <!-- Quick Actions - Cyberpunk Panel -->\n                <div class=\"card\" style=\"position: relative; overflow: hidden; background: linear-gradient(135deg, var(--bg-elevated), var(--bg-surface)); border: 1px solid var(--border-subtle);\">\n                    <div style=\"position: absolute; top: -50%; right: -20%; width: 250px; height: 250px; background: radial-gradient(circle, var(--accent-primary-dim), transparent); filter: blur(60px); pointer-events: none;\"></div>\n                    <div style=\"position: relative; z-index: 1;\">\n                        <div style=\"display: flex; align-items: center; gap: var(--space-sm); margin-bottom: var(--space-lg); padding-bottom: var(--space-md); border-bottom: 1px solid var(--border-subtle);\">\n                            <div style=\"width: 40px; height: 40px; background: var(--accent-primary-dim); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;\">\n                                <i class=\"fas fa-bolt\" style=\"color: var(--accent-primary); font-size: 1.2rem;\"></i>\n                            </div>\n                            <h2 style=\"font-family: var(--font-display); font-size: 1.3rem; font-weight: 700; margin: 0; text-transform: uppercase; letter-spacing: 0.05em;\">\n                                Quick Actions\n                            </h2>\n                        </div>\n                        <div class=\"quick-actions\" style=\"display: flex; flex-direction: column; gap: var(--space-sm);\">\n                            <button class=\"btn btn-primary btn-block\" onclick=\"app.router.navigateTo('baseline')\" ${!this.isConnected() ? 'disabled' : ''} style=\"position: relative; overflow: hidden; text-align: left; justify-content: flex-start; gap: var(--space-md);\" aria-label=\"Deploy baseline configuration\">\n                                <i class=\"fas fa-rocket\"></i>\n                                <span>Deploy Baseline Configuration</span>\n                            </button>\n                            <button class=\"btn btn-secondary btn-block\" onclick=\"app.router.navigateTo('health-check')\" ${!this.isConnected() ? 'disabled' : ''} style=\"text-align: left; justify-content: flex-start; gap: var(--space-md);\" aria-label=\"Run security health scan\">\n                                <i class=\"fas fa-heart-pulse\"></i>\n                                <span>Run Security Health Scan</span>\n                            </button>\n                            <button class=\"btn btn-secondary btn-block\" onclick=\"app.router.navigateTo('pim-activity')\" ${!this.isConnected() ? 'disabled' : ''} style=\"text-align: left; justify-content: flex-start; gap: var(--space-md);\" aria-label=\"View audit activity log\">\n                                <i class=\"fas fa-history\"></i>\n                                <span>View Audit Activity Log</span>\n                            </button>\n                            <button class=\"btn btn-secondary btn-block\" onclick=\"app.router.navigateTo('role-coverage')\" ${!this.isConnected() ? 'disabled' : ''} style=\"text-align: left; justify-content: flex-start; gap: var(--space-md);\" aria-label=\"Analyze coverage report\">\n                                <i class=\"fas fa-chart-pie\"></i>\n                                <span>Analyze Coverage Report</span>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Health Warnings - Alert Panel -->\n                <div class=\"card\" style=\"position: relative; overflow: hidden; background: linear-gradient(135deg, var(--bg-elevated), var(--bg-surface)); border: 1px solid ${healthWarnings.length > 0 ? 'var(--color-warning)' : 'var(--border-subtle)'};\">\n                    <div style=\"position: absolute; top: -50%; left: -20%; width: 250px; height: 250px; background: radial-gradient(circle, ${healthWarnings.length > 0 ? 'rgba(255, 170, 0, 0.05)' : 'var(--accent-secondary-dim)'}, transparent); filter: blur(60px); pointer-events: none;\"></div>\n                    <div style=\"position: relative; z-index: 1;\">\n                        <div style=\"display: flex; align-items: center; gap: var(--space-sm); margin-bottom: var(--space-lg); padding-bottom: var(--space-md); border-bottom: 1px solid var(--border-subtle);\">\n                            <div style=\"width: 40px; height: 40px; background: ${healthWarnings.length > 0 ? 'var(--color-warning-dim)' : 'var(--accent-secondary-dim)'}; border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;\">\n                                <i class=\"fas ${healthWarnings.length > 0 ? 'fa-exclamation-triangle' : 'fa-shield-check'}\" style=\"color: ${healthWarnings.length > 0 ? 'var(--color-warning)' : 'var(--accent-secondary)'}; font-size: 1.2rem;\"></i>\n                            </div>\n                            <div style=\"flex: 1;\">\n                                <h2 style=\"font-family: var(--font-display); font-size: 1.3rem; font-weight: 700; margin: 0; text-transform: uppercase; letter-spacing: 0.05em;\">\n                                    Alerts & Warnings\n                                </h2>\n                            </div>\n                            ${healthWarnings.length > 0 ? `<span class=\"badge\" style=\"background: var(--color-warning-dim); color: var(--color-warning); font-family: var(--font-mono); font-size: 0.7rem;\" aria-label=\"${healthWarnings.length} warnings\">${healthWarnings.length}</span>` : ''}\n                        </div>\n                        <div class=\"recommendations-list\" style=\"max-height: 300px; overflow-y: auto;\">\n                            ${healthWarnings.length > 0 ? healthWarnings.map(w => `\n                                <div style=\"padding: var(--space-md); margin-bottom: var(--space-sm); background: rgba(255, 170, 0, 0.05); border-left: 3px solid ${w.severity === 'warning' ? 'var(--color-warning)' : 'var(--color-info)'}; border-radius: var(--radius-sm);\" role=\"alert\">\n                                    <div style=\"display: flex; align-items: start; gap: var(--space-sm);\">\n                                        <i class=\"fas ${w.severity === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle'}\" style=\"color: ${w.severity === 'warning' ? 'var(--color-warning)' : 'var(--color-info)'}; margin-top: 2px;\" aria-hidden=\"true\"></i>\n                                        <div style=\"flex: 1;\">\n                                            <div style=\"font-weight: 600; font-family: var(--font-mono); font-size: 0.8rem; text-transform: uppercase; color: ${w.severity === 'warning' ? 'var(--color-warning)' : 'var(--color-info)'}; margin-bottom: var(--space-xs);\">\n                                                ${this.escapeHtml(w.category)}\n                                            </div>\n                                            <div style=\"color: var(--text-secondary); font-size: 0.9rem; line-height: 1.5;\">\n                                                ${this.escapeHtml(w.message)}\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            `).join('') : `\n                                <div style=\"text-align: center; padding: var(--space-2xl); color: var(--text-secondary);\">\n                                    <div style=\"width: 80px; height: 80px; margin: 0 auto var(--space-lg); background: var(--accent-primary-dim); border-radius: 50%; display: flex; align-items: center; justify-content: center;\">\n                                        <i class=\"fas fa-shield-check\" style=\"font-size: 2.5rem; color: var(--accent-primary);\"></i>\n                                    </div>\n                                    <div style=\"font-family: var(--font-display); font-size: 1.2rem; font-weight: 700; margin-bottom: var(--space-xs); color: var(--text-primary);\">\n                                        All Systems Operational\n                                    </div>\n                                    <div style=\"font-family: var(--font-mono); font-size: 0.85rem; color: var(--text-muted);\">\n                                        No security issues detected\n                                    </div>\n                                </div>\n                            `}\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Recent Activity - Data Stream Panel -->\n                <div class=\"card\" style=\"position: relative; overflow: hidden; background: linear-gradient(135deg, var(--bg-elevated), var(--bg-surface)); border: 1px solid var(--border-subtle);\">\n                    <div style=\"position: absolute; bottom: -50%; left: -20%; width: 250px; height: 250px; background: radial-gradient(circle, var(--accent-secondary-dim), transparent); filter: blur(60px); pointer-events: none;\"></div>\n                    <div style=\"position: relative; z-index: 1;\">\n                        <div style=\"display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-lg); padding-bottom: var(--space-md); border-bottom: 1px solid var(--border-subtle);\">\n                            <div style=\"display: flex; align-items: center; gap: var(--space-sm);\">\n                                <div style=\"width: 40px; height: 40px; background: var(--accent-secondary-dim); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;\">\n                                    <i class=\"fas fa-history\" style=\"color: var(--accent-secondary); font-size: 1.2rem;\"></i>\n                                </div>\n                                <h2 style=\"font-family: var(--font-display); font-size: 1.3rem; font-weight: 700; margin: 0; text-transform: uppercase; letter-spacing: 0.05em;\">\n                                    Recent Activity\n                                </h2>\n                            </div>\n                            <button class=\"btn btn-sm btn-secondary\" onclick=\"app.router.navigateTo('pim-activity')\" ${!this.isConnected() ? 'disabled' : ''} style=\"font-family: var(--font-mono); font-size: 0.7rem;\" aria-label=\"View all activity\">\n                                VIEW ALL →\n                            </button>\n                        </div>\n                        <div style=\"max-height: 300px; overflow-y: auto;\">\n                            ${recentActivities.length > 0 ? recentActivities.map((activity, idx) => `\n                                <div style=\"padding: var(--space-md); margin-bottom: var(--space-xs); background: ${idx % 2 === 0 ? 'rgba(255, 0, 128, 0.02)' : 'rgba(0, 255, 159, 0.02)'}; border-left: 2px solid ${idx % 2 === 0 ? 'var(--accent-secondary)' : 'var(--accent-primary)'}; border-radius: var(--radius-sm);\">\n                                    <div style=\"display: flex; justify-content: space-between; align-items: start; gap: var(--space-md);\">\n                                        <div style=\"flex: 1; min-width: 0;\">\n                                            <div style=\"font-weight: 600; font-size: 0.95rem; margin-bottom: var(--space-xs); color: var(--text-primary); overflow: hidden; text-overflow: ellipsis;\">\n                                                ${this.escapeHtml(activity.activityDisplayName || 'Activity')}\n                                            </div>\n                                            <div style=\"display: flex; align-items: center; gap: var(--space-xs); font-size: 0.8rem; color: var(--text-secondary); font-family: var(--font-mono);\">\n                                                <i class=\"fas fa-user\" style=\"font-size: 0.7rem;\"></i>\n                                                <span>${this.escapeHtml(activity.initiatedBy?.user?.displayName || 'System')}</span>\n                                            </div>\n                                        </div>\n                                        <div style=\"font-size: 0.75rem; color: var(--text-muted); font-family: var(--font-mono); white-space: nowrap;\">\n                                            ${formatDate(activity.activityDateTime)}\n                                        </div>\n                                    </div>\n                                </div>\n                            `).join('') : `\n                                <div style=\"text-align: center; padding: var(--space-2xl); color: var(--text-secondary);\">\n                                    <div style=\"width: 80px; height: 80px; margin: 0 auto var(--space-lg); background: var(--accent-secondary-dim); border-radius: 50%; display: flex; align-items: center; justify-content: center;\">\n                                        <i class=\"fas fa-inbox\" style=\"font-size: 2.5rem; color: var(--accent-secondary); opacity: 0.5;\"></i>\n                                    </div>\n                                    <div style=\"font-family: var(--font-mono); font-size: 0.85rem; color: var(--text-muted);\">\n                                        ${this.isConnected() ? 'No recent activity detected' : 'Connect to view activity stream'}\n                                    </div>\n                                </div>\n                            `}\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Expiring Assignments - Warning Panel -->\n                <div class=\"card\" style=\"position: relative; overflow: hidden; background: linear-gradient(135deg, var(--bg-elevated), var(--bg-surface)); border: 1px solid ${expiringList.length > 0 ? 'var(--color-warning)' : 'var(--border-subtle)'};\">\n                    <div style=\"position: absolute; bottom: -50%; right: -20%; width: 250px; height: 250px; background: radial-gradient(circle, ${expiringList.length > 0 ? 'rgba(255, 170, 0, 0.05)' : 'var(--accent-primary-dim)'}, transparent); filter: blur(60px); pointer-events: none;\"></div>\n                    <div style=\"position: relative; z-index: 1;\">\n                        <div style=\"display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-lg); padding-bottom: var(--space-md); border-bottom: 1px solid var(--border-subtle);\">\n                            <div style=\"display: flex; align-items: center; gap: var(--space-sm);\">\n                                <div style=\"width: 40px; height: 40px; background: ${expiringList.length > 0 ? 'var(--color-warning-dim)' : 'var(--accent-primary-dim)'}; border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;\">\n                                    <i class=\"fas fa-hourglass-end\" style=\"color: ${expiringList.length > 0 ? 'var(--color-warning)' : 'var(--accent-primary)'}; font-size: 1.2rem;\"></i>\n                                </div>\n                                <div style=\"flex: 1;\">\n                                    <h2 style=\"font-family: var(--font-display); font-size: 1.3rem; font-weight: 700; margin: 0; text-transform: uppercase; letter-spacing: 0.05em;\">\n                                        Expiring Soon\n                                    </h2>\n                                </div>\n                                ${expiringList.length > 0 ? `<span class=\"badge\" style=\"background: var(--color-warning-dim); color: var(--color-warning); font-family: var(--font-mono); font-size: 0.7rem;\" aria-label=\"${expiringList.length} expiring\">${expiringList.length}</span>` : ''}\n                            </div>\n                            <button class=\"btn btn-sm btn-secondary\" onclick=\"app.router.navigateTo('expiring-assignments')\" ${!this.isConnected() || expiringList.length === 0 ? 'disabled' : ''} style=\"font-family: var(--font-mono); font-size: 0.7rem;\" aria-label=\"View all expiring assignments\">\n                                VIEW ALL →\n                            </button>\n                        </div>\n                        <div style=\"max-height: 300px; overflow-y: auto;\">\n                            ${expiringList.length > 0 ? expiringList.map(assignment => `\n                                <div style=\"padding: var(--space-md); margin-bottom: var(--space-sm); background: rgba(255, 170, 0, 0.05); border-left: 3px solid var(--color-warning); border-radius: var(--radius-sm);\">\n                                    <div style=\"display: flex; justify-content: space-between; align-items: start; gap: var(--space-md);\">\n                                        <div style=\"flex: 1; min-width: 0;\">\n                                            <div style=\"font-weight: 600; font-size: 0.95rem; margin-bottom: var(--space-xs); color: var(--text-primary);\">\n                                                ${this.escapeHtml(assignment.principal?.displayName || 'Unknown')}\n                                            </div>\n                                            <div style=\"display: flex; align-items: center; gap: var(--space-xs); font-size: 0.8rem; color: var(--text-secondary); flex-wrap: wrap;\">\n                                                <span style=\"font-family: var(--font-mono);\">${this.escapeHtml(assignment.roleDefinition?.displayName || 'Unknown Role')}</span>\n                                                <span class=\"badge\" style=\"background: ${assignment.type === 'active' ? 'var(--color-success-dim)' : 'var(--bg-elevated)'}; color: ${assignment.type === 'active' ? 'var(--color-success)' : 'var(--text-secondary)'}; font-size: 0.7rem; text-transform: uppercase;\">\n                                                    ${assignment.type}\n                                                </span>\n                                            </div>\n                                        </div>\n                                        <div style=\"display: flex; align-items: center; gap: var(--space-xs); font-size: 0.8rem; color: var(--color-warning); font-family: var(--font-mono); white-space: nowrap; font-weight: 600;\">\n                                            <i class=\"fas fa-clock\" style=\"font-size: 0.7rem;\"></i>\n                                            <span>${formatRelativeTime(assignment.endDateTime)}</span>\n                                        </div>\n                                    </div>\n                                </div>\n                            `).join('') : `\n                                <div style=\"text-align: center; padding: var(--space-2xl); color: var(--text-secondary);\">\n                                    <div style=\"width: 80px; height: 80px; margin: 0 auto var(--space-lg); background: var(--accent-primary-dim); border-radius: 50%; display: flex; align-items: center; justify-content: center;\">\n                                        <i class=\"fas fa-check-circle\" style=\"font-size: 2.5rem; color: var(--accent-primary);\"></i>\n                                    </div>\n                                    <div style=\"font-family: var(--font-display); font-size: 1.2rem; font-weight: 700; margin-bottom: var(--space-xs); color: var(--text-primary);\">\n                                        All Clear\n                                    </div>\n                                    <div style=\"font-family: var(--font-mono); font-size: 0.85rem; color: var(--text-muted);\">\n                                        ${this.isConnected() ? 'No assignments expiring within 7 days' : 'Connect to monitor expiring assignments'}\n                                    </div>\n                                </div>\n                            `}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }\n\n    /**\n     * Render landing page (shown when not connected)\n     * @param {HTMLElement} container - Page container\n     */\n    renderLandingPage(container) {\n        container.innerHTML = `\n            <!-- Hero Section -->\n            <div style=\"text-align: center; padding: var(--space-xl) 0; max-width: 1200px; margin: 0 auto;\">\n                <div style=\"display: inline-flex; align-items: center; justify-content: center; width: 120px; height: 120px; background: linear-gradient(135deg, var(--accent-primary-dim), var(--accent-secondary-dim)); border-radius: 30px; margin-bottom: var(--space-lg); box-shadow: 0 20px 60px rgba(0, 212, 170, 0.3);\">\n                    <i class=\"fas fa-shield-alt\" style=\"font-size: 4rem; color: var(--accent-primary);\"></i>\n                </div>\n\n                <h1 style=\"font-family: var(--font-display); font-size: 3.5rem; font-weight: 800; margin-bottom: var(--space-md); background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;\">\n                    Welcome to PIMBuddy\n                </h1>\n\n                <p style=\"font-size: 1.3rem; color: var(--text-secondary); max-width: 700px; margin: 0 auto var(--space-xl);\">\n                    Your complete solution for Microsoft Entra PIM management. Deploy, monitor, and secure privileged access with enterprise-grade tools.\n                </p>\n\n                <button class=\"btn btn-primary\" onclick=\"document.getElementById('connect-btn').click()\" style=\"font-size: 1.1rem; padding: var(--space-md) var(--space-xl); box-shadow: 0 10px 30px rgba(0, 212, 170, 0.3);\" aria-label=\"Connect to Microsoft Entra ID\">\n                    <i class=\"fas fa-plug\"></i> Connect to Get Started\n                </button>\n            </div>\n\n            <!-- Key Stats -->\n            <div class=\"stats-grid\" style=\"margin-bottom: var(--space-xl);\">\n                <div class=\"card stat-card\" style=\"border-color: var(--accent-primary-dim);\">\n                    <div class=\"stat-icon primary\">\n                        <i class=\"fas fa-tachometer-alt\"></i>\n                    </div>\n                    <div class=\"stat-value\">5</div>\n                    <div class=\"stat-label\">Monitoring Tools</div>\n                </div>\n                <div class=\"card stat-card\" style=\"border-color: var(--accent-secondary-dim);\">\n                    <div class=\"stat-icon secondary\">\n                        <i class=\"fas fa-rocket\"></i>\n                    </div>\n                    <div class=\"stat-value\">3</div>\n                    <div class=\"stat-label\">Baseline Templates</div>\n                </div>\n                <div class=\"card stat-card\" style=\"border-color: var(--color-success-dim);\">\n                    <div class=\"stat-icon success\">\n                        <i class=\"fas fa-shield-check\"></i>\n                    </div>\n                    <div class=\"stat-value\">100%</div>\n                    <div class=\"stat-label\">Zero Trust Ready</div>\n                </div>\n            </div>\n\n            <!-- Core Features -->\n            <h2 style=\"font-family: var(--font-display); font-size: 2rem; font-weight: 700; text-align: center; margin-bottom: var(--space-lg);\">\n                <i class=\"fas fa-stars\" style=\"color: var(--accent-primary);\"></i> Core Features\n            </h2>\n\n            <div class=\"dashboard-grid\" style=\"margin-bottom: var(--space-xl);\">\n                <!-- Baseline Deployment -->\n                <div class=\"card\" style=\"background: linear-gradient(135deg, var(--bg-elevated), var(--bg-surface)); border: 1px solid var(--accent-primary-dim);\">\n                    <div style=\"display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-md);\">\n                        <div style=\"width: 60px; height: 60px; display: flex; align-items: center; justify-content: center; background: var(--accent-primary-dim); border-radius: var(--radius-lg);\">\n                            <i class=\"fas fa-rocket\" style=\"font-size: 1.8rem; color: var(--accent-primary);\"></i>\n                        </div>\n                        <div>\n                            <h3 style=\"font-size: 1.3rem; font-weight: 700; margin: 0;\">Baseline Deployment</h3>\n                            <p style=\"margin: 0; color: var(--text-secondary); font-size: 0.9rem;\">One-Click PIM Setup</p>\n                        </div>\n                    </div>\n                    <p style=\"color: var(--text-secondary); margin-bottom: var(--space-md);\">\n                        Deploy complete PIM configurations instantly with industry best practices. Choose from Enterprise Standard, High Security (Zero Trust), or Quick Start templates.\n                    </p>\n                    <div style=\"display: flex; flex-wrap: wrap; gap: var(--space-xs);\">\n                        <span class=\"badge badge-primary\"><i class=\"fas fa-check\"></i> Tiered Access (T0/T1/T2)</span>\n                        <span class=\"badge badge-success\"><i class=\"fas fa-check\"></i> MFA Required</span>\n                        <span class=\"badge badge-info\"><i class=\"fas fa-check\"></i> Approval Workflows</span>\n                        <span class=\"badge badge-warning\"><i class=\"fas fa-check\"></i> Auto-Configuration</span>\n                    </div>\n                </div>\n\n                <!-- PIM Health Check -->\n                <div class=\"card\" style=\"background: linear-gradient(135deg, var(--bg-elevated), var(--bg-surface)); border: 1px solid var(--color-success-dim);\">\n                    <div style=\"display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-md);\">\n                        <div style=\"width: 60px; height: 60px; display: flex; align-items: center; justify-content: center; background: var(--color-success-dim); border-radius: var(--radius-lg);\">\n                            <i class=\"fas fa-heart-pulse\" style=\"font-size: 1.8rem; color: var(--color-success);\"></i>\n                        </div>\n                        <div>\n                            <h3 style=\"font-size: 1.3rem; font-weight: 700; margin: 0;\">Health Check Scanner</h3>\n                            <p style=\"margin: 0; color: var(--text-secondary); font-size: 0.9rem;\">Security Analysis</p>\n                        </div>\n                    </div>\n                    <p style=\"color: var(--text-secondary); margin-bottom: var(--space-md);\">\n                        Automated security scanner that analyzes your PIM configuration. Get a health score (0-100%) and actionable recommendations to improve security.\n                    </p>\n                    <div style=\"display: flex; flex-wrap: wrap; gap: var(--space-xs);\">\n                        <span class=\"badge badge-success\"><i class=\"fas fa-search\"></i> Auto-Scan</span>\n                        <span class=\"badge badge-primary\"><i class=\"fas fa-chart-line\"></i> Health Score</span>\n                        <span class=\"badge badge-warning\"><i class=\"fas fa-exclamation-triangle\"></i> Issue Detection</span>\n                        <span class=\"badge badge-info\"><i class=\"fas fa-lightbulb\"></i> Recommendations</span>\n                    </div>\n                </div>\n\n                <!-- Activity Monitoring -->\n                <div class=\"card\" style=\"background: linear-gradient(135deg, var(--bg-elevated), var(--bg-surface)); border: 1px solid var(--accent-secondary-dim);\">\n                    <div style=\"display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-md);\">\n                        <div style=\"width: 60px; height: 60px; display: flex; align-items: center; justify-content: center; background: var(--accent-secondary-dim); border-radius: var(--radius-lg);\">\n                            <i class=\"fas fa-history\" style=\"font-size: 1.8rem; color: var(--accent-secondary);\"></i>\n                        </div>\n                        <div>\n                            <h3 style=\"font-size: 1.3rem; font-weight: 700; margin: 0;\">PIM Activity Log</h3>\n                            <p style=\"margin: 0; color: var(--text-secondary); font-size: 0.9rem;\">Audit & Compliance</p>\n                        </div>\n                    </div>\n                    <p style=\"color: var(--text-secondary); margin-bottom: var(--space-md);\">\n                        Complete audit trail of all PIM role management activities. Track who did what, when, and why with detailed activity logs and filtering.\n                    </p>\n                    <div style=\"display: flex; flex-wrap: wrap; gap: var(--space-xs);\">\n                        <span class=\"badge badge-secondary\"><i class=\"fas fa-calendar\"></i> 30-Day History</span>\n                        <span class=\"badge badge-info\"><i class=\"fas fa-filter\"></i> Advanced Filtering</span>\n                        <span class=\"badge badge-primary\"><i class=\"fas fa-download\"></i> Export Logs</span>\n                    </div>\n                </div>\n\n                <!-- Approval Management -->\n                <div class=\"card\" style=\"background: linear-gradient(135deg, var(--bg-elevated), var(--bg-surface)); border: 1px solid var(--color-warning-dim);\">\n                    <div style=\"display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-md);\">\n                        <div style=\"width: 60px; height: 60px; display: flex; align-items: center; justify-content: center; background: var(--color-warning-dim); border-radius: var(--radius-lg);\">\n                            <i class=\"fas fa-clock\" style=\"font-size: 1.8rem; color: var(--color-warning);\"></i>\n                        </div>\n                        <div>\n                            <h3 style=\"font-size: 1.3rem; font-weight: 700; margin: 0;\">Pending Approvals</h3>\n                            <p style=\"margin: 0; color: var(--text-secondary); font-size: 0.9rem;\">Request Management</p>\n                        </div>\n                    </div>\n                    <p style=\"color: var(--text-secondary); margin-bottom: var(--space-md);\">\n                        Manage PIM activation requests in one place. Review justifications, approve or deny requests, and maintain compliance with one-click actions.\n                    </p>\n                    <div style=\"display: flex; flex-wrap: wrap; gap: var(--space-xs);\">\n                        <span class=\"badge badge-success\"><i class=\"fas fa-check\"></i> Quick Approve</span>\n                        <span class=\"badge badge-danger\"><i class=\"fas fa-times\"></i> Quick Deny</span>\n                        <span class=\"badge badge-info\"><i class=\"fas fa-comment\"></i> Justification View</span>\n                    </div>\n                </div>\n\n                <!-- Expiring Assignments -->\n                <div class=\"card\" style=\"background: linear-gradient(135deg, var(--bg-elevated), var(--bg-surface)); border: 1px solid rgba(245, 158, 11, 0.2);\">\n                    <div style=\"display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-md);\">\n                        <div style=\"width: 60px; height: 60px; display: flex; align-items: center; justify-content: center; background: var(--color-warning-dim); border-radius: var(--radius-lg);\">\n                            <i class=\"fas fa-hourglass-end\" style=\"font-size: 1.8rem; color: var(--color-warning);\"></i>\n                        </div>\n                        <div>\n                            <h3 style=\"font-size: 1.3rem; font-weight: 700; margin: 0;\">Expiring Assignments</h3>\n                            <p style=\"margin: 0; color: var(--text-secondary); font-size: 0.9rem;\">Lifecycle Management</p>\n                        </div>\n                    </div>\n                    <p style=\"color: var(--text-secondary); margin-bottom: var(--space-md);\">\n                        Track role assignments expiring within 7 days. Proactive monitoring prevents access loss and ensures continuous operations.\n                    </p>\n                    <div style=\"display: flex; flex-wrap: wrap; gap: var(--space-xs);\">\n                        <span class=\"badge badge-warning\"><i class=\"fas fa-bell\"></i> 7-Day Alerts</span>\n                        <span class=\"badge badge-primary\"><i class=\"fas fa-clock\"></i> Time Remaining</span>\n                        <span class=\"badge badge-info\"><i class=\"fas fa-list\"></i> Full Tracking</span>\n                    </div>\n                </div>\n\n                <!-- Role Coverage -->\n                <div class=\"card\" style=\"background: linear-gradient(135deg, var(--bg-elevated), var(--bg-surface)); border: 1px solid rgba(59, 130, 246, 0.2);\">\n                    <div style=\"display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-md);\">\n                        <div style=\"width: 60px; height: 60px; display: flex; align-items: center; justify-content: center; background: rgba(59, 130, 246, 0.15); border-radius: var(--radius-lg);\">\n                            <i class=\"fas fa-chart-pie\" style=\"font-size: 1.8rem; color: var(--color-info);\"></i>\n                        </div>\n                        <div>\n                            <h3 style=\"font-size: 1.3rem; font-weight: 700; margin: 0;\">Role Coverage Report</h3>\n                            <p style=\"margin: 0; color: var(--text-secondary); font-size: 0.9rem;\">Analytics Dashboard</p>\n                        </div>\n                    </div>\n                    <p style=\"color: var(--text-secondary); margin-bottom: var(--space-md);\">\n                        Analyze which roles are managed through PIM groups vs direct assignments. Visual reports help identify gaps and improve governance.\n                    </p>\n                    <div style=\"display: flex; flex-wrap: wrap; gap: var(--space-xs);\">\n                        <span class=\"badge badge-info\"><i class=\"fas fa-chart-pie\"></i> Visual Reports</span>\n                        <span class=\"badge badge-primary\"><i class=\"fas fa-percent\"></i> Coverage %</span>\n                        <span class=\"badge badge-warning\"><i class=\"fas fa-flag\"></i> Gap Analysis</span>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Additional Features -->\n            <h2 style=\"font-family: var(--font-display); font-size: 2rem; font-weight: 700; text-align: center; margin-bottom: var(--space-lg);\">\n                <i class=\"fas fa-toolbox\" style=\"color: var(--accent-primary);\"></i> Additional Tools\n            </h2>\n\n            <div class=\"dashboard-grid\" style=\"margin-bottom: var(--space-xl);\">\n                <!-- PIMMaid -->\n                <div class=\"card\">\n                    <div style=\"display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-sm);\">\n                        <div class=\"stat-icon primary\">\n                            <i class=\"fas fa-project-diagram\"></i>\n                        </div>\n                        <h3 style=\"font-size: 1.2rem; font-weight: 700; margin: 0;\">PIMMaid Visualizer</h3>\n                    </div>\n                    <p style=\"color: var(--text-secondary); margin-bottom: var(--space-sm);\">\n                        Export your PIM configuration as beautiful Mermaid diagrams. Visualize relationships between users, groups, and roles.\n                    </p>\n                    <span class=\"badge badge-secondary\"><i class=\"fas fa-sitemap\"></i> Visual Diagrams</span>\n                </div>\n\n                <!-- Group Management -->\n                <div class=\"card\">\n                    <div style=\"display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-sm);\">\n                        <div class=\"stat-icon success\">\n                            <i class=\"fas fa-users\"></i>\n                        </div>\n                        <h3 style=\"font-size: 1.2rem; font-weight: 700; margin: 0;\">Group Management</h3>\n                    </div>\n                    <p style=\"color: var(--text-secondary); margin-bottom: var(--space-sm);\">\n                        Create and manage role-assignable security groups. Add/remove members with an intuitive interface.\n                    </p>\n                    <span class=\"badge badge-success\"><i class=\"fas fa-user-plus\"></i> Member Management</span>\n                </div>\n\n                <!-- Role Explorer -->\n                <div class=\"card\">\n                    <div style=\"display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-sm);\">\n                        <div class=\"stat-icon warning\">\n                            <i class=\"fas fa-user-shield\"></i>\n                        </div>\n                        <h3 style=\"font-size: 1.2rem; font-weight: 700; margin: 0;\">Entra Roles Explorer</h3>\n                    </div>\n                    <p style=\"color: var(--text-secondary); margin-bottom: var(--space-sm);\">\n                        Browse all Azure AD roles with privilege levels. Search, filter, and understand role permissions.\n                    </p>\n                    <span class=\"badge badge-warning\"><i class=\"fas fa-shield-alt\"></i> Privilege Levels</span>\n                </div>\n\n                <!-- Import/Export -->\n                <div class=\"card\">\n                    <div style=\"display: flex; align-items: center; gap: var(--space-md); margin-bottom: var(--space-sm);\">\n                        <div class=\"stat-icon info\">\n                            <i class=\"fas fa-file-export\"></i>\n                        </div>\n                        <h3 style=\"font-size: 1.2rem; font-weight: 700; margin: 0;\">Import/Export</h3>\n                    </div>\n                    <p style=\"color: var(--text-secondary); margin-bottom: var(--space-sm);\">\n                        Export configurations for backup or compliance. Import templates to replicate setups across tenants.\n                    </p>\n                    <span class=\"badge badge-info\"><i class=\"fas fa-download\"></i> Backup & Restore</span>\n                </div>\n            </div>\n\n            <!-- Call to Action -->\n            <div class=\"card\" style=\"background: linear-gradient(135deg, var(--accent-primary-dim), var(--accent-secondary-dim)); border: 2px solid var(--accent-primary); text-align: center; padding: var(--space-xl);\">\n                <h2 style=\"font-size: 2rem; font-weight: 800; margin-bottom: var(--space-md);\">\n                    Ready to Transform Your PIM Management?\n                </h2>\n                <p style=\"font-size: 1.1rem; color: var(--text-secondary); margin-bottom: var(--space-lg); max-width: 600px; margin-left: auto; margin-right: auto;\">\n                    Connect to your Microsoft Entra ID tenant and start managing privileged access with enterprise-grade tools in minutes.\n                </p>\n                <button class=\"btn btn-primary\" onclick=\"document.getElementById('connect-btn').click()\" style=\"font-size: 1.2rem; padding: var(--space-md) var(--space-xl); box-shadow: 0 10px 30px rgba(0, 212, 170, 0.4);\" aria-label=\"Connect to Microsoft Entra ID\">\n                    <i class=\"fas fa-plug\"></i> Connect Now\n                </button>\n            </div>\n\n            <!-- Footer Info -->\n            <div style=\"text-align: center; margin-top: var(--space-xl); padding: var(--space-lg); color: var(--text-muted);\">\n                <p style=\"margin-bottom: var(--space-sm);\">\n                    <i class=\"fas fa-shield-check\" style=\"color: var(--accent-primary);\"></i>\n                    Built with enterprise security in mind\n                </p>\n                <p style=\"font-size: 0.9rem;\">\n                    PIMBuddy v1.0.0 | Powered by Microsoft Graph API | Zero Trust Ready\n                </p>\n            </div>\n        `;\n    }\n\n    /**\n     * Refresh page data\n     */\n    async refreshPage() {\n        this.app.cacheManager.invalidate(CACHE_KEYS.DASHBOARD_STATS.key);\n        await this.app.router.refreshCurrentPage();\n    }\n}\n"],"names":["DashboardPage","BasePage","app","container","params","stats","recentActivities","expiringList","healthWarnings","cached","CACHE_KEYS","groupsResult","assignmentsResult","approvalsResult","healthResult","auditResult","graphService","error","setupMessage","formatDate","dateStr","formatRelativeTime","diff","days","hours","w","activity","idx","assignment"],"mappings":"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"}