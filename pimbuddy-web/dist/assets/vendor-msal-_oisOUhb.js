import{A as N,O as Le,P as h,U as R,c as nt,L as $,a as ne,b as Ke,d as re,e as An,S as Sn,D as En,f as bn,C,g as fe,h as kn,i as Rn,J as _n,j as F,k as L,l as Nn,m as Ee,n as A,o as I,p as rt,q as it,r as ot,s as P,t as Pn,u as Mn,v as se,w as On,x as Un,y as Hn,z as Ln,B as Kn,E as be,F as ue,G as Be,H as xe,I as De,K as Bn,M as It,N as at,Q as Tt,R as ke,T as p,V as xn,W as Dn,X as ee,Y as O,Z as qn,_ as Fn,$ as At,a0 as ge,a1 as zn,a2 as $n,a3 as Gn,a4 as Vn,a5 as st,a6 as D,a7 as St,a8 as Qn,a9 as ct,aa as jn,ab as Et,ac as Jn,ad as lt,ae as ht,af as dt,ag as Wn,ah as bt,ai as b,aj as kt,ak as Re,al as Yn,am as Rt,an as Xn,ao as Zn,ap as er,aq as tr,ar as nr,as as de,at as rr,au as ir}from"./vendor-libs-DR0WLJdd.js";/*! @azure/msal-browser v3.30.0 2025-08-05 */const qe="pkce_not_created",_e="crypto_nonexistent",Ce="empty_navigate_uri",_t="hash_empty_error",Fe="no_state_in_hash",Nt="hash_does_not_contain_known_properties",Pt="unable_to_parse_state",Mt="state_interaction_type_mismatch",Ot="interaction_in_progress",Ut="popup_window_error",Ht="empty_window_error",V="user_cancelled",or="monitor_popup_timeout",Lt="monitor_window_timeout",Kt="redirect_in_iframe",Bt="block_iframe_reload",xt="block_nested_popups",ar="iframe_closed_prematurely",ve="silent_logout_unsupported",Dt="no_account_error",sr="silent_prompt_value_error",qt="no_token_request_cache_error",Ft="unable_to_parse_token_request_cache_error",ze="no_cached_authority_error",cr="auth_request_not_set_error",lr="invalid_cache_type",ye="non_browser_environment",j="database_not_open",pe="no_network_connectivity",zt="post_request_failed",$t="get_request_failed",Ne="failed_to_parse_response",Gt="unable_to_load_token",$e="crypto_key_not_found",Vt="auth_code_required",Qt="auth_code_or_nativeAccountId_required",jt="spa_code_and_nativeAccountId_present",Ge="database_unavailable",Jt="unable_to_acquire_token_from_native_platform",Wt="native_handshake_timeout",Yt="native_extension_not_installed",ie="native_connection_not_established",Xt="uninitialized_public_client_application",Zt="native_prompt_not_supported",en="invalid_base64_string",tn="invalid_pop_token_request",nn="failed_to_build_headers",rn="failed_to_parse_headers";/*! @azure/msal-browser v3.30.0 2025-08-05 */const x="For more visit: aka.ms/msaljs/browser-errors",hr={[qe]:"The PKCE code challenge and verifier could not be generated.",[_e]:"The crypto object or function is not available.",[Ce]:"Navigation URI is empty. Please check stack trace for more info.",[_t]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${x}`,[Fe]:"Hash does not contain state. Please verify that the request originated from msal.",[Nt]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${x}`,[Pt]:"Unable to parse state. Please verify that the request originated from msal.",[Mt]:"Hash contains state but the interaction type does not match the caller.",[Ot]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${x}`,[Ut]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[Ht]:"window.open returned null or undefined window object.",[V]:"User cancelled the flow.",[or]:`Token acquisition in popup failed due to timeout.  ${x}`,[Lt]:`Token acquisition in iframe failed due to timeout.  ${x}`,[Kt]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[Bt]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${x}`,[xt]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[ar]:"The iframe being monitored was closed prematurely.",[ve]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[Dt]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[sr]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[qt]:"No token request found in cache.",[Ft]:"The cached token request could not be parsed.",[ze]:"No cached authority found.",[cr]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[lr]:"Invalid cache type",[ye]:"Login and token requests are not supported in non-browser environments.",[j]:"Database is not open!",[pe]:"No network connectivity. Check your internet connection.",[zt]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[$t]:"Network request failed. Please check the network trace to determine root cause.",[Ne]:"Failed to parse network response. Check network trace.",[Gt]:"Error loading token to cache.",[$e]:"Cryptographic Key or Keypair not found in browser storage.",[Vt]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[Qt]:"An authorization code or nativeAccountId must be provided to this flow.",[jt]:"Request cannot contain both spa code and native account id.",[Ge]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[Jt]:`Unable to acquire token from native platform.  ${x}`,[Wt]:"Timed out while attempting to establish connection to browser extension",[Yt]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[ie]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${x}`,[Xt]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${x}`,[Zt]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[en]:"Invalid base64 encoded string.",[tn]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[nn]:"Failed to build request headers object.",[rn]:"Failed to parse response headers"};class oe extends N{constructor(e,t){super(e,hr[e],t),Object.setPrototypeOf(this,oe.prototype),this.name="BrowserAuthError"}}function d(a,e){return new oe(a,e)}/*! @azure/msal-browser v3.30.0 2025-08-05 */const k={INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},W={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},G={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},S={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},ut={GET:"GET",POST:"POST"},y={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},_={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys",VERSION:"msal.version"},ce={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},w={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var g;(function(a){a.Redirect="redirect",a.Popup="popup",a.Silent="silent",a.None="none"})(g||(g={}));const gt={scopes:Le},on="jwk",Pe="msal.db",dr=1,ur=`${Pe}.keys`,E={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},gr=[E.Default,E.Skip,E.RefreshTokenAndNetwork],pr="msal.browser.log.level",mr="msal.browser.log.pii";/*! @azure/msal-browser v3.30.0 2025-08-05 */function le(a){return encodeURIComponent(Ve(a).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function we(a){return an(a).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Ve(a){return an(new TextEncoder().encode(a))}function an(a){const e=Array.from(a,t=>String.fromCodePoint(t)).join("");return btoa(e)}/*! @azure/msal-browser v3.30.0 2025-08-05 */const fr="RSASSA-PKCS1-v1_5",sn="SHA-256",Cr=2048,vr=new Uint8Array([1,0,1]),pt="0123456789abcdef",mt=new Uint32Array(1),yr="crypto_subtle_undefined",Qe={name:fr,hash:sn,modulusLength:Cr,publicExponent:vr};function wr(a){if(!window)throw d(ye);if(!window.crypto)throw d(_e);if(!a&&!window.crypto.subtle)throw d(_e,yr)}async function cn(a,e,t){e?.addQueueMeasurement(h.Sha256Digest,t);const r=new TextEncoder().encode(a);return window.crypto.subtle.digest(sn,r)}function Ir(a){return window.crypto.getRandomValues(a)}function Ae(){return window.crypto.getRandomValues(mt),mt[0]}function B(){const a=Date.now(),e=Ae()*1024+(Ae()&1023),t=new Uint8Array(16),n=Math.trunc(e/2**30),r=e&2**30-1,i=Ae();t[0]=a/2**40,t[1]=a/2**32,t[2]=a/2**24,t[3]=a/2**16,t[4]=a/2**8,t[5]=a,t[6]=112|n>>>8,t[7]=n,t[8]=128|r>>>24,t[9]=r>>>16,t[10]=r>>>8,t[11]=r,t[12]=i>>>24,t[13]=i>>>16,t[14]=i>>>8,t[15]=i;let o="";for(let s=0;s<t.length;s++)o+=pt.charAt(t[s]>>>4),o+=pt.charAt(t[s]&15),(s===3||s===5||s===7||s===9)&&(o+="-");return o}async function Tr(a,e){return window.crypto.subtle.generateKey(Qe,a,e)}async function Se(a){return window.crypto.subtle.exportKey(on,a)}async function Ar(a,e,t){return window.crypto.subtle.importKey(on,a,Qe,e,t)}async function Sr(a,e){return window.crypto.subtle.sign(Qe,a,e)}async function ln(a){const e=await cn(a),t=new Uint8Array(e);return we(t)}/*! @azure/msal-browser v3.30.0 2025-08-05 */const je="storage_not_supported",Er="stubbed_public_client_application_called",hn="in_mem_redirect_unavailable";/*! @azure/msal-browser v3.30.0 2025-08-05 */const br={[je]:"Given storage configuration option was not supported.",[Er]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[hn]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class Je extends N{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,Je.prototype)}}function We(a){return new Je(a,br[a])}/*! @azure/msal-browser v3.30.0 2025-08-05 */function kr(a){a.location.hash="",typeof a.history.replaceState=="function"&&a.history.replaceState(null,"",`${a.location.origin}${a.location.pathname}${a.location.search}`)}function Rr(a){const e=a.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function Ye(){return window.parent!==window}function _r(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${k.POPUP_NAME_PREFIX}.`)===0}function q(){return typeof window<"u"&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function Nr(){const e=new R(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function Pr(){if(R.hashContainsKnownProperties(window.location.hash)&&Ye())throw d(Bt)}function Mr(a){if(Ye()&&!a)throw d(Kt)}function Or(){if(_r())throw d(xt)}function dn(){if(typeof window>"u")throw d(ye)}function un(a){if(!a)throw d(Xt)}function Xe(a){dn(),Pr(),Or(),un(a)}function ft(a,e){if(Xe(a),Mr(e.system.allowRedirectInIframe),e.cache.cacheLocation===S.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw We(hn)}function gn(a){const e=document.createElement("link");e.rel="preconnect",e.href=new URL(a).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function Ur(){return B()}/*! @azure/msal-browser v3.30.0 2025-08-05 */class me{navigateInternal(e,t){return me.defaultNavigateWindow(e,t)}navigateExternal(e,t){return me.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(n=>{setTimeout(()=>{n(!0)},t.timeout)})}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Hr{async sendGetRequestAsync(e,t){let n,r={},i=0;const o=Ct(t);try{n=await fetch(e,{method:ut.GET,headers:o})}catch{throw d(window.navigator.onLine?$t:pe)}r=vt(n.headers);try{return i=n.status,{headers:r,body:await n.json(),status:i}}catch{throw nt(d(Ne),i,r)}}async sendPostRequestAsync(e,t){const n=t&&t.body||"",r=Ct(t);let i,o=0,s={};try{i=await fetch(e,{method:ut.POST,headers:r,body:n})}catch{throw d(window.navigator.onLine?zt:pe)}s=vt(i.headers);try{return o=i.status,{headers:s,body:await i.json(),status:o}}catch{throw nt(d(Ne),o,s)}}}function Ct(a){try{const e=new Headers;if(!(a&&a.headers))return e;const t=a.headers;return Object.entries(t).forEach(([n,r])=>{e.append(n,r)}),e}catch{throw d(nn)}}function vt(a){try{const e={};return a.forEach((t,n)=>{e[n]=t}),e}catch{throw d(rn)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const Lr=6e4,Me=1e4,Kr=3e4,Br=2e3;function xr({auth:a,cache:e,system:t,telemetry:n},r){const i={clientId:C.EMPTY_STRING,authority:`${C.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:C.EMPTY_STRING,authorityMetadata:C.EMPTY_STRING,redirectUri:typeof window<"u"?q():"",postLogoutRedirectUri:C.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:ne.AAD,OIDCOptions:{serverResponseType:fe.FRAGMENT,defaultScopes:[C.OPENID_SCOPE,C.PROFILE_SCOPE,C.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:Rn.None,tenant:C.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},o={cacheLocation:S.SessionStorage,temporaryCacheLocation:S.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===S.LocalStorage),claimsBasedCachingEnabled:!1},s={loggerCallback:()=>{},logLevel:$.Info,piiLoggingEnabled:!1},l={...{...En,loggerOptions:s,networkClient:r?new Hr:Sn,navigationClient:new me,loadFrameTimeout:0,windowHashTimeout:t?.loadFrameTimeout||Lr,iframeHashTimeout:t?.loadFrameTimeout||Me,navigateFrameWait:0,redirectNavigationTimeout:Kr,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:t?.nativeBrokerHandshakeTimeout||Br,pollIntervalMilliseconds:k.DEFAULT_POLL_INTERVAL_MS},...t,loggerOptions:t?.loggerOptions||s},u={application:{appName:C.EMPTY_STRING,appVersion:C.EMPTY_STRING},client:new kn};if(a?.protocolMode!==ne.OIDC&&a?.OIDCOptions&&new Ke(l.loggerOptions).warning(JSON.stringify(re(An))),a?.protocolMode&&a.protocolMode!==ne.AAD&&l?.allowNativeBroker)throw re(bn);return{auth:{...i,...a,OIDCOptions:{...i.OIDCOptions,...a?.OIDCOptions}},cache:{...o,...e},system:l,telemetry:{...u,...n}}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const Dr="@azure/msal-browser",X="3.30.0";/*! @azure/msal-browser v3.30.0 2025-08-05 */class Ze{static loggerCallback(e,t){switch(e){case $.Error:console.error(t);return;case $.Info:console.info(t);return;case $.Verbose:console.debug(t);return;case $.Warning:console.warn(t);return;default:console.log(t);return}}constructor(e){this.browserEnvironment=typeof window<"u",this.config=xr(e,this.browserEnvironment);let t;try{t=window[S.SessionStorage]}catch{}const n=t?.getItem(pr),r=t?.getItem(mr)?.toLowerCase(),i=r==="true"?!0:r==="false"?!1:void 0,o={...this.config.system.loggerOptions},s=n&&Object.keys($).includes(n)?$[n]:void 0;s&&(o.loggerCallback=Ze.loggerCallback,o.logLevel=s),i!==void 0&&(o.piiLoggingEnabled=i),this.logger=new Ke(o,Dr,X),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Q extends Ze{getModuleName(){return Q.MODULE_NAME}getId(){return Q.ID}async initialize(){return this.available=typeof window<"u",this.available}}Q.MODULE_NAME="";Q.ID="StandardOperatingContext";/*! @azure/msal-browser v3.30.0 2025-08-05 */function K(a){return new TextDecoder().decode(qr(a))}function qr(a){let e=a.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw d(en)}const t=atob(e);return Uint8Array.from(t,n=>n.codePointAt(0)||0)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Fr{constructor(){this.dbName=Pe,this.version=dr,this.tableName=ur,this.dbOpen=!1}async open(){return new Promise((e,t)=>{const n=window.indexedDB.open(this.dbName,this.version);n.addEventListener("upgradeneeded",r=>{r.target.result.createObjectStore(this.tableName)}),n.addEventListener("success",r=>{const i=r;this.db=i.target.result,this.dbOpen=!0,e()}),n.addEventListener("error",()=>t(d(Ge)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(d(j));const o=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);o.addEventListener("success",s=>{const c=s;this.closeConnection(),t(c.target.result)}),o.addEventListener("error",s=>{this.closeConnection(),n(s)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((n,r)=>{if(!this.db)return r(d(j));const s=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);s.addEventListener("success",()=>{this.closeConnection(),n()}),s.addEventListener("error",c=>{this.closeConnection(),r(c)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(d(j));const o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);o.addEventListener("success",()=>{this.closeConnection(),t()}),o.addEventListener("error",s=>{this.closeConnection(),n(s)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(d(j));const i=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();i.addEventListener("success",o=>{const s=o;this.closeConnection(),e(s.target.result)}),i.addEventListener("error",o=>{this.closeConnection(),t(o)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(d(j));const o=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);o.addEventListener("success",s=>{const c=s;this.closeConnection(),t(c.target.result===1)}),o.addEventListener("error",s=>{this.closeConnection(),n(s)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{const n=window.indexedDB.deleteDatabase(Pe),r=setTimeout(()=>t(!1),200);n.addEventListener("success",()=>(clearTimeout(r),e(!0))),n.addEventListener("blocked",()=>(clearTimeout(r),e(!0))),n.addEventListener("error",()=>(clearTimeout(r),t(!1)))})}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Oe{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,t){this.cache.set(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,n)=>{e.push(n)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class zr{constructor(e){this.inMemoryCache=new Oe,this.indexedDBCache=new Fr,this.logger=e}handleDatabaseAccessError(e){if(e instanceof oe&&e.errorCode===Ge)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(n){this.handleDatabaseAccessError(n)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(n){this.handleDatabaseAccessError(n)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(n){this.handleDatabaseAccessError(n)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Z{constructor(e,t,n){this.logger=e,wr(n??!1),this.cache=new zr(this.logger),this.performanceClient=t}createNewGuid(){return B()}base64Encode(e){return Ve(e)}base64Decode(e){return K(e)}base64UrlEncode(e){return le(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){const t=this.performanceClient?.startMeasurement(h.CryptoOptsGetPublicKeyThumbprint,e.correlationId),n=await Tr(Z.EXTRACTABLE,Z.POP_KEY_USAGES),r=await Se(n.publicKey),i={e:r.e,kty:r.kty,n:r.n},o=yt(i),s=await this.hashString(o),c=await Se(n.privateKey),l=await Ar(c,!1,["sign"]);return await this.cache.setItem(s,{privateKey:l,publicKey:n.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),s}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,n,r){const i=this.performanceClient?.startMeasurement(h.CryptoOptsSignJwt,r),o=await this.cache.getItem(t);if(!o)throw d($e);const s=await Se(o.publicKey),c=yt(s),l=le(JSON.stringify({kid:t})),u=_n.getShrHeaderString({...n?.header,alg:s.alg,kid:l}),f=le(u);e.cnf={jwk:JSON.parse(c)};const v=le(JSON.stringify(e)),T=`${f}.${v}`,ae=new TextEncoder().encode(T),Te=await Sr(o.privateKey,ae),In=we(new Uint8Array(Te)),Tn=`${T}.${In}`;return i&&i.end({success:!0}),Tn}async hashString(e){return ln(e)}}Z.POP_KEY_USAGES=["sign","verify"];Z.EXTRACTABLE=!0;function yt(a){return JSON.stringify(a,Object.keys(a).sort())}/*! @azure/msal-browser v3.30.0 2025-08-05 */class $r{constructor(){if(!window.localStorage)throw We(je)}getItem(e){return window.localStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}removeItem(e){window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Gr{constructor(){if(!window.sessionStorage)throw We(je)}getItem(e){return window.sessionStorage.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */function pn(a,e){if(!e)return null;try{return F.parseRequestState(a,e).libraryState.meta}catch{throw L(Nn)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const Vr=24*60*60*1e3;class Qr{getItem(e){const t=`${encodeURIComponent(e)}`,n=document.cookie.split(";");for(let r=0;r<n.length;r++){const i=n[r],[o,...s]=decodeURIComponent(i).trim().split("="),c=s.join("=");if(o===t)return c}return""}setItem(e,t,n,r=!0){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=Lax;`;if(n){const o=jr(n);i+=`expires=${o};`}r&&(i+="Secure;"),document.cookie=i}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(n=>{const r=decodeURIComponent(n).trim().split("=");t.push(r[0])}),t}containsKey(e){return this.getKeys().includes(e)}}function jr(a){const e=new Date;return new Date(e.getTime()+a*Vr).toUTCString()}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Ue extends Ee{constructor(e,t,n,r,i,o){super(e,n,r,i),this.cacheConfig=t,this.logger=r,this.internalStorage=new Oe,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupBrowserStorage(this.cacheConfig.temporaryCacheLocation),this.cookieStorage=new Qr,t.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=o}setupBrowserStorage(e){try{switch(e){case S.LocalStorage:return new $r;case S.SessionStorage:return new Gr;case S.MemoryStorage:default:break}}catch(t){this.logger.error(t)}return this.cacheConfig.cacheLocation=S.MemoryStorage,new Oe}migrateCacheEntries(){const e=this.browserStorage.getItem(_.VERSION);e&&this.logger.info(`MSAL.js was last initialized with version ${e}`),e!==X&&this.browserStorage.setItem(_.VERSION,X);const t=`${C.CACHE_PREFIX}.${A.ID_TOKEN}`,n=`${C.CACHE_PREFIX}.${A.CLIENT_INFO}`,r=`${C.CACHE_PREFIX}.${A.ERROR}`,i=`${C.CACHE_PREFIX}.${A.ERROR_DESC}`,o=this.browserStorage.getItem(t),s=this.browserStorage.getItem(n),c=this.browserStorage.getItem(r),l=this.browserStorage.getItem(i),u=[o,s,c,l];[A.ID_TOKEN,A.CLIENT_INFO,A.ERROR,A.ERROR_DESC].forEach((v,T)=>{const z=u[T];z&&this.setTemporaryCache(v,z,!0)})}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const e=this.cryptoImpl.createNewGuid(),t=this.getItem(_.ACCOUNT_KEYS),n=this.getItem(`${_.TOKEN_KEYS}.${this.clientId}`);if(t&&n){this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");return}this.browserStorage.getKeys().forEach(i=>{if(this.isCredentialKey(i)){const o=this.getItem(i);if(o){const s=this.validateAndParseJson(o);if(s&&s.hasOwnProperty("credentialType"))switch(s.credentialType){case I.ID_TOKEN:if(ot(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${i} found, saving key to token key map`);const c=s,l=this.updateCredentialCacheKey(i,c,e);this.addTokenKey(l,I.ID_TOKEN,e);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${i}`);break;case I.ACCESS_TOKEN:case I.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(it(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${i} found, saving key to token key map`);const c=s,l=this.updateCredentialCacheKey(i,c,e);this.addTokenKey(l,I.ACCESS_TOKEN,e);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${i}`);break;case I.REFRESH_TOKEN:if(rt(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${i} found, saving key to token key map`);const c=s,l=this.updateCredentialCacheKey(i,c,e);this.addTokenKey(l,I.REFRESH_TOKEN,e);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${i}`);break}}}if(this.isAccountKey(i)){const o=this.getItem(i);if(o){const s=this.validateAndParseJson(o);s&&P.isAccountEntity(s)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${i} found, saving key to account key map`),this.addAccountKeyToMap(i,e))}}})}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&typeof t=="object"?t:null}catch{return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,t,n){let r=[];for(let o=0;o<=20;o++)try{this.browserStorage.setItem(e,t),o>0&&this.removeAccessTokenKeys(r.slice(0,o),n);break}catch(s){const c=Pn(s);if(c.errorCode===Mn&&o<20){if(r.length||(e===`${_.TOKEN_KEYS}.${this.clientId}`?r=JSON.parse(t).accessToken:r=this.getTokenKeys().accessToken),r.length<=o)throw c;this.removeAccessToken(r[o],n,!1)}else throw c}}getAccount(e,t,n){this.logger.trace("BrowserCacheManager.getAccount called");const r=this.getCachedAccountEntity(e,t);return this.updateOutdatedCachedAccount(e,r,t,n)}getCachedAccountEntity(e,t){const n=this.getItem(e);if(!n)return this.removeAccountKeyFromMap(e,t),null;const r=this.validateAndParseJson(n);return!r||!P.isAccountEntity(r)?null:Ee.toObject(new P,r)}setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const n=e.generateAccountKey();e.lastUpdatedAt=Date.now().toString(),this.setItem(n,JSON.stringify(e),t),this.addAccountKeyToMap(n,t)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const e=this.getItem(_.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e,t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const n=this.getAccountKeys();n.indexOf(e)===-1?(n.push(e),this.setItem(_.ACCOUNT_KEYS,JSON.stringify(n),t),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e,t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const n=this.getAccountKeys(),r=n.indexOf(e);if(r>-1){if(n.splice(r,1),n.length===0){this.removeItem(_.ACCOUNT_KEYS);return}else this.setItem(_.ACCOUNT_KEYS,JSON.stringify(n),t);this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")}else this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e,t){super.removeAccount(e,t),this.removeAccountKeyFromMap(e,t)}removeOutdatedAccount(e,t){this.removeItem(e),this.removeAccountKeyFromMap(e,t)}removeIdToken(e,t){super.removeIdToken(e,t),this.removeTokenKey(e,I.ID_TOKEN,t)}removeAccessToken(e,t,n=!0){super.removeAccessToken(e,t),this.performanceClient?.incrementFields({accessTokensRemoved:1},t),n&&this.removeTokenKey(e,I.ACCESS_TOKEN,t)}removeAccessTokenKeys(e,t){this.logger.trace("removeAccessTokenKey called");const n=this.getTokenKeys();let r=0;if(e.forEach(i=>{const o=n.accessToken.indexOf(i);o>-1&&(n.accessToken.splice(o,1),r++)}),r>0){this.logger.info(`removed ${r} accessToken keys from tokenKeys map`),this.setTokenKeys(n,t);return}}removeRefreshToken(e,t){super.removeRefreshToken(e,t),this.removeTokenKey(e,I.REFRESH_TOKEN,t)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const e=this.getItem(`${_.TOKEN_KEYS}.${this.clientId}`);if(e){const t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}setTokenKeys(e,t){if(e.idToken.length===0&&e.accessToken.length===0&&e.refreshToken.length===0){this.removeItem(`${_.TOKEN_KEYS}.${this.clientId}`);return}else this.setItem(`${_.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(e),t)}addTokenKey(e,t,n){this.logger.trace("BrowserCacheManager addTokenKey called");const r=this.getTokenKeys();switch(t){case I.ID_TOKEN:r.idToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case I.ACCESS_TOKEN:const i=r.accessToken.indexOf(e);i!==-1&&r.accessToken.splice(i,1),this.logger.trace(`access token ${i===-1?"added to":"updated in"} map`),r.accessToken.push(e);break;case I.REFRESH_TOKEN:r.refreshToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),L(at)}this.setTokenKeys(r,n)}removeTokenKey(e,t,n,r=this.getTokenKeys()){switch(this.logger.trace("BrowserCacheManager removeTokenKey called"),t){case I.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const i=r.idToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case I.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const o=r.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case I.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const s=r.refreshToken.indexOf(e);s>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(s,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),L(at)}this.setTokenKeys(r,n)}getIdTokenCredential(e,t){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,t),null;const r=this.validateAndParseJson(n);return!r||!ot(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r)}setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const n=se(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(n,JSON.stringify(e),t),this.addTokenKey(n,I.ID_TOKEN,t)}getAccessTokenCredential(e,t){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,I.ACCESS_TOKEN,t),null;const r=this.validateAndParseJson(n);return!r||!it(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r)}setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const n=se(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(n,JSON.stringify(e),t),this.addTokenKey(n,I.ACCESS_TOKEN,t)}getRefreshTokenCredential(e,t){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,I.REFRESH_TOKEN,t),null;const r=this.validateAndParseJson(n);return!r||!rt(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r)}setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const n=se(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(n,JSON.stringify(e),t),this.addTokenKey(n,I.REFRESH_TOKEN,t)}getAppMetadata(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return!n||!On(e,n)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),n)}setAppMetadata(e,t){this.logger.trace("BrowserCacheManager.setAppMetadata called");const n=Un(e);this.setItem(n,JSON.stringify(e),t)}getServerTelemetry(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const n=this.validateAndParseJson(t);return!n||!Hn(e,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),n)}setServerTelemetry(e,t,n){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t),n)}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&Ln(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),n):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(t=>this.isAuthorityMetadata(t))}setWrapperMetadata(e,t){this.internalStorage.setItem(ce.WRAPPER_SKU,e),this.internalStorage.setItem(ce.WRAPPER_VER,t)}getWrapperMetadata(){const e=this.internalStorage.getItem(ce.WRAPPER_SKU)||C.EMPTY_STRING,t=this.internalStorage.getItem(ce.WRAPPER_VER)||C.EMPTY_STRING;return[e,t]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(e){const t=this.generateCacheKey(A.ACTIVE_ACCOUNT_FILTERS),n=this.getItem(t);if(!n){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const i=this.generateCacheKey(A.ACTIVE_ACCOUNT),o=this.getItem(i);if(!o)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const s=this.getAccountInfoFilteredBy({localAccountId:o},e);return s?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(s,e),s):null}const r=this.validateAndParseJson(n);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,t){const n=this.generateCacheKey(A.ACTIVE_ACCOUNT_FILTERS),r=this.generateCacheKey(A.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");const i={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:Date.now().toString()};this.setItem(n,JSON.stringify(i),t),this.setItem(r,e.localAccountId,t)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(n),this.browserStorage.removeItem(r)}getThrottlingCache(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const n=this.validateAndParseJson(t);return!n||!Kn(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),n)}setThrottlingCache(e,t,n){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t),n)}getTemporaryCache(e,t){const n=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const i=this.cookieStorage.getItem(n);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),i}const r=this.temporaryCacheStorage.getItem(n);if(!r){if(this.cacheConfig.cacheLocation===S.LocalStorage){const i=this.browserStorage.getItem(n);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),r}setTemporaryCache(e,t,n){const r=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(r,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(r,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(e){await this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(t=>{(t.indexOf(C.CACHE_PREFIX)!==-1||t.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(t)}),this.browserStorage.getKeys().forEach(t=>{(t.indexOf(C.CACHE_PREFIX)!==-1||t.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(t)}),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(h.ClearTokensAndKeysWithClaims,t);const n=this.getTokenKeys();let r=0;n.accessToken.forEach(i=>{const o=this.getAccessTokenCredential(i,t);o?.requestedClaimsHash&&i.includes(o.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(i,t),r++)}),r>0&&this.logger.warning(`${r} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):be.startsWith(e,C.CACHE_PREFIX)||be.startsWith(e,A.ADAL_ID_TOKEN)?e:`${C.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){const{libraryState:{id:t}}=F.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${y.AUTHORITY}.${t}`)}generateNonceKey(e){const{libraryState:{id:t}}=F.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${y.NONCE_IDTOKEN}.${t}`)}generateStateKey(e){const{libraryState:{id:t}}=F.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${y.REQUEST_STATE}.${t}`)}getCachedAuthority(e){const t=this.generateStateKey(e),n=this.getTemporaryCache(t);if(!n)return null;const r=this.generateAuthorityKey(n);return this.getTemporaryCache(r)}updateCacheEntries(e,t,n,r,i){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const o=this.generateStateKey(e);this.setTemporaryCache(o,e,!1);const s=this.generateNonceKey(e);this.setTemporaryCache(s,t,!1);const c=this.generateAuthorityKey(e);if(this.setTemporaryCache(c,n,!1),i){const l={credential:i.homeAccountId,type:ue.HOME_ACCOUNT_ID};this.setTemporaryCache(y.CCS_CREDENTIAL,JSON.stringify(l),!0)}else if(r){const l={credential:r,type:ue.UPN};this.setTemporaryCache(y.CCS_CREDENTIAL,JSON.stringify(l),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(t=>{t.indexOf(e)!==-1&&this.removeTemporaryItem(t)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(y.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(y.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(y.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(y.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(y.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(y.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const t=this.generateStateKey(e),n=this.temporaryCacheStorage.getItem(t);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n||C.EMPTY_STRING)}}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(t=>{if(t.indexOf(y.REQUEST_STATE)===-1)return;const n=this.temporaryCacheStorage.getItem(t);if(!n)return;const r=pn(this.cryptoImpl,n);r&&r.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n))}),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const t=Ve(JSON.stringify(e));this.setTemporaryCache(y.REQUEST_PARAMS,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const t=this.getTemporaryCache(y.REQUEST_PARAMS,!0);if(!t)throw d(qt);let n;try{n=JSON.parse(K(t))}catch(r){throw this.logger.errorPii(`Attempted to parse: ${t}`),this.logger.error(`Parsing cached token request threw with error: ${r}`),d(Ft)}if(this.removeTemporaryItem(this.generateCacheKey(y.REQUEST_PARAMS)),!n.authority){const r=this.generateAuthorityKey(e),i=this.getTemporaryCache(r);if(!i)throw d(ze);n.authority=i}return n}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(y.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${C.CACHE_PREFIX}.${y.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const t=`${C.CACHE_PREFIX}.${y.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw d(Ot);this.setTemporaryCache(t,this.clientId,!1)}else!e&&this.getInteractionInProgress()===this.clientId&&this.removeTemporaryItem(t)}getLegacyLoginHint(){const e=this.getTemporaryCache(A.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(A.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));const t=this.getTemporaryCache(A.ID_TOKEN,!0);t&&(this.browserStorage.removeItem(this.generateCacheKey(A.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const n=t||e;if(n){const r=Be(n,K);if(r.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),r.preferred_username;if(r.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),r.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,t,n){const r=se(t);if(e!==r){const i=this.getItem(e);if(i)return this.browserStorage.removeItem(e),this.setItem(r,i,n),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),r;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}async hydrateCache(e,t){const n=xe(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);let r;t.claims&&(r=await this.cryptoImpl.hashString(t.claims));const i=De(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,K,void 0,e.tokenType,void 0,t.sshKid,t.claims,r),o={idToken:n,accessToken:i};return this.saveCacheRecord(o,e.correlationId)}async saveCacheRecord(e,t,n){try{await super.saveCacheRecord(e,t,n)}catch(r){if(r instanceof Bn&&this.performanceClient&&t)try{const i=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:i.refreshToken.length,cacheIdCount:i.idToken.length,cacheAtCount:i.accessToken.length},t)}catch{}throw r}}}const Jr=(a,e)=>{const t={cacheLocation:S.MemoryStorage,temporaryCacheLocation:S.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new Ue(a,t,It,e)};/*! @azure/msal-browser v3.30.0 2025-08-05 */function Wr(a,e,t,n,r){return a.verbose("getAllAccounts called"),t?e.getAllAccounts(n,r):[]}function Yr(a,e,t,n){if(e.trace("getAccount called"),Object.keys(a).length===0)return e.warning("getAccount: No accountFilter provided"),null;const r=t.getAccountInfoFilteredBy(a,n);return r?(e.verbose("getAccount: Account matching provided filter found, returning"),r):(e.verbose("getAccount: No matching account found, returning null"),null)}function Xr(a,e,t,n){if(e.trace("getAccountByUsername called"),!a)return e.warning("getAccountByUsername: No username provided"),null;const r=t.getAccountInfoFilteredBy({username:a},n);return r?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${a}`),r):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function Zr(a,e,t,n){if(e.trace("getAccountByHomeId called"),!a)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;const r=t.getAccountInfoFilteredBy({homeAccountId:a},n);return r?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${a}`),r):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function ei(a,e,t,n){if(e.trace("getAccountByLocalId called"),!a)return e.warning("getAccountByLocalId: No localAccountId provided"),null;const r=t.getAccountInfoFilteredBy({localAccountId:a},n);return r?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${a}`),r):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function ti(a,e,t){e.setActiveAccount(a,t)}function ni(a,e){return a.getActiveAccount(e)}/*! @azure/msal-browser v3.30.0 2025-08-05 */const m={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};/*! @azure/msal-browser v3.30.0 2025-08-05 */class ri{constructor(e){this.eventCallbacks=new Map,this.logger=e||new Ke({})}addEventCallback(e,t,n){if(typeof window<"u"){const r=n||Ur();return this.eventCallbacks.has(r)?(this.logger.error(`Event callback with id: ${r} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(r,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${r}`),r)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,n,r){if(typeof window<"u"){const i={eventType:e,interactionType:t||null,payload:n||null,error:r||null,timestamp:Date.now()};this.eventCallbacks.forEach(([o,s],c)=>{(s.length===0||s.includes(e))&&(this.logger.verbose(`Emitting event to callback ${c}: ${e}`),o.apply(null,[i]))})}}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class mn{constructor(e,t,n,r,i,o,s,c,l){this.config=e,this.browserStorage=t,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=o,this.nativeMessageHandler=c,this.correlationId=l||B(),this.logger=r.clone(k.MSAL_SKU,X,this.correlationId),this.performanceClient=s}async clearCacheOnLogout(e){if(e){P.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(this.correlationId),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null,this.correlationId));try{await this.browserStorage.removeAccount(P.generateAccountCacheKey(e),this.correlationId),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(this.correlationId),await this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return R.getAbsoluteUrl(t,q())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Tt(n,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,n=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(h.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const r={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e.requestAuthority||this.config.auth.authority,o=n?.length?n==="true":this.config.auth.instanceAware,s=t&&o?this.config.auth.authority.replace(R.getDomainFromUrl(i),t.environment):i,c=ke.generateAuthority(s,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),l=await p(xn,h.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(c,this.config.system.networkClient,this.browserStorage,r,this.logger,this.correlationId,this.performanceClient);if(t&&!l.isAlias(t.environment))throw re(Dn);return l}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const ii=32;async function oi(a,e,t){a.addQueueMeasurement(h.GeneratePkceCodes,t);const n=ee(ai,h.GenerateCodeVerifier,e,a,t)(a,e,t),r=await p(si,h.GenerateCodeChallengeFromVerifier,e,a,t)(n,a,e,t);return{verifier:n,challenge:r}}function ai(a,e,t){try{const n=new Uint8Array(ii);return ee(Ir,h.GetRandomValues,e,a,t)(n),we(n)}catch{throw d(qe)}}async function si(a,e,t,n){e.addQueueMeasurement(h.GenerateCodeChallengeFromVerifier,n);try{const r=await p(cn,h.Sha256Digest,t,e,n)(a,e,n);return we(new Uint8Array(r))}catch{throw d(qe)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */async function et(a,e,t,n){t.addQueueMeasurement(h.InitializeBaseRequest,a.correlationId);const r=a.authority||e.auth.authority,i=[...a&&a.scopes||[]],o={...a,correlationId:a.correlationId,authority:r,scopes:i};if(!o.authenticationScheme)o.authenticationScheme=O.BEARER,n.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(o.authenticationScheme===O.SSH){if(!a.sshJwk)throw re(qn);if(!a.sshKid)throw re(Fn)}n.verbose(`Authentication Scheme set to "${o.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&a.claims&&!be.isEmptyObj(a.claims)&&(o.requestedClaimsHash=await ln(a.claims)),o}async function ci(a,e,t,n,r){n.addQueueMeasurement(h.InitializeSilentRequest,a.correlationId);const i=await p(et,h.InitializeBaseRequest,r,n,a.correlationId)(a,t,n,r);return{...a,...i,account:e,forceRefresh:a.forceRefresh||!1}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class te extends mn{async initializeAuthorizationCodeRequest(e){this.performanceClient.addQueueMeasurement(h.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);const t=await p(oi,h.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),n={...e,redirectUri:e.redirectUri,code:C.EMPTY_STRING,codeVerifier:t.verifier};return e.codeChallenge=t.challenge,e.codeChallengeMethod=C.S256_CODE_CHALLENGE_METHOD,n}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const t={correlationId:this.correlationId||B(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const n=this.getLogoutHintFromIdTokenClaims(e.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=R.getAbsoluteUrl(e.postLogoutRedirectUri,q())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=R.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,q())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=R.getAbsoluteUrl(q(),q())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(h.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const t=await p(this.getClientConfiguration.bind(this),h.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e);return new At(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:n,requestAzureCloudOptions:r,requestExtraQueryParameters:i,account:o}=e;this.performanceClient.addQueueMeasurement(h.StandardInteractionClientGetClientConfiguration,this.correlationId);const s=await p(this.getDiscoveredAuthority.bind(this),h.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:n,requestAzureCloudOptions:r,requestExtraQueryParameters:i,account:o}),c=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:s,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:c.loggerCallback,piiLoggingEnabled:c.piiLoggingEnabled,logLevel:c.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:k.MSAL_SKU,version:X,cpu:C.EMPTY_STRING,os:C.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(h.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const n=this.getRedirectUri(e.redirectUri),r={interactionType:t},i=F.setRequestState(this.browserCrypto,e&&e.state||C.EMPTY_STRING,r),s={...await p(et,h.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:n,state:i,nonce:e.nonce||B(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return s;const c=e.account||this.browserStorage.getActiveAccount(this.correlationId);if(c&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${c.homeAccountId}`,this.correlationId),s.account=c),!s.loginHint&&!c){const l=this.browserStorage.getLegacyLoginHint();l&&(s.loginHint=l)}return s}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const li="ContentError",fn="user_switch";/*! @azure/msal-browser v3.30.0 2025-08-05 */const hi="USER_INTERACTION_REQUIRED",di="USER_CANCEL",ui="NO_NETWORK",gi="PERSISTENT_ERROR",pi="DISABLED",mi="ACCOUNT_UNAVAILABLE";/*! @azure/msal-browser v3.30.0 2025-08-05 */const fi=-2147186943,Ci={[fn]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class U extends N{constructor(e,t,n){super(e,t),Object.setPrototypeOf(this,U.prototype),this.name="NativeAuthError",this.ext=n}}function J(a){if(a.ext&&a.ext.status&&(a.ext.status===gi||a.ext.status===pi)||a.ext&&a.ext.error&&a.ext.error===fi)return!0;switch(a.errorCode){case li:return!0;default:return!1}}function He(a,e,t){if(t&&t.status)switch(t.status){case mi:return zn($n);case hi:return new ge(a,e);case di:return d(V);case ui:return d(pe)}return new U(a,Ci[a]||e,t)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Cn extends te{async acquireToken(e){this.performanceClient.addQueueMeasurement(h.SilentCacheClientAcquireToken,e.correlationId);const t=this.initializeServerTelemetryManager(w.acquireTokenSilent_silentFlow),n=await p(this.getClientConfiguration.bind(this),h.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),r=new Gn(n,this.performanceClient);this.logger.verbose("Silent auth client created");try{const o=(await p(r.acquireCachedToken.bind(r),h.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),o}catch(i){throw i instanceof oe&&i.errorCode===$e&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),i}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t?.account)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Y extends mn{constructor(e,t,n,r,i,o,s,c,l,u,f,v){super(e,t,n,r,i,o,c,l,v),this.apiId=s,this.accountId=u,this.nativeMessageHandler=l,this.nativeStorageManager=f,this.silentCacheClient=new Cn(e,this.nativeStorageManager,n,r,i,o,c,l,v),this.serverTelemetryManager=this.initializeServerTelemetryManager(this.apiId);const T=this.nativeMessageHandler.getExtensionId()===W.PREFERRED_EXTENSION_ID?"chrome":this.nativeMessageHandler.getExtensionId()?.length?"unknown":void 0;this.skus=Tt.makeExtraSkuString({libraryName:k.MSAL_SKU,libraryVersion:X,extensionName:T,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[Vn]:this.skus}}async acquireToken(e){this.performanceClient.addQueueMeasurement(h.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const t=this.performanceClient.startMeasurement(h.NativeInteractionClientAcquireToken,e.correlationId),n=st();try{const r=await this.initializeNativeRequest(e);try{const l=await this.acquireTokensFromCache(this.accountId,r);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),l}catch{this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...i}=r,o={method:G.GetToken,request:i},s=await this.nativeMessageHandler.sendMessage(o),c=this.validateNativeResponse(s);return await this.handleNativeResponse(c,r,n).then(l=>(t.end({success:!0,isNativeBroker:!0,requestId:l.requestId}),this.serverTelemetryManager.clearNativeBrokerErrorCode(),l)).catch(l=>{throw t.end({success:!1,errorCode:l.errorCode,subErrorCode:l.subError,isNativeBroker:!0}),l})}catch(r){throw r instanceof U&&this.serverTelemetryManager.setNativeBrokerErrorCode(r.errorCode),r}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:D.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),L(dt);const n=this.browserStorage.getBaseAccountInfo({nativeAccountId:e},t.correlationId);if(!n)throw L(dt);try{const r=this.createSilentCacheRequest(t,n),i=await this.silentCacheClient.acquireToken(r),o={...n,idTokenClaims:i?.idTokenClaims,idToken:i?.idToken};return{...i,account:o}}catch(r){throw r}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...n}=e;delete n.onRedirectNavigate;const r=await this.initializeNativeRequest(n),i={method:G.GetToken,request:r};try{const c=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(c)}catch(c){if(c instanceof U&&(this.serverTelemetryManager.setNativeBrokerErrorCode(c.errorCode),J(c)))throw c}this.browserStorage.setTemporaryCache(y.NATIVE_REQUEST,JSON.stringify(r),!0);const o={apiId:w.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},s=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(s,o)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const n=this.browserStorage.getCachedNativeRequest();if(!n)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;const{prompt:r,...i}=n;r&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(y.NATIVE_REQUEST));const o={method:G.GetToken,request:i},s=st();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const c=await this.nativeMessageHandler.sendMessage(o);this.validateNativeResponse(c);const l=this.handleNativeResponse(c,i,s);this.browserStorage.setInteractionInProgress(!1);const u=await l;return this.serverTelemetryManager.clearNativeBrokerErrorCode(),u}catch(c){throw this.browserStorage.setInteractionInProgress(!1),c}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,n){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const r=Be(e.id_token,K),i=this.createHomeAccountIdentifier(e,r),o=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId},this.correlationId)?.homeAccountId;if(i!==o&&e.account.id!==t.accountId)throw He(fn);const s=await this.getDiscoveredAuthority({requestAuthority:t.authority}),c=St(this.browserStorage,s,i,K,this.correlationId,r,e.client_info,void 0,r.tid,void 0,e.account.id,this.logger),l=await this.generateAuthenticationResult(e,t,r,c,s.canonicalAuthority,n);return this.cacheAccount(c),this.cacheNativeTokens(e,t,i,r,e.access_token,l.tenantId,n),l}createHomeAccountIdentifier(e,t){return P.generateHomeAccountId(e.client_info||C.EMPTY_STRING,Qn.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?D.fromString(e.scope):D.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===O.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const n=new ct(this.browserCrypto),r={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw L(Wn);return n.signPopToken(e.access_token,t.keyId,r)}else return e.access_token}async generateAuthenticationResult(e,t,n,r,i,o){const s=this.addTelemetryFromNativeResponse(e),c=e.scope?D.fromString(e.scope):D.fromString(t.scope),l=e.account.properties||{},u=l.UID||n.oid||n.sub||C.EMPTY_STRING,f=l.TenantId||n.tid||C.EMPTY_STRING,v=jn(r.getAccountInfo(),void 0,n,e.id_token);v.nativeAccountId!==e.account.id&&(v.nativeAccountId=e.account.id);const T=await this.generatePopAccessToken(e,t),z=t.tokenType===O.POP?O.POP:O.BEARER;return{authority:i,uniqueId:u,tenantId:f,scopes:c.asArray(),account:v,idToken:e.id_token,idTokenClaims:n,accessToken:T,fromCache:s?this.isResponseFromCache(s):!1,expiresOn:new Date(Number(o+e.expires_in)*1e3),tokenType:z,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}cacheAccount(e){this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e,this.correlationId).catch(t=>{this.logger.error(`Error occurred while removing account context from browser storage. ${t}`)})}cacheNativeTokens(e,t,n,r,i,o,s){const c=xe(n,t.authority,e.id_token||"",t.clientId,r.tid||""),l=t.tokenType===O.POP?C.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,u=s+l,f=this.generateScopes(e,t),v=De(n,t.authority,i,t.clientId,r.tid||o,f.printScopes(),u,0,K,void 0,t.tokenType,void 0,t.keyId),T={idToken:c,accessToken:v};this.nativeStorageManager.saveCacheRecord(T,t.correlationId,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw Et(bt,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const n=new R(t);n.validateAsUri();const{scopes:r,...i}=e,o=new D(r||[]);o.appendScopes(Le);const s=()=>{switch(this.apiId){case w.ssoSilent:case w.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),b.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case b.NONE:case b.CONSENT:case b.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),d(Zt)}},c={...i,accountId:this.accountId,clientId:this.config.auth.clientId,authority:n.urlString,scope:o.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:s(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(c.signPopToken&&e.popKid)throw d(tn);if(this.handleExtraBrokerParams(c),c.extraParameters=c.extraParameters||{},c.extraParameters.telemetry=W.MATS_TELEMETRY,e.authenticationScheme===O.POP){const l={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},u=new ct(this.browserCrypto);let f;if(c.keyId)f=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:c.keyId})),c.signPopToken=!1;else{const v=await p(u.generateCnf.bind(u),h.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(l,this.logger);f=v.reqCnfString,c.keyId=v.kid,c.signPopToken=!0}c.reqCnf=f}return this.addRequestSKUs(c),c}handleExtraBrokerParams(e){const t=e.extraParameters&&e.extraParameters.hasOwnProperty(Jn)&&e.extraParameters.hasOwnProperty(lt)&&e.extraParameters.hasOwnProperty(ht);if(!e.embeddedClientId&&!t)return;let n="";const r=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,n=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[lt],n=e.extraParameters[ht]),e.extraParameters={child_client_id:n,child_redirect_uri:r},this.performanceClient?.addFields({embeddedClientId:n,embeddedRedirectUri:r},e.correlationId)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class H{constructor(e,t,n,r){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=r,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=n,this.handshakeEvent=n.startMeasurement(h.NativeMessageHandlerHandshake)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:W.CHANNEL_ID,extensionId:this.extensionId,responseId:B(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise((n,r)=>{this.resolvers.set(t.responseId,{resolve:n,reject:r})})}static async createProvider(e,t,n){e.trace("NativeMessageHandler - createProvider called.");try{const r=new H(e,t,n,W.PREFERRED_EXTENSION_ID);return await r.sendHandshakeRequest(),r}catch{const i=new H(e,t,n);return await i.sendHandshakeRequest(),i}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:W.CHANNEL_ID,extensionId:this.extensionId,responseId:B(),body:{method:G.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=t=>{this.onChannelMessage(t)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,n)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:n}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),n(d(Wt)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(!(!t.channel||t.channel!==W.CHANNEL_ID)&&!(t.extensionId&&t.extensionId!==this.extensionId)&&t.body.method===G.HandshakeRequest){const n=this.handshakeResolvers.get(t.responseId);if(!n){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);return}this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),n.reject(d(Yt))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,n=this.resolvers.get(t.responseId),r=this.handshakeResolvers.get(t.responseId);try{const i=t.body.method;if(i===G.Response){if(!n)return;const o=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(o)}`),o.status!=="Success")n.reject(He(o.code,o.description,o.ext));else if(o.result)o.result.code&&o.result.description?n.reject(He(o.result.code,o.result.description,o.result.ext)):n.resolve(o.result);else throw Et(bt,"Event does not contain result.");this.resolvers.delete(t.responseId)}else if(i===G.HandshakeResponse){if(!r){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),r.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(i){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${i}`),this.logger.errorPii(`Unable to parse ${e}`),n?n.reject(i):r&&r.reject(i)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,t,n,r){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!n)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(r)switch(r){case O.BEARER:case O.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class tt{constructor(e,t,n,r,i){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=r,this.performanceClient=i}async handleCodeResponse(e,t){this.performanceClient.addQueueMeasurement(h.HandleCodeResponse,t.correlationId);let n;try{n=this.authModule.handleFragmentResponse(e,t.state)}catch(r){throw r instanceof kt&&r.subError===V?d(V):r}return p(this.handleCodeResponseFromServer.bind(this),h.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(n,t)}async handleCodeResponseFromServer(e,t,n=!0){if(this.performanceClient.addQueueMeasurement(h.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await p(this.authModule.updateAuthority.bind(this.authModule),h.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),n&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const i=this.createCcsCredentials(t);i&&(this.authCodeRequest.ccsCredential=i)}return await p(this.authModule.acquireToken.bind(this.authModule),h.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:ue.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:ue.UPN}:null}}/*! @azure/msal-browser v3.30.0 2025-08-05 */function vn(a,e,t){const n=Re(a);if(!n)throw Yn(a)?(t.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),t.errorPii(`The ${e} detected is: ${a}`),d(Nt)):(t.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),d(_t));return n}function vi(a,e,t){if(!a.state)throw d(Fe);const n=pn(e,a.state);if(!n)throw d(Pt);if(n.interactionType!==t)throw d(Mt)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class yi extends te{constructor(e,t,n,r,i,o,s,c,l,u){super(e,t,n,r,i,o,s,l,u),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=c}acquireToken(e){try{const n={popupName:this.generatePopupName(e.scopes||Le,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,n)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),n.popup=this.openSizedPopup("about:blank",n),this.acquireTokenPopupAsync(e,n))}catch(t){return Promise.reject(t)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),n={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},r=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,n,r,i)):(this.logger.verbose("asyncPopup set to false, opening popup"),n.popup=this.openSizedPopup("about:blank",n),this.logoutPopupAsync(t,n,r,i))}catch(t){return Promise.reject(t)}}async acquireTokenPopupAsync(e,t){this.logger.verbose("acquireTokenPopupAsync called");const n=this.initializeServerTelemetryManager(w.acquireTokenPopup),r=await p(this.initializeAuthorizationRequest.bind(this),h.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,g.Popup);gn(r.authority);try{const i=await p(this.initializeAuthorizationCodeRequest.bind(this),h.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(r),o=await p(this.createAuthCodeClient.bind(this),h.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),s=H.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let c;s&&(c=this.performanceClient.startMeasurement(h.FetchAccountIdWithNativeBroker,e.correlationId));const l=await o.getAuthCodeUrl({...r,nativeBroker:s}),u=new tt(o,this.browserStorage,i,this.logger,this.performanceClient),f=this.initiateAuthRequest(l,t);this.eventHandler.emitEvent(m.POPUP_OPENED,g.Popup,{popupWindow:f},null);const v=await this.monitorPopupForHash(f,t.popupWindowParent),T=ee(vn,h.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(v,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(Rt.removeThrottle(this.browserStorage,this.config.auth.clientId,i),T.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),c&&c.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw d(ie);const ae=new Y(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,w.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,T.accountId,this.nativeStorage,r.correlationId),{userRequestState:Te}=F.parseRequestState(this.browserCrypto,r.state);return await ae.acquireToken({...r,state:Te,prompt:void 0})}return await u.handleCodeResponse(T,r)}catch(i){throw t.popup?.close(),i instanceof N&&(i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i)),i}}async logoutPopupAsync(e,t,n,r){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(m.LOGOUT_START,g.Popup,e);const i=this.initializeServerTelemetryManager(w.logoutPopup);try{await this.clearCacheOnLogout(e.account);const o=await p(this.createAuthCodeClient.bind(this),h.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:n,account:e.account||void 0});try{o.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&o.authority.protocolMode===ne.OIDC){if(this.browserStorage.removeAccount(e.account?.homeAccountId,this.correlationId),this.eventHandler.emitEvent(m.LOGOUT_SUCCESS,g.Popup,e),r){const l={apiId:w.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},u=R.getAbsoluteUrl(r,q());await this.navigationClient.navigateInternal(u,l)}t.popup?.close();return}}const s=o.getLogoutUri(e);this.eventHandler.emitEvent(m.LOGOUT_SUCCESS,g.Popup,e);const c=this.openPopup(s,t);if(this.eventHandler.emitEvent(m.POPUP_OPENED,g.Popup,{popupWindow:c},null),await this.monitorPopupForHash(c,t.popupWindowParent).catch(()=>{}),r){const l={apiId:w.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},u=R.getAbsoluteUrl(r,q());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${u}`),await this.navigationClient.navigateInternal(u,l)}else this.logger.verbose("No main window navigation requested")}catch(o){throw t.popup?.close(),o instanceof N&&(o.setCorrelationId(this.correlationId),i.cacheFailedRequest(o)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(m.LOGOUT_FAILURE,g.Popup,null,o),this.eventHandler.emitEvent(m.LOGOUT_END,g.Popup),o}this.eventHandler.emitEvent(m.LOGOUT_END,g.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),d(Ce)}monitorPopupForHash(e,t){return new Promise((n,r)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const i=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(i),r(d(V));return}let o="";try{o=e.location.href}catch{}if(!o||o==="about:blank")return;clearInterval(i);let s="";const c=this.config.auth.OIDCOptions.serverResponseType;e&&(c===fe.QUERY?s=e.location.search:s=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),n(s)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let n;if(t.popup?(n=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),n.location.assign(e)):typeof t.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),n=this.openSizedPopup(e,t)),!n)throw d(Ht);return n.focus&&n.focus(),this.currentWindow=n,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),n}catch(n){throw this.logger.error("error opening popup "+n.message),this.browserStorage.setInteractionInProgress(!1),d(Ut)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:n,popupWindowParent:r}){const i=r.screenLeft?r.screenLeft:r.screenX,o=r.screenTop?r.screenTop:r.screenY,s=r.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,c=r.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let l=n.popupSize?.width,u=n.popupSize?.height,f=n.popupPosition?.top,v=n.popupPosition?.left;return(!l||l<0||l>s)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),l=k.POPUP_WIDTH),(!u||u<0||u>c)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),u=k.POPUP_HEIGHT),(!f||f<0||f>c)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),f=Math.max(0,c/2-k.POPUP_HEIGHT/2+o)),(!v||v<0||v>s)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),v=Math.max(0,s/2-k.POPUP_WIDTH/2+i)),r.open(e,t,`width=${l}, height=${u}, top=${f}, left=${v}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(g.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${k.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${k.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class wt{constructor(e,t,n,r,i){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=r,this.performanceClient=i}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(y.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(y.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const n={apiId:w.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};if(typeof t.onRedirectNavigate=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),t.onRedirectNavigate(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await t.navigationClient.navigateExternal(e,n);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await t.navigationClient.navigateExternal(e,n);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),d(Ce)}async handleCodeResponse(e,t){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const n=this.browserStorage.generateStateKey(t),r=this.browserStorage.getTemporaryCache(n);if(!r)throw L(Xn,"Cached State");let i;try{i=this.authModule.handleFragmentResponse(e,r)}catch(l){throw l instanceof kt&&l.subError===V?d(V):l}const o=this.browserStorage.generateNonceKey(r),s=this.browserStorage.getTemporaryCache(o);if(this.authCodeRequest.code=i.code,i.cloud_instance_host_name&&await p(this.authModule.updateAuthority.bind(this.authModule),h.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(i.cloud_instance_host_name,this.authCodeRequest.correlationId),i.nonce=s||void 0,i.state=r,i.client_info)this.authCodeRequest.clientInfo=i.client_info;else{const l=this.checkCcsCredentials();l&&(this.authCodeRequest.ccsCredential=l)}const c=await this.authModule.acquireToken(this.authCodeRequest,i);return this.browserStorage.cleanRequestByState(t),c}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(y.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}}/*! @azure/msal-browser v3.30.0 2025-08-05 */function wi(){if(typeof window>"u"||typeof window.performance>"u"||typeof window.performance.getEntriesByType!="function")return;const a=window.performance.getEntriesByType("navigation");return(a.length?a[0]:void 0)?.type}class Ii extends te{constructor(e,t,n,r,i,o,s,c,l,u){super(e,t,n,r,i,o,s,l,u),this.nativeStorage=c}async acquireToken(e){const t=await p(this.initializeAuthorizationRequest.bind(this),h.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,g.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);const n=this.initializeServerTelemetryManager(w.acquireTokenRedirect),r=i=>{i.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(m.RESTORE_FROM_BFCACHE,g.Redirect))};try{const i=await p(this.initializeAuthorizationCodeRequest.bind(this),h.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(t),o=await p(this.createAuthCodeClient.bind(this),h.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),s=new wt(o,this.browserStorage,i,this.logger,this.performanceClient),c=await o.getAuthCodeUrl({...t,nativeBroker:H.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),l=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${l}`),window.addEventListener("pageshow",r),await s.initiateAuthRequest(c,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:l,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(i){throw i instanceof N&&(i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i)),window.removeEventListener("pageshow",r),this.browserStorage.cleanRequestByState(t.state),i}}async handleRedirectPromise(e="",t){const n=this.initializeServerTelemetryManager(w.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[r,i]=this.getRedirectResponse(e||"");if(!r)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(g.Redirect),wi()!=="back_forward"?t.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const o=this.browserStorage.getTemporaryCache(y.ORIGIN_URI,!0)||C.EMPTY_STRING,s=R.removeHashFromUrl(o),c=R.removeHashFromUrl(window.location.href);if(s===c&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),o.indexOf("#")>-1&&Rr(o),await this.handleResponse(r,n);if(this.config.auth.navigateToLoginRequestUrl){if(!Ye()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(y.URL_HASH,i,!0);const l={apiId:w.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let u=!0;if(!o||o==="null"){const f=Nr();this.browserStorage.setTemporaryCache(y.ORIGIN_URI,f,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),u=await this.navigationClient.navigateInternal(f,l)}else this.logger.verbose(`Navigating to loginRequestUrl: ${o}`),u=await this.navigationClient.navigateInternal(o,l);if(!u)return await this.handleResponse(r,n)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(r,n);return null}catch(r){throw r instanceof N&&(r.setCorrelationId(this.correlationId),n.cacheFailedRequest(r)),this.browserStorage.cleanRequestByInteractionType(g.Redirect),r}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(this.config.auth.OIDCOptions.serverResponseType===fe.QUERY?t=window.location.search:t=window.location.hash);let n=Re(t);if(n){try{vi(n,this.browserCrypto,g.Redirect)}catch(i){return i instanceof N&&this.logger.error(`Interaction type validation failed due to ${i.errorCode}: ${i.errorMessage}`),[null,""]}return kr(window),this.logger.verbose("Hash contains known properties, returning response hash"),[n,t]}const r=this.browserStorage.getTemporaryCache(y.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(y.URL_HASH)),r&&(n=Re(r),n)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[n,r]):[null,""]}async handleResponse(e,t){const n=e.state;if(!n)throw d(Fe);const r=this.browserStorage.getCachedRequest(n);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw d(ie);const c=new Y(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,w.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,r.correlationId),{userRequestState:l}=F.parseRequestState(this.browserCrypto,n);return c.acquireToken({...r,state:l,prompt:void 0}).finally(()=>{this.browserStorage.cleanRequestByState(n)})}const i=this.browserStorage.getCachedAuthority(n);if(!i)throw d(ze);const o=await p(this.createAuthCodeClient.bind(this),h.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:i});return Rt.removeThrottle(this.browserStorage,this.config.auth.clientId,r),new wt(o,this.browserStorage,r,this.logger,this.performanceClient).handleCodeResponse(e,n)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),n=this.initializeServerTelemetryManager(w.logout);try{this.eventHandler.emitEvent(m.LOGOUT_START,g.Redirect,e),await this.clearCacheOnLogout(t.account);const r={apiId:w.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},i=await p(this.createAuthCodeClient.bind(this),h.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:e&&e.authority,requestExtraQueryParameters:e?.extraQueryParameters,account:e&&e.account||void 0});if(i.authority.protocolMode===ne.OIDC)try{i.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId){this.browserStorage.removeAccount(t.account?.homeAccountId,this.correlationId),this.eventHandler.emitEvent(m.LOGOUT_SUCCESS,g.Redirect,t);return}}const o=i.getLogoutUri(t);if(this.eventHandler.emitEvent(m.LOGOUT_SUCCESS,g.Redirect,t),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(o)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(o,r);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(o,r);return}}catch(r){throw r instanceof N&&(r.setCorrelationId(this.correlationId),n.cacheFailedRequest(r)),this.eventHandler.emitEvent(m.LOGOUT_FAILURE,g.Redirect,null,r),this.eventHandler.emitEvent(m.LOGOUT_END,g.Redirect),r}this.eventHandler.emitEvent(m.LOGOUT_END,g.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return R.getAbsoluteUrl(t,q())}}/*! @azure/msal-browser v3.30.0 2025-08-05 */async function Ti(a,e,t,n,r){if(e.addQueueMeasurement(h.SilentHandlerInitiateAuthRequest,n),!a)throw t.info("Navigate url is empty"),d(Ce);return r?p(Si,h.SilentHandlerLoadFrame,t,e,n)(a,r,e,n):ee(Ei,h.SilentHandlerLoadFrameSync,t,e,n)(a)}async function Ai(a,e,t,n,r,i,o){return n.addQueueMeasurement(h.SilentHandlerMonitorIframeForHash,i),new Promise((s,c)=>{e<Me&&r.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${Me}ms). This may result in timeouts.`);const l=window.setTimeout(()=>{window.clearInterval(u),c(d(Lt))},e),u=window.setInterval(()=>{let f="";const v=a.contentWindow;try{f=v?v.location.href:""}catch{}if(!f||f==="about:blank")return;let T="";v&&(o===fe.QUERY?T=v.location.search:T=v.location.hash),window.clearTimeout(l),window.clearInterval(u),s(T)},t)}).finally(()=>{ee(bi,h.RemoveHiddenIframe,r,n,i)(a)})}function Si(a,e,t,n){return t.addQueueMeasurement(h.SilentHandlerLoadFrame,n),new Promise((r,i)=>{const o=yn();window.setTimeout(()=>{if(!o){i("Unable to load iframe");return}o.src=a,r(o)},e)})}function Ei(a){const e=yn();return e.src=a,e}function yn(){const a=document.createElement("iframe");return a.className="msalSilentIframe",a.style.visibility="hidden",a.style.position="absolute",a.style.width=a.style.height="0",a.style.border="0",a.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(a),a}function bi(a){document.body===a.parentNode&&document.body.removeChild(a)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class ki extends te{constructor(e,t,n,r,i,o,s,c,l,u,f){super(e,t,n,r,i,o,c,u,f),this.apiId=s,this.nativeStorage=l}async acquireToken(e){this.performanceClient.addQueueMeasurement(h.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==b.NONE&&t.prompt!==b.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${b.NONE}`),t.prompt=b.NONE):t.prompt=b.NONE;const n=await p(this.initializeAuthorizationRequest.bind(this),h.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,g.Silent);gn(n.authority);const r=this.initializeServerTelemetryManager(this.apiId);let i;try{return i=await p(this.createAuthCodeClient.bind(this),h.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account}),await p(this.silentTokenHelper.bind(this),h.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(i,n)}catch(o){if(o instanceof N&&(o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o)),!i||!(o instanceof N)||o.errorCode!==k.INVALID_GRANT_ERROR)throw o;this.performanceClient.addFields({retryError:o.errorCode},this.correlationId);const s=await p(this.initializeAuthorizationRequest.bind(this),h.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,g.Silent);return await p(this.silentTokenHelper.bind(this),h.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(i,s)}}logout(){return Promise.reject(d(ve))}async silentTokenHelper(e,t){const n=t.correlationId;this.performanceClient.addQueueMeasurement(h.SilentIframeClientTokenHelper,n);const r=await p(this.initializeAuthorizationCodeRequest.bind(this),h.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,n)(t),i=await p(e.getAuthCodeUrl.bind(e),h.GetAuthCodeUrl,this.logger,this.performanceClient,n)({...t,nativeBroker:H.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}),o=new tt(e,this.browserStorage,r,this.logger,this.performanceClient),s=await p(Ti,h.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,n)(i,this.performanceClient,this.logger,n,this.config.system.navigateFrameWait),c=this.config.auth.OIDCOptions.serverResponseType,l=await p(Ai,h.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,n)(s,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,n,c),u=ee(vn,h.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(l,c,this.logger);if(u.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw d(ie);const f=new Y(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,u.accountId,this.browserStorage,n),{userRequestState:v}=F.parseRequestState(this.browserCrypto,t.state);return p(f.acquireToken.bind(f),h.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,n)({...t,state:v,prompt:t.prompt||b.NONE})}return p(o.handleCodeResponse.bind(o),h.HandleCodeResponse,this.logger,this.performanceClient,n)(u,t)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Ri extends te{async acquireToken(e){this.performanceClient.addQueueMeasurement(h.SilentRefreshClientAcquireToken,e.correlationId);const t=await p(et,h.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),n={...e,...t};e.redirectUri&&(n.redirectUri=this.getRedirectUri(e.redirectUri));const r=this.initializeServerTelemetryManager(w.acquireTokenSilent_silentFlow),i=await this.createRefreshTokenClient({serverTelemetryManager:r,authorityUrl:n.authority,azureCloudOptions:n.azureCloudOptions,account:n.account});return p(i.acquireTokenByRefreshToken.bind(i),h.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(n).catch(o=>{throw o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o),o})}logout(){return Promise.reject(d(ve))}async createRefreshTokenClient(e){const t=await p(this.getClientConfiguration.bind(this),h.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new Zn(t,this.performanceClient)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class _i{constructor(e,t,n,r){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=n,this.cryptoObj=r}loadExternalTokens(e,t,n){if(!this.isBrowserEnvironment)throw d(ye);const r=e.correlationId||B(),i=t.id_token?Be(t.id_token,K):void 0,o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},s=e.authority?new ke(ke.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,o,this.logger,e.correlationId||B()):void 0,c=this.loadAccount(e,n.clientInfo||t.client_info||"",r,i,s),l=this.loadIdToken(t,c.homeAccountId,c.environment,c.realm,r),u=this.loadAccessToken(e,t,c.homeAccountId,c.environment,c.realm,n,r),f=this.loadRefreshToken(t,c.homeAccountId,c.environment,r);return this.generateAuthenticationResult(e,{account:c,idToken:l,accessToken:u,refreshToken:f},i,s)}loadAccount(e,t,n,r,i){if(this.logger.verbose("TokenCache - loading account"),e.account){const l=P.createFromAccountInfo(e.account);return this.storage.setAccount(l,n),l}else if(!i||!t&&!r)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),d(Gt);const o=P.generateHomeAccountId(t,i.authorityType,this.logger,this.cryptoObj,r),s=r?.tid,c=St(this.storage,i,o,K,n,r,t,i.hostnameAndPort,s,void 0,void 0,this.logger);return this.storage.setAccount(c,n),c}loadIdToken(e,t,n,r,i){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const o=xe(t,n,e.id_token,this.config.auth.clientId,r);return this.storage.setIdTokenCredential(o,i),o}loadAccessToken(e,t,n,r,i,o,s){if(t.access_token)if(t.expires_in){if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");const c=t.scope?D.fromString(t.scope):new D(e.scopes),l=o.expiresOn||t.expires_in+new Date().getTime()/1e3,u=o.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+new Date().getTime()/1e3,f=De(n,r,t.access_token,this.config.auth.clientId,i,c.printScopes(),l,u,K);return this.storage.setAccessTokenCredential(f,s),f}loadRefreshToken(e,t,n,r){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const i=er(t,n,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(i,r),i}generateAuthenticationResult(e,t,n,r){let i="",o=[],s=null,c;t?.accessToken&&(i=t.accessToken.secret,o=D.fromString(t.accessToken.target).asArray(),s=new Date(Number(t.accessToken.expiresOn)*1e3),c=new Date(Number(t.accessToken.extendedExpiresOn)*1e3));const l=t.account;return{authority:r?r.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:o,account:l.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:n||{},accessToken:i,fromCache:!0,expiresOn:s,correlationId:e.correlationId||"",requestId:"",extExpiresOn:c,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:l.cloudGraphHostName||"",msGraphHost:l.msGraphHost||"",fromNativeBroker:!1}}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Ni extends At{constructor(e){super(e),this.includeRedirectUri=!1}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Pi extends te{constructor(e,t,n,r,i,o,s,c,l,u){super(e,t,n,r,i,o,c,l,u),this.apiId=s}async acquireToken(e){if(!e.code)throw d(Vt);const t=await p(this.initializeAuthorizationRequest.bind(this),h.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,g.Silent),n=this.initializeServerTelemetryManager(this.apiId);try{const r={...t,code:e.code},i=await p(this.getClientConfiguration.bind(this),h.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),o=new Ni(i);this.logger.verbose("Auth code client created");const s=new tt(o,this.browserStorage,r,this.logger,this.performanceClient);return await p(s.handleCodeResponseFromServer.bind(s),h.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(r){throw r instanceof N&&(r.setCorrelationId(this.correlationId),n.cacheFailedRequest(r)),r}}logout(){return Promise.reject(d(ve))}}/*! @azure/msal-browser v3.30.0 2025-08-05 */function M(a){const e=a?.idTokenClaims;if(e?.tfp||e?.acr)return"B2C";if(e?.tid){if(e?.tid==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function he(a,e){try{Xe(a)}catch(t){throw e.end({success:!1},t),t}}class Ie{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Z(this.logger,this.performanceClient):It,this.eventHandler=new ri(this.logger),this.browserStorage=this.isBrowserEnvironment?new Ue(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,tr(this.config.auth),this.performanceClient):Jr(this.config.auth.clientId,this.logger);const t={cacheLocation:S.MemoryStorage,temporaryCacheLocation:S.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new Ue(this.config.auth.clientId,t,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new _i(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this),this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}static async createController(e,t){const n=new Ie(e);return await n.initialize(t),n}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent(m.INITIALIZE_END);return}const t=e?.correlationId||this.getRequestCorrelationId(),n=this.config.system.allowNativeBroker,r=this.performanceClient.startMeasurement(h.InitializeClientApplication,t);if(this.eventHandler.emitEvent(m.INITIALIZE_START),n)try{this.nativeExtensionProvider=await H.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(i){this.logger.verbose(i)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await p(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),h.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.initialized=!0,this.eventHandler.emitEvent(m.INITIALIZE_END),r.end({allowNativeBroker:n,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),un(this.initialized),this.isBrowserEnvironment){const t=e||"";let n=this.redirectResponse.get(t);return typeof n>"u"?(n=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,n),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),n}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){const t=this.getAllAccounts(),n=this.browserStorage.getCachedNativeRequest(),r=n&&H.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,i=r?n?.correlationId:this.browserStorage.getTemporaryCache(y.CORRELATION_ID,!0)||"",o=this.performanceClient.startMeasurement(h.AcquireTokenRedirect,i);this.eventHandler.emitEvent(m.HANDLE_REDIRECT_START,g.Redirect);let s;if(r&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const c=new Y(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,w.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,n.accountId,this.nativeInternalStorage,n.correlationId);s=p(c.handleRedirectPromise.bind(c),h.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,o.event.correlationId)(this.performanceClient,o.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const c=this.createRedirectClient(i);s=p(c.handleRedirectPromise.bind(c),h.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,o.event.correlationId)(e,o)}return s.then(c=>(c?(t.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(m.LOGIN_SUCCESS,g.Redirect,c),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(m.ACQUIRE_TOKEN_SUCCESS,g.Redirect,c),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),o.end({success:!0,accountType:M(c.account)})):o.event.errorCode?o.end({success:!1}):o.discard(),this.eventHandler.emitEvent(m.HANDLE_REDIRECT_END,g.Redirect),c)).catch(c=>{const l=c;throw t.length>0?this.eventHandler.emitEvent(m.ACQUIRE_TOKEN_FAILURE,g.Redirect,null,l):this.eventHandler.emitEvent(m.LOGIN_FAILURE,g.Redirect,null,l),this.eventHandler.emitEvent(m.HANDLE_REDIRECT_END,g.Redirect),o.end({success:!1},l),c})}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const n=this.performanceClient.startMeasurement(h.AcquireTokenPreRedirect,t);n.add({accountType:M(e.account),scenarioId:e.scenarioId});const r=e.onRedirectNavigate;if(r)e.onRedirectNavigate=o=>{const s=typeof r=="function"?r(o):void 0;return s!==!1?n.end({success:!0}):n.discard(),s};else{const o=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=s=>{const c=typeof o=="function"?o(s):void 0;return c!==!1?n.end({success:!0}):n.discard(),c}}const i=this.getAllAccounts().length>0;try{ft(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),i?this.eventHandler.emitEvent(m.ACQUIRE_TOKEN_START,g.Redirect,e):this.eventHandler.emitEvent(m.LOGIN_START,g.Redirect,e);let o;return this.nativeExtensionProvider&&this.canUseNative(e)?o=new Y(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,w.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,n).catch(c=>{if(c instanceof U&&J(c))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(c instanceof ge)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),c}):o=this.createRedirectClient(t).acquireToken(e),await o}catch(o){throw n.end({success:!1},o),i?this.eventHandler.emitEvent(m.ACQUIRE_TOKEN_FAILURE,g.Redirect,null,o):this.eventHandler.emitEvent(m.LOGIN_FAILURE,g.Redirect,null,o),o}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(h.AcquireTokenPopup,t);n.add({scenarioId:e.scenarioId,accountType:M(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),he(this.initialized,n),this.browserStorage.setInteractionInProgress(!0)}catch(o){return Promise.reject(o)}const r=this.getAllAccounts();r.length>0?this.eventHandler.emitEvent(m.ACQUIRE_TOKEN_START,g.Popup,e):this.eventHandler.emitEvent(m.LOGIN_START,g.Popup,e);let i;return this.canUseNative(e)?i=this.acquireTokenNative({...e,correlationId:t},w.acquireTokenPopup).then(o=>(this.browserStorage.setInteractionInProgress(!1),n.end({success:!0,isNativeBroker:!0,accountType:M(o.account)}),o)).catch(o=>{if(o instanceof U&&J(o))return this.nativeExtensionProvider=void 0,this.createPopupClient(t).acquireToken(e);if(o instanceof ge)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),o}):i=this.createPopupClient(t).acquireToken(e),i.then(o=>(r.length<this.getAllAccounts().length?this.eventHandler.emitEvent(m.LOGIN_SUCCESS,g.Popup,o):this.eventHandler.emitEvent(m.ACQUIRE_TOKEN_SUCCESS,g.Popup,o),n.end({success:!0,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,accountType:M(o.account)}),o)).catch(o=>(r.length>0?this.eventHandler.emitEvent(m.ACQUIRE_TOKEN_FAILURE,g.Popup,null,o):this.eventHandler.emitEvent(m.LOGIN_FAILURE,g.Popup,null,o),n.end({success:!1},o),Promise.reject(o)))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){const t=this.getRequestCorrelationId(e),n={...e,prompt:e.prompt,correlationId:t};this.ssoSilentMeasurement=this.performanceClient.startMeasurement(h.SsoSilent,t),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:M(e.account)}),he(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(m.SSO_SILENT_START,g.Silent,n);let r;return this.canUseNative(n)?r=this.acquireTokenNative(n,w.ssoSilent).catch(i=>{if(i instanceof U&&J(i))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(n.correlationId).acquireToken(n);throw i}):r=this.createSilentIframeClient(n.correlationId).acquireToken(n),r.then(i=>(this.eventHandler.emitEvent(m.SSO_SILENT_SUCCESS,g.Silent,i),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:i.fromNativeBroker,accessTokenSize:i.accessToken.length,idTokenSize:i.idToken.length,accountType:M(i.account)}),i)).catch(i=>{throw this.eventHandler.emitEvent(m.SSO_SILENT_FAILURE,g.Silent,null,i),this.ssoSilentMeasurement?.end({success:!1},i),i}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const n=this.performanceClient.startMeasurement(h.AcquireTokenByCode,t);he(this.initialized,n),this.eventHandler.emitEvent(m.ACQUIRE_TOKEN_BY_CODE_START,g.Silent,e),n.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw d(jt);if(e.code){const r=e.code;let i=this.hybridAuthCodeResponses.get(r);return i?(this.logger.verbose("Existing acquireTokenByCode request found",t),n.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),i=this.acquireTokenByCodeAsync({...e,correlationId:t}).then(o=>(this.eventHandler.emitEvent(m.ACQUIRE_TOKEN_BY_CODE_SUCCESS,g.Silent,o),this.hybridAuthCodeResponses.delete(r),n.end({success:!0,isNativeBroker:o.fromNativeBroker,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,accountType:M(o.account)}),o)).catch(o=>{throw this.hybridAuthCodeResponses.delete(r),this.eventHandler.emitEvent(m.ACQUIRE_TOKEN_BY_CODE_FAILURE,g.Silent,null,o),n.end({success:!1},o),o}),this.hybridAuthCodeResponses.set(r,i)),await i}else if(e.nativeAccountId)if(this.canUseNative(e,e.nativeAccountId)){const r=await this.acquireTokenNative({...e,correlationId:t},w.acquireTokenByCode,e.nativeAccountId).catch(i=>{throw i instanceof U&&J(i)&&(this.nativeExtensionProvider=void 0),i});return n.end({accountType:M(r.account),success:!0}),r}else throw d(Jt);else throw d(Qt)}catch(r){throw this.eventHandler.emitEvent(m.ACQUIRE_TOKEN_BY_CODE_FAILURE,g.Silent,null,r),n.end({success:!1},r),r}}async acquireTokenByCodeAsync(e){return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(h.AcquireTokenByCodeAsync,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),await this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(r=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:r.fromCache,isNativeBroker:r.fromNativeBroker}),r)).catch(r=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},r),r}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(h.AcquireTokenFromCache,e.correlationId),t){case E.Default:case E.AccessToken:case E.AccessTokenAndRefreshToken:const n=this.createSilentCacheClient(e.correlationId);return p(n.acquireToken.bind(n),h.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw L(de)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(h.AcquireTokenByRefreshToken,e.correlationId),t){case E.Default:case E.AccessTokenAndRefreshToken:case E.RefreshToken:case E.RefreshTokenAndNetwork:const n=this.createSilentRefreshClient(e.correlationId);return p(n.acquireToken.bind(n),h.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw L(de)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(h.AcquireTokenBySilentIframe,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return p(t.acquireToken.bind(t),h.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);return ft(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);return Xe(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(t).logout(e)}catch(t){return Promise.reject(t)}}async clearCache(e){if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, returning early.");return}const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){const t=this.getRequestCorrelationId();return Wr(this.logger,this.browserStorage,this.isBrowserEnvironment,t,e)}getAccount(e){const t=this.getRequestCorrelationId();return Yr(e,this.logger,this.browserStorage,t)}getAccountByUsername(e){const t=this.getRequestCorrelationId();return Xr(e,this.logger,this.browserStorage,t)}getAccountByHomeId(e){const t=this.getRequestCorrelationId();return Zr(e,this.logger,this.browserStorage,t)}getAccountByLocalId(e){const t=this.getRequestCorrelationId();return ei(e,this.logger,this.browserStorage,t)}setActiveAccount(e){const t=this.getRequestCorrelationId();ti(e,this.browserStorage,t)}getActiveAccount(){const e=this.getRequestCorrelationId();return ni(this.browserStorage,e)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const n=P.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(n,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw d(ie);return new Y(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,n||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUseNative(e,t){if(this.logger.trace("canUseNative called"),!H.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case b.NONE:case b.CONSENT:case b.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!t&&!this.getNativeAccountId(e)?(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new yi(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new Ii(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new ki(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,w.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new Cn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new Ri(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new Pi(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,w.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return dn(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}handleAccountCacheChange(e){try{e.key?.includes(A.ACTIVE_ACCOUNT_FILTERS)&&this.eventHandler.emitEvent(m.ACTIVE_ACCOUNT_CHANGED);const t=e.newValue||e.oldValue;if(!t)return;const n=JSON.parse(t);if(typeof n!="object"||!P.isAccountEntity(n))return;const i=Ee.toObject(new P,n).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.eventHandler.emitEvent(m.ACCOUNT_ADDED,void 0,i)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.eventHandler.emitEvent(m.ACCOUNT_REMOVED,void 0,i))}catch{return}}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?B():C.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||gt})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||gt})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(h.AcquireTokenSilent,t);n.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),he(this.initialized,n),this.logger.verbose("acquireTokenSilent called",t);const r=e.account||this.getActiveAccount();if(!r)throw d(Dt);n.add({accountType:M(r)});const i={clientId:this.config.auth.clientId,authority:e.authority||C.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:r.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},o=JSON.stringify(i),s=this.activeSilentTokenRequests.get(o);if(typeof s>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);const c=p(this.acquireTokenSilentAsync.bind(this),h.AcquireTokenSilentAsync,this.logger,this.performanceClient,t)({...e,correlationId:t},r).then(l=>(this.activeSilentTokenRequests.delete(o),n.end({success:!0,fromCache:l.fromCache,isNativeBroker:l.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,accessTokenSize:l.accessToken.length,idTokenSize:l.idToken.length}),l)).catch(l=>{throw this.activeSilentTokenRequests.delete(o),n.end({success:!1},l),l});return this.activeSilentTokenRequests.set(o,c),{...await c,state:e.state}}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),n.discard(),{...await s,state:e.state}}async acquireTokenSilentAsync(e,t){const n=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(h.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(m.ACQUIRE_TOKEN_START,g.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",n);const r=await p(ci,h.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),i=e.cacheLookupPolicy||E.Default;return this.acquireTokenSilentNoIframe(r,i).catch(async s=>{if(Mi(s,i))if(this.activeIframeRequest)if(i!==E.Skip){const[l,u]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${u}`,r.correlationId);const f=this.performanceClient.startMeasurement(h.AwaitConcurrentIframe,r.correlationId);f.add({awaitIframeCorrelationId:u});const v=await l;if(f.end({success:v}),v)return this.logger.verbose(`Parallel iframe request with correlationId: ${u} succeeded. Retrying cache and/or RT redemption`,r.correlationId),this.acquireTokenSilentNoIframe(r,i);throw this.logger.info(`Iframe request with correlationId: ${u} failed. Interaction is required.`),s}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",r.correlationId),p(this.acquireTokenBySilentIframe.bind(this),h.AcquireTokenBySilentIframe,this.logger,this.performanceClient,r.correlationId)(r);else{let l;return this.activeIframeRequest=[new Promise(u=>{l=u}),r.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",r.correlationId),p(this.acquireTokenBySilentIframe.bind(this),h.AcquireTokenBySilentIframe,this.logger,this.performanceClient,r.correlationId)(r).then(u=>(l(!0),u)).catch(u=>{throw l(!1),u}).finally(()=>{this.activeIframeRequest=void 0})}else throw s}).then(s=>(this.eventHandler.emitEvent(m.ACQUIRE_TOKEN_SUCCESS,g.Silent,s),e.correlationId&&this.performanceClient.addFields({fromCache:s.fromCache,isNativeBroker:s.fromNativeBroker},e.correlationId),s)).catch(s=>{throw this.eventHandler.emitEvent(m.ACQUIRE_TOKEN_FAILURE,g.Silent,null,s),s}).finally(()=>{document.removeEventListener("visibilitychange",n)})}async acquireTokenSilentNoIframe(e,t){return H.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,w.acquireTokenSilent_silentFlow).catch(async n=>{throw n instanceof U&&J(n)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,L(de)):n})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),p(this.acquireTokenFromCache.bind(this),h.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,t).catch(n=>{if(t===E.AccessToken)throw n;return this.eventHandler.emitEvent(m.ACQUIRE_TOKEN_NETWORK_START,g.Silent,e),p(this.acquireTokenByRefreshToken.bind(this),h.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,t)}))}}function Mi(a,e){const t=!(a instanceof ge&&a.subError!==nr),n=a.errorCode===k.INVALID_GRANT_ERROR||a.errorCode===de,r=t&&n||a.errorCode===rr||a.errorCode===ir,i=gr.includes(e);return r&&i}/*! @azure/msal-browser v3.30.0 2025-08-05 */async function Oi(a,e){const t=new Q(a);return await t.initialize(),Ie.createController(t,e)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class wn{static async createPublicClientApplication(e){const t=await Oi(e);return new wn(e,t)}constructor(e,t){this.controller=t||new Ie(new Q(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}export{wn as P};
//# sourceMappingURL=vendor-msal-_oisOUhb.js.map
